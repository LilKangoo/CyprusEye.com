<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FCSE0876CR"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FCSE0876CR');
</script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Security: Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://www.google-analytics.com https://region1.google-analytics.com https://esm.sh https://*.esm.sh https://unpkg.com https://cdn.jsdelivr.net https://static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https: blob:; connect-src 'self' https://daoohnbnnowmmcizgvrq.supabase.co https://*.supabase.co wss://daoohnbnnowmmcizgvrq.supabase.co wss://*.supabase.co https://www.google-analytics.com https://region1.google-analytics.com https://esm.sh https://*.esm.sh https://unpkg.com https://*.tile.openstreetmap.org; frame-src 'self' https://docs.google.com; object-src 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests;">
  
  <meta name="theme-color" content="#2563eb" />
  <meta name="robots" content="index,follow" />
  <title data-i18n="seo.home.title">CyprusEye Quest ‚Äì interactive travel game in Cyprus</title>
  <meta
    name="description"
    content="Plan your Cyprus adventures with CyprusEye Quest ‚Äì manage attractions, packing lists, and missions in one interactive travel companion."
  />
  <meta property="og:type" content="website" />
  <meta
    property="og:title"
    content="CyprusEye Quest ‚Äì interactive travel game in Cyprus"
  />
  <meta
    property="og:description"
    content="Explore Cyprus with CyprusEye Quest, track your progress, and unlock new rewards on every mission."
  />
  <meta property="og:url" content="https://www.cypruseye.com/index.html" />
  <meta property="og:image" content="https://www.cypruseye.com/assets/cyprus_logo-1000x1054.png" />
  <meta property="og:locale" content="en_GB" />
  <meta property="og:locale:alternate" content="pl_PL" />
  <!-- <meta property="og:locale:alternate" content="el_GR" /> -->
  <link rel="canonical" href="https://www.cypruseye.com/index.html" />
  <link rel="alternate" hreflang="pl" href="https://www.cypruseye.com/index.html?lang=pl" />
  <link rel="alternate" hreflang="en" href="https://www.cypruseye.com/index.html?lang=en" />
  <!-- <link rel="alternate" hreflang="el" href="https://www.cypruseye.com/index.html?lang=el" /> -->
  <!-- <link rel="alternate" hreflang="he" href="https://www.cypruseye.com/index.html?lang=he" /> -->
  <link rel="alternate" hreflang="x-default" href="https://www.cypruseye.com/index.html" />
  <link rel="icon" href="/assets/cyprus_logo-1000x1054.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://daoohnbnnowmmcizgvrq.supabase.co" crossorigin />
  <link rel="preconnect" href="https://unpkg.com" crossorigin />
  <link
    rel="preload"
    as="style"
    href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
    media="print"
    onload="this.media='all'"
  />
  <noscript>
    <link
      href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </noscript>
  <link rel="stylesheet" href="assets/css/tokens.css" />
  <link rel="stylesheet" href="assets/css/base.css" />
  <link rel="stylesheet" href="assets/css/components.css?v=12" />
  <link rel="stylesheet" href="assets/css/header-metrics.css" />
  <link rel="stylesheet" href="assets/css/current-place.css?v=6" />
  <link rel="stylesheet" href="assets/css/mobile.css" />
  <link rel="stylesheet" href="assets/css/mobile-nav.css" />
  <link rel="stylesheet" href="assets/css/rtl.css" />
  <link rel="stylesheet" href="assets/css/language-switcher.css" />
  <link rel="stylesheet" href="assets/css/language-selector.css" />
  <link rel="stylesheet" href="css/toast.css" />
  <link rel="stylesheet" href="css/successPopup.css" />
  <link rel="stylesheet" href="css/modal-ios-fix.css" />
  <link rel="stylesheet" href="assets/css/recommendations.css?v=2" />
  <link rel="stylesheet" href="assets/css/community.css" />
  <link
    rel="preload"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    as="style"
    crossorigin
    data-leaflet-resource="style"
  />
  <link
    rel="preload"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    as="script"
    crossorigin
    data-leaflet-resource="script"
  />
  

  <meta name="ce-auth" content="on" />
  <!-- Immediate referral capture - must run before any modules -->
  <script>
    (function(){
      try {
        var ref = new URLSearchParams(window.location.search).get('ref');
        if (ref && ref.trim()) {
          var data = {
            code: ref.trim(),
            capturedAt: Date.now(),
            expiresAt: Date.now() + (14 * 24 * 60 * 60 * 1000)
          };
          localStorage.setItem('cypruseye_referral_code', JSON.stringify(data));
          console.log('‚úÖ Referral captured:', ref.trim());
        }
      } catch(e) {}
    })();
  </script>
  <script type="module" src="js/supabaseClient.js"></script>
  <script type="module" src="js/toast.js"></script>
  <script type="module" src="js/referral.js"></script>
  <script src="js/footer-referral.js" defer></script>
  <script type="module" src="js/auth.js?v=6"></script>
  <script type="module" src="js/authUi.js?v=2"></script>
  <script src="js/map-recommendations.js?v=6" defer></script>
</head>
<body data-navigation="multi-page" data-initial-view="adventureView" data-seo-page="home">
  <div id="authMessage" class="auth-message" role="status" aria-live="polite"></div>
  <header class="app-header nav-modern">
      <div class="nav-modern__top" aria-label="Global header">
        <div class="brand nav-modern__brand-block">
          <a href="index.html" class="nav-modern__brand-link" aria-label="CyprusEye Quest home">
            <img
              src="assets/cyprus_logo-1000x1054.png"
              alt="WakacjeCypr.com ‚Äì logo ≈º√≥≈Çwia z flagƒÖ Polski"
              data-i18n-attrs="alt:header.logoAlt"
              width="1000"
              height="1054"
              loading="eager"
              fetchpriority="high"
            />
            <div class="brand-title" data-i18n="header.brand">
              <p class="brand-name">CyprusEye Quest &amp; Travel</p>
            </div>
          </a>
        </div>

        <div class="nav-modern__stats nav-modern__stats-lite" data-auth="user-only">
          <div class="stats-lite__pill">
            <a href="achievements.html" class="stats-lite__profile" id="profileButton" aria-label="M√≥j profil" data-i18n-attrs="aria-label:header.profileLabel">
              <img
                id="headerUserAvatar"
                class="profile-avatar"
                src="assets/cyprus_logo-1000x1054.png"
                alt="Avatar"
                width="48"
                height="48"
                loading="eager"
              />
              <div class="profile-info">
                <p class="profile-name" data-i18n="header.profileLabel">M√≥j Profil</p>
                <p class="profile-status" data-i18n="header.statusPlaceholder">Poziom 1 ‚Ä¢ 0 odznak</p>
              </div>
            </a>

            <div class="stats-lite__panel">
              <div class="stats-lite__level">
                <span class="stats-lite__label">LVL</span>
                <span class="stats-lite__value" id="headerLevelNumber">1</span>
              </div>

              <div class="stats-lite__xp" role="img" aria-label="Postƒôp do≈õwiadczenia" data-i18n-attrs="aria-label:metrics.xp.aria">
                <span class="stats-lite__xp-current"><span id="headerXpPoints">0</span> XP</span>
                <div class="stats-lite__xp-bar">
                  <div class="stats-lite__xp-fill is-width-zero" id="headerXpFill"></div>
                </div>
              </div>

              <div class="stats-lite__badges">
                <span class="stats-lite__label">üèÜ</span>
                <span class="stats-lite__value" id="headerBadgesCount">0</span>
              </div>
            </div>
          </div>
        </div>

        <div class="nav-modern__top-actions">
          <div class="nav-modern__auth">
            <div id="auth-actions" class="auth-actions-inline" aria-live="polite">
              <button
                class="nav-modern__login"
                data-open-auth
                data-auth="anon-only"
                data-tour-target="login-button"
                data-i18n="header.login"
                data-i18n-attrs="aria-label:auth.login.aria"
                aria-label="Zaloguj do konta"
              >
                Zaloguj
              </button>
<button class="btn btn-sm" data-auth="logout" data-i18n="header.logout" data-i18n-attrs="aria-label:auth.logout.aria" aria-label="Wyloguj z konta" hidden>Wyloguj</button>
            </div>
            <div data-auth="spinner" class="auth-spinner-inline" aria-live="polite" data-i18n="auth.status.spinner" hidden>≈ÅƒÖczenie...</div>
          </div>

          <button
            id="sosToggle"
            class="nav-modern__sos"
            type="button"
            aria-haspopup="dialog"
            aria-controls="sosModal"
            data-i18n="header.sosToggle"
          >
            ‚ö†Ô∏è SOS
          </button>

          <button
            id="btnOpenCart"
            class="btn btn-sm"
            type="button"
            aria-label="Koszyk"
            data-i18n-attrs="aria-label:shop.cart.aria"
          >
            üõí <span id="cartCount" class="cart-count" hidden>0</span>
          </button>

          <div class="language-pill-group" data-language-toggle aria-label="Language selector" data-i18n-attrs="aria-label:language.switcher.label">
            <button type="button" class="language-pill" data-language-pill="pl" aria-pressed="false">PL</button>
            <button type="button" class="language-pill" data-language-pill="en" aria-pressed="false">EN</button>
            <!-- <button type="button" class="language-pill" data-language-pill="el" aria-pressed="false">EL</button> -->
            <!-- <button type="button" class="language-pill" data-language-pill="he" aria-pressed="false">HE</button> -->
          </div>
        </div>
      </div>
    <div class="nav-modern__shell">

      <div class="nav-modern__bars" data-tour-target="tabs-navigation">
        <button class="nav-modern__toggle-btn" id="navToggleBtn" aria-expanded="false" aria-controls="navLinksRow" data-i18n="nav.toggle">
          ‚ò∞ Nawigacja
        </button>
        <div class="nav-modern__links-row" id="navLinksRow" aria-label="G≈Ç√≥wna nawigacja i skr√≥ty" data-i18n-attrs="aria-label:header.quickActions.aria">
          <nav class="nav-modern__tabs" role="tablist" data-i18n-attrs="aria-label:header.tabs.aria" aria-label="Nawigacja g≈Ç√≥wna">
            <a href="index.html" class="nav-modern__tab is-active" id="headerAdventureTab" data-i18n="nav.adventure">
              üéØ Przygoda
            </a>
            <a href="community.html" class="nav-modern__tab" id="headerPackingTab" data-i18n="nav.community">
              üí¨ Spo≈Çeczno≈õƒá
            </a>
            <a href="recommendations.html" class="nav-modern__tab" id="headerRecommendationsTab" data-i18n="nav.recommendations">
              ‚ú® Polecane
            </a>
            <a href="tasks.html" class="nav-modern__tab" id="headerTasksTab" data-i18n="nav.tasks">
              ‚òëÔ∏è Zadania
            </a>
            <a href="shop.html" class="nav-modern__tab" id="headerShopTab" data-i18n="nav.shop">
              üõçÔ∏è Sklep
            </a>
          </nav>

          <div class="nav-modern__chips">
            <a class="nav-chip" href="packing.html" data-i18n="nav.packing">üéí Pakowanie</a>
            <a class="nav-chip" href="kupon.html" data-i18n="header.coupon">üéüÔ∏è Kupon</a>
            <a class="nav-chip" href="car-rental-landing.html" data-i18n="header.carRentalLink">üöó Wynajem auta</a>
            <a class="nav-chip" href="trips.html" data-i18n="nav.trips">üß≠ Wycieczki</a>
            <a class="nav-chip" href="hotels.html" data-i18n="nav.hotels">üè® Hotele</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div id="notificationsPanel" class="notifications-panel" hidden aria-live="polite">
    <div class="notifications-panel-header">
      <h3 data-i18n="notifications.title">Powiadomienia</h3>
      <div class="notifications-panel-actions">
        <button type="button" class="ghost" id="notificationsMarkAll" data-i18n="notifications.markAll">
          Oznacz wszystkie jako przeczytane
        </button>
        <button
          type="button"
          class="ghost notifications-close"
          id="notificationsClose"
          aria-label="Zamknij powiadomienia"
          data-i18n="notifications.close"
        >
          ‚úï
        </button>
      </div>
    </div>
    <p id="notificationsPanelEmpty" class="notifications-empty" data-i18n="notifications.empty">
      Zaloguj siƒô, aby zobaczyƒá swoje powiadomienia.
    </p>
    <ul id="notificationsPanelList" class="notifications-list" role="list"></ul>
  </div>

  <main id="main-content">
    <h1 class="sr-only" data-i18n="home.pageTitle">CyprusEye Quest ‚Äì interaktywny przewodnik po Cyprze</h1>
    <div class="layout app-view" id="adventureView" role="tabpanel" aria-labelledby="headerAdventureTab">
      <div class="primary-column">
        <section id="current-objective" class="map-panel" data-tour-target="map-section">
          <h2 id="currentObjectiveHeading" class="sr-only" tabindex="-1" data-i18n="objective.title">
            Aktualna lokalizacja
          </h2>
          <div class="map-accessibility-actions">
            <a class="map-skip-link" href="#mapSkipTarget" data-i18n="map.skipLink">
              Pomi≈Ñ interaktywnƒÖ mapƒô
            </a>
          </div>
          
          <!-- Map Container (Background) -->
          <div id="map" aria-label="Interaktywna mapa atrakcji"></div>
          
          <p
            id="mapSkipTarget"
            class="sr-only map-skip-target"
            tabindex="-1"
            data-i18n="map.skipTarget"
          >
            Pominiƒôto mapƒô. Przejd≈∫ do kolejnych informacji o lokalizacji.
          </p>
          
          <!-- Floating Details Card -->
          <div class="current-place-section" id="currentPlaceSection" data-tour-target="current-place">
            <!-- Navigation (Arrows & Counter) -->
            <div class="current-place-navigation">
              <button
                type="button"
                id="prevPlaceBtn"
                onclick="navigatePlace(-1)"
                aria-label="Poprzednie"
                data-i18n-attrs="aria-label:currentPlace.prev"
              >
                ‚Üê
              </button>
              <span class="current-place-heading" id="placeCounter">X / Y</span>
              <button
                type="button"
                id="nextPlaceBtn"
                onclick="navigatePlace(1)"
                aria-label="Nastƒôpne"
                data-i18n-attrs="aria-label:currentPlace.next"
              >
                ‚Üí
              </button>
            </div>
            <div
              id="mapFilterInline"
              class="map-filter-inline-host"
              aria-label="Map filters"
              data-i18n-attrs="aria-label:map.filter.aria"
            ></div>
            <p id="currentPlaceFilterHint" class="current-place-filter-hint" aria-live="polite"></p>
            
            <div class="current-place-content" id="currentPlaceContent">
              <!-- Badges Row (Added for new design) -->
              <div class="place-badges">
                <div class="place-badges-left">
                  <span class="badge-pill badge-type" data-i18n="badges.landmark">LANDMARK</span>
                  <span class="badge-pill badge-xp" id="currentPlaceXPBadge">+0 XP</span>
                  <span class="badge-pill badge-trophy" id="currentPlaceTrophyBadge" style="display:none;">üèÜ <span id="trophyName"></span></span>
                </div>
                <button
                  type="button"
                  id="currentPlaceSaveBtn"
                  class="ce-save-star"
                  data-ce-save="1"
                  data-item-type="poi"
                  data-ref-id=""
                  aria-label="Zapisz"
                  title="Zapisz"
                  onclick="event.preventDefault(); event.stopPropagation();"
                >‚òÜ</button>
              </div>

              <h3 id="currentPlaceName" data-i18n="currentPlace.loading">Loading...</h3>
              <p id="currentPlaceDescription">...</p>
              
              <!-- Actions Grid -->
              <div class="current-place-actions">
                <button
                  id="currentPlaceCheckInBtn"
                  class="btn primary"
                  onclick="checkInAtPlace(window.currentPlaceId)"
                >
                  <span class="btn-icon">‚úì</span> <span data-i18n="currentPlace.checkIn">Check</span>
                </button>
                <button
                  id="currentPlaceCommentsBtn"
                  class="btn secondary"
                  onclick="openCurrentPlaceDetails()"
                >
                  <span class="btn-icon">üí¨</span> <span data-i18n="currentPlace.comments">Komentarze</span>
                </button>
                <button
                  id="currentPlaceNavigateBtn"
                  class="btn secondary"
                  onclick="focusCurrentMapItem()"
                >
                  <span class="btn-icon">‚û§</span> <span data-i18n="currentPlace.map">Nav</span>
                </button>
              </div>
              <p id="currentPlaceCheckInStatus" class="current-place-checkin-status" aria-live="polite"></p>
            </div>
          </div>
          
          <!-- Old fallback objective div hidden but kept for logic compatibility if needed -->
          <div class="current-objective" id="currentObjective" hidden></div>
        </section>

        <!-- Home panels: 2 columns (Trips + Hotels) under the map -->
        <section class="grid home-panels-2col" aria-label="Oferty i zakwaterowania">
          <!-- Trips Section -->
          <div
            class="adventure-shortcut-card card surface-card trips-home-section"
            id="tripsHomeSection"
            data-tour-target="trips-section"
            style="grid-column: auto;"
          >
            <h2 style="margin: 0 0 16px; font-size: 1.5rem; font-weight: 700;" data-i18n="home.trips.title">üö§ Wycieczki</h2>
            <p style="margin: 0 0 20px; color: #6b7280; font-size: 0.95rem;" data-i18n="home.trips.description">
              Wybierz miasto i przeglƒÖdaj najlepsze wycieczki na Cyprze
            </p>
            <div id="tripsHomeTabs" class="trips-home-tabs" style="display: flex; gap: 12px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 8px;">
              <!-- Tabs will be dynamically generated by JS -->
            </div>
            <div class="home-carousel-container">
              <button
                class="home-carousel-nav prev"
                aria-label="Poprzednie"
                data-target="#tripsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.prev"
              >
                ‚Äπ
              </button>
              <button
                class="home-carousel-nav next"
                aria-label="Nastƒôpne"
                data-target="#tripsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.next"
              >
                ‚Ä∫
              </button>
            </div>
            <div id="tripsHomeGrid" class="home-carousel" style="gap: 16px; margin-bottom: 20px;">
              <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px; color: #9ca3af;" data-i18n="home.trips.loading">
                ≈Åadowanie wycieczek...
              </div>
            </div>
            <a
              href="trips.html"
              class="btn btn-cta-blue"
              style="width: 100%; text-align: center; padding: 12px; font-weight: 600;"
              data-i18n="home.trips.cta"
            >
              Zobacz wszystkie wycieczki ‚Üí
            </a>
          </div>

          <!-- Hotels Section on Home (mirrors trips panel) -->
          <div
            class="adventure-shortcut-card card surface-card hotels-home-section"
            id="hotelsHomeSection"
            data-tour-target="hotels-section"
            style="grid-column: auto;"
          >
            <h2 style="margin: 0 0 16px; font-size: 1.5rem; font-weight: 700;" data-i18n="home.hotels.title">üè® Zakwaterowania</h2>
            <p style="margin: 0 0 20px; color: #6b7280; font-size: 0.95rem;" data-i18n="home.hotels.description">
              Odkryj najlepsze hotele, wille i apartamenty na Cyprze
            </p>
            <div id="hotelsHomeTabs" style="display: flex; gap: 12px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 8px;"></div>
            <div class="home-carousel-container">
              <button
                class="home-carousel-nav prev"
                aria-label="Poprzednie"
                data-target="#hotelsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.prev"
              >
                ‚Äπ
              </button>
              <button
                class="home-carousel-nav next"
                aria-label="Nastƒôpne"
                data-target="#hotelsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.next"
              >
                ‚Ä∫
              </button>
            </div>
            <div id="hotelsHomeGrid" class="home-carousel" style="gap: 16px; margin-bottom: 20px;">
              <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px; color: #9ca3af;" data-i18n="home.hotels.loading">
                ≈Åadowanie hoteli...
              </div>
            </div>
            <a
              href="hotels.html"
              class="btn btn-cta-blue"
              style="width: 100%; text-align: center; padding: 12px; font-weight: 600;"
              data-i18n="home.hotels.cta"
            >
              Zobacz wszystkie hotele ‚Üí
            </a>
          </div>
        </section>

        <!-- Cars Section - Auta bez kaucji -->
        <section class="cars-home-section" data-tour-target="cars-section" aria-label="Auta bez kaucji" style="margin-top: 24px;">
          <div class="adventure-shortcut-card card surface-card cars-home-panel">
            <h2 style="margin: 0 0 16px; font-size: 1.5rem; font-weight: 700;" data-i18n="home.cars.title">üöó Auta bez kaucji</h2>
            <p style="margin: 0 0 20px; color: #6b7280; font-size: 0.95rem;" data-i18n="home.cars.description">
              Wybierz miasto i zarezerwuj auto z pe≈Çnym wsparciem 24/7
            </p>

            <div class="recommendations-home-tabs-row" style="display: flex; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
              <div id="carsHomeTabs" class="recommendations-home-tabs" style="display: flex; gap: 12px; overflow-x: auto; padding-bottom: 8px;"></div>
            </div>

            <div class="home-carousel-container">
              <button
                class="home-carousel-nav prev"
                aria-label="Poprzednie"
                data-target="#carsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.prev"
              >
                ‚Äπ
              </button>
              <button
                class="home-carousel-nav next"
                aria-label="Nastƒôpne"
                data-target="#carsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.next"
              >
                ‚Ä∫
              </button>
            </div>
            <div id="carsHomeGrid" class="home-carousel" style="gap: 16px; margin-bottom: 20px;">
              <div style="flex: 0 0 100%; text-align: center; padding: 40px 20px; color: #9ca3af;" data-i18n="home.cars.loading">
                ≈Åadowanie aut...
              </div>
            </div>

            <a
              href="car-rental-landing.html"
              class="btn btn-cta-blue"
              style="width: 100%; text-align: center; padding: 12px; font-weight: 600;"
              data-i18n="home.cars.cta"
            >
              Zobacz wszystkie auta ‚Üí
            </a>
          </div>
        </section>

        <!-- Recommendations Section - Nasze Rekomendacje -->
        <section class="recommendations-home-section" data-tour-target="recommendations-section" aria-label="Nasze rekomendacje" style="margin-top: 24px;">
          <div class="adventure-shortcut-card card surface-card recommendations-home-panel">
            <h2 style="margin: 0 0 16px; font-size: 1.5rem; font-weight: 700;" data-i18n="recommendations.home.title">‚ú® Nasze Rekomendacje</h2>
            <p style="margin: 0 0 20px; color: #6b7280; font-size: 0.95rem;" data-i18n="recommendations.home.subtitle">
              Sprawdzone miejsca, kt√≥re kochamy na Cyprze ‚Äì z ekskluzywnymi zni≈ºkami
            </p>

            <div class="recommendations-home-tabs-row" style="display: flex; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
              <div id="categoriesFiltersHome" class="recommendations-home-tabs" style="display: flex; gap: 12px; overflow-x: auto; padding-bottom: 8px;"></div>
              <button
                id="clearFiltersHome"
                class="btn-text"
                type="button"
                onclick="clearFiltersHome()"
                style="display:none; background: none; border: none; color: #667eea; font-weight: 500; cursor: pointer; font-size: 13px; padding: 6px 10px; border-radius: 6px; transition: all 0.2s;"
                data-i18n="recommendations.home.filters.clear"
              >
                Wyczy≈õƒá filtry
              </button>
            </div>

            <div class="home-carousel-container">
              <button
                class="home-carousel-nav prev"
                aria-label="Poprzednie"
                data-target="#recommendationsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.prev"
              >
                ‚Äπ
              </button>
              <button
                class="home-carousel-nav next"
                aria-label="Nastƒôpne"
                data-target="#recommendationsHomeGrid"
                data-i18n-attrs="aria-label:home.carousel.next"
              >
                ‚Ä∫
              </button>
            </div>
            <div id="recommendationsHomeGrid" class="home-carousel" style="gap: 16px; margin-bottom: 20px;">
              <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px; color: #9ca3af;" data-i18n="recommendations.home.loading">
                ≈Åadowanie rekomendacji...
              </div>
            </div>

            <a
              href="recommendations.html"
              class="btn btn-cta-blue"
              style="width: 100%; text-align: center; padding: 12px; font-weight: 600;"
              data-i18n="recommendations.home.cta"
            >
              Zobacz wszystkie rekomendacje ‚Üí
            </a>
          </div>
        </section>

        <!-- Shortcuts Grid Section -->
        <section class="shortcuts-grid" aria-label="Skr√≥ty do funkcji">
          <!-- Packing Card -->
          <a
            class="shortcut-compact"
            id="openPackingFromAdventure"
            data-tour-target="packing-card"
            href="packing.html"
            data-page-url="packing.html"
          >
            <div class="shortcut-compact-icon">üéí</div>
            <h2 data-i18n="shortcuts.packing.title">Pakowanie</h2>
            <p data-i18n="shortcuts.packing.description">
              Lista rzeczy na wyjazd
            </p>
          </a>

          <!-- Tasks Card -->
          <a
            class="shortcut-compact"
            id="openTasksFromAdventure"
            data-tour-target="tasks-card"
            href="tasks.html"
            data-page-url="tasks.html"
          >
            <div class="shortcut-compact-icon">‚úÖ</div>
            <h2 data-i18n="shortcuts.tasks.title">Zadania</h2>
            <p data-i18n="shortcuts.tasks.description">
              Twoje zadania i cele
            </p>
          </a>

          <!-- Coupon Card -->
          <a
            class="shortcut-compact"
            href="kupon.html"
            data-page-url="kupon.html"
            data-tour-target="coupon-card"
            aria-label="Kup kupon"
          >
            <div class="shortcut-compact-icon">üí∏</div>
            <h2 data-i18n="shortcuts.coupon.title">Kupon</h2>
            <p data-i18n="coupon.subtitle">
              Najprostszy spos√≥b, by skorzystaƒá z naszej oferty ‚Äî bez formalno≈õci.
            </p>
          </a>

          <!-- Car Rental Card -->
          <a
            class="shortcut-compact"
            id="openCarRentalFromAdventure"
            data-tour-target="car-card"
            href="car-rental.html"
          >
            <div class="shortcut-compact-icon">üöó</div>
            <h2 data-i18n="shortcuts.car.title">Samoch√≥d</h2>
            <p data-i18n="shortcuts.car.description">
              Sprawd≈∫ oferty wynajmu
            </p>
          </a>

          <!-- Trips Card -->
          <a
            class="shortcut-compact"
            href="trips.html"
            data-page-url="trips.html"
            data-tour-target="trips-section"
          >
            <div class="shortcut-compact-icon">üß≠</div>
            <h2 data-i18n="shortcuts.trips.title">Wycieczki</h2>
            <p data-i18n="shortcuts.trips.description">PrzeglƒÖdaj wycieczki i z≈Ç√≥≈º rezerwacjƒô.</p>
          </a>

          <!-- Plan Card -->
          <a
            class="shortcut-compact"
            href="/plan"
            data-page-url="plan.html"
            data-tour-target="plan-card"
          >
            <div class="shortcut-compact-icon">üìÖ</div>
            <h2 data-i18n="shortcuts.plan.title">Planer</h2>
            <p data-i18n="shortcuts.plan.description">Ustaw sw√≥j plan podr√≥≈ºy.</p>
          </a>
        </section>
      </div>

      <aside class="sidebar-column"><!-- moved panels into primary column for full-width map layout --></aside>

      <!-- Discovery grid removed; replaced by Community list -->

      <!-- Community list removed per Option B -->

      </div>

    <!-- Dodatkowe widoki (planer, zadania, VIP) zosta≈Çy przeniesione na osobne strony; -->
  </main>

  <!-- Mobile tabbar is dynamically generated by seo.js -->

  <!-- Footer Referral -->
  <div class="footer-referral" id="footerReferral" style="display:none;">
    <p class="footer-referral-text">
      <span style="font-size:1.25rem;">üéÅ</span>
      <span data-i18n="footer.referral.invite">Zapro≈õ znajomych i zdobƒÖd≈∫ bonusy!</span>
    </p>
    <div class="footer-referral-actions">
      <button class="btn-ref btn-copy" id="footerCopyRef">
        <span>üìã</span> <span data-i18n="footer.referral.copy">Kopiuj link</span>
      </button>
      <button class="btn-ref btn-facebook" id="footerShareFb">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
        <span data-i18n="footer.referral.facebook">Facebook</span>
      </button>
    </div>
  </div>

  <footer class="app-footer">
    <p data-i18n="footer.app">¬© <span data-current-year></span> WakacjeCypr.com ‚Ä¢ Graj, zwiedzaj i planuj wakacje jednocze≈õnie.</p>
    <div class="footer-links" style="margin-bottom: 8px;">
       <a href="terms.html" class="footer-link" data-i18n="legal.termsLink">Terms of Service</a>
    </div>
    <button
      type="button"
      class="ghost tutorial-help-button"
      id="tutorialHelpButton"
      data-tour-target="help-button"
      data-i18n="tutorial.showAgain"
      aria-haspopup="dialog"
    >
      üîÅ Poka≈º instrukcjƒô
    </button>
  </footer>

  <div id="toastContainer" class="toast-container" aria-live="assertive" aria-atomic="true"></div>
  

  <!-- Home page section scripts (early start; will re-render when i18n helpers become available) -->
  <script src="js/home-trips.js?v=12" defer></script>
  <script src="js/home-hotels.js?v=14" defer></script>


  <script src="js/languageSelector.js" defer></script>
  <script src="js/i18n.js" defer></script>
  <script src="js/forms.js" defer></script>
  <script src="js/tutorial.js" defer></script>
  <script src="js/seo.js" defer></script>
  <script src="js/mobile-nav.js" defer></script>
  <script src="js/header-dropdown.js?v=2" defer></script>
  
  <!-- Leaflet - za≈Çaduj bezpo≈õrednio jako fallback -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="" defer></script>
  
  <!-- Awaryjny skrypt inicjalizacji mapy -->
  <!-- Fallback removed - app-core.js handles all initialization -->
  
  <!-- Load data files first -->
  <!-- Static data as fallback -->
  <script src="js/data-places.js?v=3" defer></script>
  <!-- POI Loader - Dynamic loading from Supabase (defer to wait for supabaseClient) -->
  <script src="js/poi-loader.js?v=4" defer></script>
  <script src="js/data-tasks.js" defer></script>
  <script src="js/data-packing.js" defer></script>
  <script src="js/modalUtils.js" defer></script>
  <script src="js/successPopup.js" defer></script>
  
  <!-- Recommendations Detail Modal -->
  <div id="detailModal" class="recommendation-modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="detailModalTitle">
    <div class="modal-overlay" onclick="closeDetailModal()"></div>
    <div class="modal-content">
      <button class="modal-close" type="button" aria-label="Zamknij" onclick="closeDetailModal()">‚úï</button>
      <div id="modalDetails" class="modal-body">
        <!-- Modal content filled by home-recommendations.js -->
      </div>
    </div>
  </div>

  <!-- Cars Home Modal (reservation form rendered by home-cars.js) -->
  <div id="carHomeModal" class="recommendation-modal" style="display:none" role="dialog" aria-modal="true" aria-labelledby="carHomeModalTitle">
    <div class="modal-overlay" onclick="closeCarHomeModal()"></div>
    <div class="modal-content">
      <button class="modal-close" type="button" aria-label="Zamknij" onclick="closeCarHomeModal()">‚úï</button>
      <div id="carHomeModalBody" class="modal-body"></div>
    </div>
  </div>
  
  <!-- Comments Modal (shared with community) -->
  <div id="commentsModal" class="comments-modal" hidden role="dialog" aria-modal="true" aria-labelledby="commentsModalTitle">
    <div class="comments-modal-dialog">
      <header class="comments-modal-header">
        <button
          type="button"
          class="modal-nav-btn"
          id="prevPoiBtn"
          aria-label="Poprzednie miejsce"
          title="Poprzednie miejsce"
          data-i18n-attrs="aria-label:modal.aria.previous,title:modal.aria.previous"
        >
          ‚Äπ
        </button>
        <div class="comments-modal-title-section">
          <h2 id="commentsModalTitle" class="comments-modal-title"></h2>
          <p id="commentsModalLocation" class="comments-modal-location"></p>
        </div>
        <div class="modal-header-actions">
          <button
            type="button"
            class="ce-save-star ce-save-star-sm"
            id="modalPoiSaveBtn"
            data-ce-save="1"
            data-item-type="poi"
            data-ref-id=""
            aria-label="Save"
            title="Save"
            onclick="event.preventDefault(); event.stopPropagation();"
          >
            ‚òÜ
          </button>
          <button
            type="button"
            class="modal-nav-btn"
            id="nextPoiBtn"
            aria-label="Nastƒôpne miejsce"
            title="Nastƒôpne miejsce"
            data-i18n-attrs="aria-label:modal.aria.next,title:modal.aria.next"
          >
            ‚Ä∫
          </button>
          <button
            type="button"
            class="icon-button"
            id="closeCommentsModal"
            aria-label="Zamknij"
            data-i18n-attrs="aria-label:modal.aria.close"
          >
            ‚úï
          </button>
        </div>
      </header>
      <div class="comments-modal-content">
        <!-- POI Gallery (main photos from admin) -->
        <div class="modal-poi-gallery-section" id="modalPoiGallerySection" hidden>
          <div class="modal-poi-gallery-header">
            <h3 class="modal-poi-gallery-title" data-i18n="community.gallery.title">Place photos</h3>
            <span class="modal-poi-gallery-count" id="modalPoiGalleryCount">0 photos</span>
          </div>
          <div class="modal-poi-gallery-track" id="modalPoiGalleryTrack"></div>
        </div>

        <!-- POI Location Map & Check-in -->
        <div class="modal-map-section" id="modalMapSection">
          <div id="poiMiniMap" class="poi-mini-map"></div>
          <div class="poi-location-info">
            <div class="poi-distance-container">
              <span id="poiDistanceIcon" class="distance-icon">üìç</span>
              <span id="poiDistance" class="poi-distance">Loading location...</span>
            </div>
            <button id="modalCheckInBtn" class="btn btn-checkin" disabled data-auth-only>
              <span class="checkin-icon">‚úì</span>
              <span data-i18n="community.checkin.button">Check in</span>
            </button>
          </div>
          <p id="modalCheckInStatus" class="check-in-status"></p>
        </div>

        <!-- Rating Section -->
        <div class="modal-rating-section" id="modalRatingSection">
          <h3 data-i18n="community.rating.title">Oce≈Ñ to miejsce</h3>
          <div id="ratingDisplay"></div>
          <div class="rating-interactive-container" id="ratingInteractive" hidden>
            <div id="ratingStarsContainer"></div>
            <span
              id="ratingPrompt"
              class="rating-prompt"
              data-i18n="community.rating.prompt"
            >
              Kliknij na gwiazdki aby oceniƒá
            </span>
          </div>
          <div id="ratingBreakdown"></div>
        </div>

        <!-- Add Comment Form -->
        <div class="add-comment-section" id="addCommentSection">
          <div class="auth-required-message" data-auth-required hidden>
            <p data-i18n="community.auth.required">Musisz byƒá zalogowany, aby dodaƒá komentarz</p>
            <button
              class="btn btn-primary primary"
              data-open-auth
              data-auth-target="login"
              data-i18n="header.login"
            >
              Zaloguj
            </button>
          </div>
          <form id="addCommentForm" class="add-comment-form" data-auth-only hidden>
            <div class="user-avatar-section">
              <img id="currentUserAvatar" class="user-avatar" alt="" />
              <div>
                <strong id="currentUserName"></strong>
                <p class="form-hint" data-i18n="community.comment.hint">Dodaj komentarz lub zdjƒôcia</p>
              </div>
            </div>
            <textarea
              id="commentTextarea"
              name="content"
              class="comment-textarea"
              placeholder="Podziel siƒô swoimi wra≈ºeniami..."
              rows="3"
              maxlength="2000"
              required
              data-i18n-attrs="placeholder:community.comment.placeholder"
            ></textarea>
            <div class="comment-photos-preview" id="commentPhotosPreview" hidden></div>
            <div class="add-comment-actions">
              <label class="btn btn-secondary secondary photo-upload-label">
                <span data-i18n="community.photo.add">üì∑ Dodaj zdjƒôcia</span>
                <input
                  type="file"
                  id="photoUploadInput"
                  accept="image/jpeg,image/png,image/webp"
                  multiple
                  hidden
                />
              </label>
              <button
                type="submit"
                class="btn btn-primary primary"
                data-i18n="community.comment.submit"
              >
                Opublikuj
              </button>
            </div>
          </form>
        </div>

        <!-- Comments List -->
        <div class="comments-list" id="commentsList">
          <div class="loading-spinner">
            <div class="spinner"></div>
            <p data-i18n="community.loading">≈Åadowanie komentarzy...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Language Switcher - MUST load before other scripts that use getPoiName() -->
  <script src="js/languageSwitcher.js" defer></script>
  
  <!-- Global Language Refresh System -->
  <script src="js/languageRefresh.js?v=2" defer></script>
  
  <script src="js/saved-catalog.js?v=5" defer></script>
  
  <script type="module" src="js/home-recommendations.js?v=9" defer></script>
  <script type="module" src="js/home-cars.js?v=10" defer></script>
  
  <!-- Load core application (defer to wait for poi-loader) -->
  <script src="js/app-core.js?v=15" defer></script>
  <!-- SOS Emergency Modal -->
  <script src="js/sos.js?v=1" defer></script>
  <!-- Header Stats - aktualizacja statystyk na wszystkich stronach -->
  <script src="js/header-stats.js?v=2" defer></script>
  <!-- Community UI (module) for comments/ratings modal on this page -->
  <script type="module" src="js/community/ui.js?v=1"></script>
  <!-- Bridge to sync list, panel and map on the homepage -->
  <script src="js/home-community-bridge.js?v=6" defer></script>
  <script src="assets/js/modal-auth.js" defer></script>


  <div
    id="auth-modal"
    class="modal"
    role="dialog"
    aria-modal="true"
    aria-labelledby="auth-title"
    aria-hidden="true"
  >
    <div class="modal__dialog" tabindex="-1" role="document">
      <button
        class="modal__close"
        type="button"
        aria-label="Zamknij"
        data-close
        data-i18n-attrs="aria-label:auth.close.label"
      >
        √ó
      </button>
      <h2 id="auth-title" data-i18n="auth.title">Do≈ÇƒÖcz do przygody</h2>
      <p class="auth-intro" data-i18n="auth.intro">Zaloguj siƒô, utw√≥rz konto lub graj jako go≈õƒá.</p>
      <div class="auth-modal__content" data-auth-view-root>
        <div data-auth="login">
          <div role="presentation">
            <div class="auth-modal__tabs" role="tablist">
              <button
                type="button"
                class="auth-modal__tab is-active"
                role="tab"
                id="authTabLogin"
                aria-selected="true"
                aria-controls="authPanelLogin"
                data-auth-tab="login"
                data-i18n="auth.tab.login"
              >
                Logowanie
              </button>
              <button
                type="button"
                class="auth-modal__tab"
                role="tab"
                id="authTabRegister"
                aria-selected="false"
                aria-controls="authPanelRegister"
                data-auth-tab="register"
                data-i18n="auth.tab.register"
                tabindex="-1"
              >
                Rejestracja
              </button>
              
            </div>
            <div class="auth-modal__panels">
              <section
                id="authPanelLogin"
                class="auth-modal__panel is-active"
                role="tabpanel"
                aria-labelledby="authTabLogin"
                data-auth="login"
                data-auth-panel="login"
              >
                <form id="form-login" class="auth-form" novalidate data-ce-auth-handler="supabase">
                  <label for="loginEmail" data-i18n="auth.login.username">Email lub nazwa u≈ºytkownika</label>
                  <input
                    id="loginEmail"
                    name="email"
                    type="text"
                    autocomplete="username"
                    required
                    aria-label="Email lub nazwa u≈ºytkownika"
                    data-i18n-attrs="aria-label:auth.login.username,placeholder:auth.login.username"
                    placeholder="Email lub nazwa u≈ºytkownika"
                  />
                  <label for="loginPassword" data-i18n="auth.password">Has≈Ço</label>
                  <input
                    id="loginPassword"
                    name="password"
                    type="password"
                    autocomplete="current-password"
                    required
                    aria-label="Has≈Ço"
                    data-i18n-attrs="aria-label:auth.password"
                  />
                  <div class="auth-form__actions">
                    <button
                      type="submit"
                      class="btn btn--primary"
                      data-i18n="auth.login.button"
                      data-i18n-attrs="aria-label:auth.login.button"
                      aria-label="Zaloguj siƒô"
                    >
                      Zaloguj siƒô
                    </button>
                    <button
                      type="button"
                      class="auth-form__link"
                      id="loginForgotPassword"
                      data-i18n="auth.reset.button"
                      data-i18n-attrs="aria-label:auth.reset.button"
                      aria-label="üîë Resetuj has≈Ço"
                    >
                      üîë Resetuj has≈Ço
                    </button>
                  </div>
                  <div data-auth="message" aria-live="polite"></div>
                  <p class="auth-form__meta" id="authResendVerification" hidden>
                    Nie otrzyma≈Çe≈õ wiadomo≈õci z potwierdzeniem?
                    <button type="button" class="auth-form__link" id="btn-resend-verification">
                      Wy≈õlij ponownie link weryfikacyjny
                    </button>
                  </p>
                </form>
              </section>
              <section
                id="authPanelRegister"
                class="auth-modal__panel"
                role="tabpanel"
                aria-labelledby="authTabRegister"
                data-auth="login"
                data-auth-panel="register"
                hidden
              >
                <form
                  id="form-register"
                  class="auth-form"
                  novalidate
                  data-auth="register"
                  data-ce-auth-handler="supabase"
                >
                  <label for="registerFirstName" data-i18n="auth.firstName">Imiƒô</label>
                  <input
                    id="registerFirstName"
                    name="firstName"
                    type="text"
                    autocomplete="given-name"
                    maxlength="60"
                    required
                    aria-label="Imiƒô"
                    data-i18n-attrs="aria-label:auth.firstName"
                  />
                  <label for="registerUsername" data-i18n="auth.username">Nazwa u≈ºytkownika</label>
                  <input
                    id="registerUsername"
                    name="username"
                    type="text"
                    autocomplete="username"
                    minlength="3"
                    maxlength="20"
                    pattern="[a-zA-Z0-9_]+"
                    required
                    aria-label="Nazwa u≈ºytkownika"
                    data-i18n-attrs="aria-label:auth.username,placeholder:auth.username.hint"
                    placeholder="3-20 znak√≥w, litery i cyfry"
                  />
                  <label for="registerEmail" data-i18n="auth.email">Adres e-mail</label>
                  <input
                    id="registerEmail"
                    name="email"
                    type="email"
                    autocomplete="email"
                    required
                    aria-label="Adres e-mail"
                    data-i18n-attrs="aria-label:auth.email"
                  />
                  <label for="registerPassword" data-i18n="auth.password">Has≈Ço</label>
                  <input
                    id="registerPassword"
                    name="password"
                    type="password"
                    autocomplete="new-password"
                    minlength="8"
                    required
                    aria-label="Has≈Ço"
                    data-i18n-attrs="aria-label:auth.password"
                  />
                  <label for="registerPasswordConfirm" data-i18n="auth.confirmPassword">Powt√≥rz has≈Ço</label>
                  <input
                    id="registerPasswordConfirm"
                    name="passwordConfirm"
                    type="password"
                    autocomplete="new-password"
                    minlength="8"
                    aria-label="Powt√≥rz has≈Ço"
                    data-i18n-attrs="aria-label:auth.confirmPassword"
                  />
                  <div data-auth="message" aria-live="polite"></div>
                  <p class="form-hint" data-i18n="auth.register.hint">
                    Po rejestracji sprawd≈∫ skrzynkƒô e-mail, aby potwierdziƒá konto.
                  </p>
                  <button
                    type="submit"
                    class="btn btn--primary"
                    data-i18n="auth.register.button"
                    data-i18n-attrs="aria-label:auth.register.button"
                    aria-label="Utw√≥rz konto"
                  >
                    Utw√≥rz konto
                  </button>
                </form>
              </section>
              
            </div>
            <dialog id="resetPasswordDialog" class="auth-reset-dialog">
              <form id="form-reset-password" class="auth-form" novalidate>
                <header class="auth-reset-dialog__header">
                  <h2 data-i18n="auth.reset.title">Resetuj has≈Ço</h2>
                  <button type="button" class="auth-form__link" id="btn-reset-close" data-i18n-attrs="aria-label:auth.reset.close" aria-label="Zamknij">‚úñ</button>
                </header>
                <p data-i18n="auth.reset.description">Podaj adres e-mail powiƒÖzany z kontem, a wy≈õlemy link do zmiany has≈Ça.</p>
                <label for="resetEmail" data-i18n="auth.reset.emailLabel">Adres e-mail</label>
                <input id="resetEmail" name="email" type="email" autocomplete="email" required />
                <div class="auth-form__actions">
                  <button type="submit" class="btn btn--primary">Wy≈õlij link resetujƒÖcy</button>
                  <button type="button" class="auth-form__link" id="btn-reset-cancel">Anuluj</button>
                </div>
              </form>
            </dialog>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div
    class="sos-modal"
    id="sosModal"
    hidden
    role="dialog"
    aria-modal="true"
    aria-labelledby="sosTitle"
    aria-describedby="sosDescription"
  >
    <div class="sos-dialog" role="document" tabindex="-1">
      <header class="sos-header">
        <div>
          <h2 id="sosTitle" data-i18n="sos.title">SOS</h2>
          <p id="sosDescription" data-i18n="sos.description">
            Szybki dostƒôp do numer√≥w alarmowych, kontaktu z ambasadƒÖ oraz wskaz√≥wek medycznych.
          </p>
        </div>
        <button
          type="button"
          class="icon-button"
          id="sosClose"
          aria-label="Zamknij SOS"
          data-i18n="sos.close"
        >
          X
        </button>
      </header>

      <div class="sos-grid" aria-describedby="sosDescription">
        <section class="sos-card">
          <h3 data-i18n="sos.emergency.title">üöë Numery alarmowe na Cyprze</h3>
          <ul>
            <li>
              <strong>112</strong>
              <p data-i18n="sos.emergency.eu">
                Uniwersalny numer alarmowy UE (policja, pogotowie, stra≈º po≈ºarna). <a href="tel:112">Zadzwo≈Ñ teraz</a>
              </p>
            </li>
            <li>
              <strong>199</strong>
              <p data-i18n="sos.emergency.cyprus">
                Cypryjski numer alarmowy ‚Äì dzia≈Ça r√≥wnolegle z 112. <a href="tel:199">Po≈ÇƒÖcz</a>
              </p>
            </li>
            <li>
              <strong>+357 22 802 020</strong>
              <p data-i18n="sos.emergency.police">
                Ca≈Çodobowa linia policji (spoza Cypru wybierz pe≈Çny numer kierunkowy). <a href="tel:+35722802020">Zadzwo≈Ñ</a>
              </p>
            </li>
          </ul>
        </section>

        <section class="sos-card">
          <h3 data-i18n="sos.embassy.title">üõ°Ô∏è Ambasada RP w Nikozji</h3>
          <ul>
            <li>
              <strong>Telefon alarmowy</strong>
              <p data-i18n="sos.embassy.hotline">
                <a href="tel:+35799660451">+357 99 660 451</a> (wsparcie w nag≈Çych wypadkach obywateli RP).
              </p>
            </li>
            <li>
              <strong>Recepcja</strong>
              <p data-i18n="sos.embassy.reception">
                <a href="tel:+35722751777">+357 22 751 777</a> (pon.‚Äìpt. w godz. pracy plac√≥wki).
              </p>
            </li>
            <li>
              <strong>Adres</strong>
              <p data-i18n="sos.embassy.address">
                14, Ifigenias Street, 2007 Nikozja ‚Ä¢ <a href="https://maps.google.com/?q=Embassy+of+Poland+in+Cyprus" target="_blank" rel="noopener">Wyznacz trasƒô</a>
              </p>
            </li>
            <li>
              <strong>E-mail</strong>
              <p data-i18n="sos.embassy.email"><a href="mailto:nicosia.info@msz.gov.pl">nicosia.info@msz.gov.pl</a></p>
            </li>
          </ul>
        </section>

        <section class="sos-card">
          <h3 data-i18n="sos.healthcare.title">üè• Najbli≈ºsza pomoc medyczna</h3>
          <ul>
            <li>
              <strong>Paphos General Hospital</strong>
              <p data-i18n="sos.healthcare.hospital">
                Ca≈Çodobowa izba przyjƒôƒá, Anavargos, Pafos. <a href="tel:+35726803000">+357 26 803 000</a> ‚Ä¢
                <a href="https://maps.google.com/?q=Paphos+General+Hospital" target="_blank" rel="noopener">Mapa dojazdu</a>
              </p>
            </li>
            <li>
              <strong data-i18n="sos.healthcare.searchTitle">Wyszukaj szpital w pobli≈ºu</strong>
              <p data-i18n="sos.healthcare.search">
                <a href="https://www.google.com/maps/search/hospital+near+me/" target="_blank" rel="noopener">Otw√≥rz listƒô szpitali na Mapach Google</a>
                i udostƒôpnij lokalizacjƒô, aby zobaczyƒá najbli≈ºsze opcje.
              </p>
            </li>
            <li>
              <strong data-i18n="sos.healthcare.pharmacyTitle">Dy≈ºurna apteka</strong>
              <p data-i18n="sos.healthcare.pharmacy">
                Sprawd≈∫ aktualne dy≈ºury na <a href="https://pharmacy.dl.moh.gov.cy/" target="_blank" rel="noopener">stronie Ministerstwa Zdrowia</a>
                lub wyszukaj <a href="https://www.google.com/maps/search/pharmacy+near+me/" target="_blank" rel="noopener">aptekƒô w pobli≈ºu</a>.
              </p>
            </li>
          </ul>
          <p class="sos-note" data-i18n="sos.healthcare.note">
            W sytuacji zagro≈ºenia ≈ºycia zawsze dzwo≈Ñ pod 112 i dok≈Çadnie podaj lokalizacjƒô. W aplikacji w≈ÇƒÖcz udostƒôpnianie
            lokalizacji, aby szybciej odnale≈∫ƒá pomoc na mapie.
          </p>
        </section>
      </div>
    </div>
  </div>

  <div
    class="account-modal"
    id="accountModal"
    hidden
    role="dialog"
    aria-modal="true"
    aria-labelledby="accountTitle"
    data-gated="true"
    data-ce-account-enhanced="true"
  >
    <div class="account-dialog">
      <header class="account-header">
        <div>
          <h2 id="accountTitle" data-i18n="account.title">Panel statystyk</h2>
          <p id="accountSubtitle" data-i18n="account.subtitle">
            PrzeglƒÖdaj swoje postƒôpy, zmieniaj has≈Ço i kontroluj przygodƒô.
          </p>
        </div>
        <button
          type="button"
          class="icon-button"
          id="accountClose"
          aria-label="Zamknij ustawienia konta"
          data-i18n="account.close"
        >
          ‚úï
        </button>
      </header>

      <div class="account-body">
        <div class="account-tabs" role="tablist">
          <button
            type="button"
            class="account-tab is-active"
            role="tab"
            aria-selected="true"
            aria-controls="accountPanelStats"
            data-account-tab="stats"
            id="accountTabStats"
            data-i18n="account.tabs.stats"
          >
            üìà Statystyki
          </button>
          <button
            type="button"
            class="account-tab"
            role="tab"
            aria-selected="false"
            aria-controls="accountPanelSecurity"
            data-account-tab="security"
            id="accountTabSecurity"
            tabindex="-1"
            data-i18n="account.tabs.security"
          >
            üîê Bezpiecze≈Ñstwo
          </button>
        </div>

        <div class="account-status">
          <div
            id="accountMessage"
            class="account-message"
            role="status"
            aria-live="polite"
            data-account-message
            hidden
          ></div>
          <div data-account-loading hidden>Trwa wczytywanie danych konta‚Ä¶</div>
        </div>

        <div data-account-content>
          <section
            class="account-panel is-active"
            id="accountPanelStats"
            role="tabpanel"
            aria-labelledby="accountTabStats"
            data-account-panel="stats"
          >
            <section class="account-card" aria-labelledby="accountProfileHeading">
              <div>
                <h3 id="accountProfileHeading">Tw√≥j profil</h3>
                <p>Podstawowe informacje o koncie i postƒôpy w przygodzie.</p>
              </div>
              
              <!-- Avatar Section -->
              <div class="profile-avatar-section">
                <div class="profile-avatar">
                  <img id="profileAvatarImg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23e0e7ff'/%3E%3Cpath d='M50 45c8.284 0 15-6.716 15-15s-6.716-15-15-15-15 6.716-15 15 6.716 15 15 15zM20 75c0-16.569 13.431-30 30-30s30 13.431 30 30v10H20V75z' fill='%233b82f6'/%3E%3C/svg%3E" alt="Avatar" crossorigin="anonymous">
                </div>
                <div class="profile-avatar-actions">
                  <input type="file" id="avatarUpload" accept="image/jpeg,image/png,image/gif,image/webp" hidden>
                  <button type="button" id="btnUploadAvatar" class="btn btn-secondary">
                    üì∑ Zmie≈Ñ zdjƒôcie
                  </button>
                  <button type="button" id="btnRemoveAvatar" class="btn btn-ghost" hidden>
                    üóëÔ∏è Usu≈Ñ
                  </button>
                </div>
              </div>
              
              <dl class="profile-grid">
                <div>
                  <dt>E-mail</dt>
                  <dd data-account-email>‚Äî</dd>
                </div>
                <div>
                  <dt>Nazwa u≈ºytkownika</dt>
                  <dd data-account-username>‚Äî</dd>
                </div>
                <div>
                  <dt>Imiƒô wy≈õwietlane</dt>
                  <dd data-account-name>‚Äî</dd>
                </div>
                <div>
                  <dt>XP</dt>
                  <dd data-account-xp>0</dd>
                </div>
                <div>
                  <dt>Poziom</dt>
                  <dd data-account-level>0</dd>
                </div>
                <div>
                  <dt>Ostatnia aktualizacja</dt>
                  <dd data-account-updated>‚Äî</dd>
                </div>
              </dl>
            </section>

            <section class="account-card" aria-labelledby="accountXpHeading">
              <div>
                <h3 id="accountXpHeading">Ostatnie zdarzenia XP</h3>
                <p>Monitoruj, jak zdobywasz do≈õwiadczenie w CyprusEye.</p>
              </div>
              <p id="accountXpEmpty" data-account-xp-empty hidden>Brak zarejestrowanych zdarze≈Ñ XP.</p>
              <ul id="accountXpEvents" class="xp-list" aria-live="polite"></ul>
            </section>

            <div class="account-stats-grid">
              <article class="account-stat-card">
                <h3 data-i18n="account.stats.level.title">Poziom</h3>
                <p class="account-stat-value" id="accountStatLevel">1</p>
                <p class="account-stat-label" data-i18n="account.stats.level.description">Aktualny poziom przygody</p>
              </article>
              <article class="account-stat-card">
                <h3 data-i18n="account.stats.xp.title">Do≈õwiadczenie</h3>
                <p class="account-stat-value" id="accountStatXp">0 XP</p>
                <p class="account-stat-label" data-i18n="account.stats.xp.description">≈ÅƒÖcznie zdobytych punkt√≥w</p>
              </article>
              <article class="account-stat-card">
                <h3 data-i18n="account.stats.badges.title">Odznaki</h3>
                <p class="account-stat-value" id="accountStatBadges">0</p>
                <p class="account-stat-label" data-i18n="account.stats.badges.description">Zebrane unikalne odznaki</p>
              </article>
              <article class="account-stat-card">
                <h3 data-i18n="account.stats.visited.title">Odwiedzone miejsca</h3>
                <p class="account-stat-value" id="accountStatVisited">0</p>
                <p class="account-stat-label" data-i18n="account.stats.visited.description">Liczba odkrytych atrakcji</p>
              </article>
              <article class="account-stat-card">
                <h3 data-i18n="account.stats.tasks.title">Uko≈Ñczone zadania</h3>
                <p class="account-stat-value" id="accountStatTasks">0</p>
                <p class="account-stat-label" data-i18n="account.stats.tasks.description">Wykonane misje i checklisty</p>
              </article>
              <article class="account-stat-card">
                <h3 data-i18n="account.stats.streak.title">Passa dnia</h3>
                <p class="account-stat-value" id="accountStatStreak">0</p>
                <p class="account-stat-label" data-i18n="account.stats.streak.description">
                  Aktualna / najlepsza: <span id="accountStatBestStreak">0</span>
                </p>
              </article>
            </div>

            <div class="account-reset-card">
              <h3 data-i18n="account.reset.title">Wyzeruj statystyki</h3>
              <p id="accountResetDescription" data-i18n="account.reset.description">
                Rozpocznij przygodƒô od nowa ‚Äì reset obejmie do≈õwiadczenie, odznaki, odwiedzone miejsca i zadania.
              </p>
              <button
                type="button"
                class="btn btn-danger danger"
                id="accountResetProgress"
                data-i18n="account.reset.action"
              >
                üîÑ Zresetuj postƒôp
              </button>
            </div>
          </section>

          <section
            class="account-panel"
            id="accountPanelSecurity"
            role="tabpanel"
            aria-labelledby="accountTabSecurity"
            data-account-panel="security"
            hidden
          >
            <section class="account-card" aria-labelledby="accountUsernameHeading">
              <div>
                <h3 id="accountUsernameHeading">Zmie≈Ñ nazwƒô u≈ºytkownika</h3>
                <p>Ustaw identyfikator widoczny w rankingach, komentarzach i dzienniku podr√≥≈ºy.</p>
              </div>
              <form id="accountUsernameForm" class="account-form account-form--stack" novalidate>
                <label for="accountUsernameInput">
                  Nowa nazwa u≈ºytkownika
                  <input
                    id="accountUsernameInput"
                    name="username"
                    type="text"
                    inputmode="text"
                    autocomplete="username"
                    autocapitalize="none"
                    autocorrect="off"
                    spellcheck="false"
                    placeholder="np. cyprus.explorer"
                    minlength="3"
                    maxlength="30"
                    required
                  />
                </label>
                <p class="account-form__hint">
                  Dozwolone litery, cyfry, kropki, my≈õlniki i podkre≈õlenia (3‚Äì30 znak√≥w).
                </p>
                <button type="submit">Zapisz nazwƒô</button>
              </form>
            </section>

            <section class="account-card" aria-labelledby="accountNameHeading">
              <div>
                <h3 id="accountNameHeading">Imiƒô wy≈õwietlane</h3>
                <p>To imiƒô pojawia siƒô w powiadomieniach oraz powitaniach w aplikacji.</p>
              </div>
              <form id="accountNameForm" class="account-form account-form--stack" novalidate>
                <label for="accountNameInput">
                  Imiƒô
                  <input
                    id="accountNameInput"
                    name="name"
                    type="text"
                    autocomplete="given-name"
                    placeholder="Twoje imiƒô"
                    minlength="2"
                    maxlength="60"
                    required
                  />
                </label>
                <button type="submit">Zapisz imiƒô</button>
              </form>
            </section>

            <section class="account-card" aria-labelledby="accountPasswordHeading">
              <div>
                <h3 id="accountPasswordHeading">Aktualizuj has≈Ço</h3>
                <p>U≈ºyj silnego has≈Ça, aby chroniƒá konto przed niepowo≈Çanym dostƒôpem.</p>
              </div>
              <form
                id="accountPasswordForm"
                class="account-form account-form--grid"
                data-ce-account-handler="enhanced"
                novalidate
              >
                <label for="accountCurrentPassword">
                  Obecne has≈Ço
                  <input
                    id="accountCurrentPassword"
                    name="current_password"
                    type="password"
                    autocomplete="current-password"
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    required
                  />
                </label>
                <label for="accountNewPassword">
                  Nowe has≈Ço
                  <input
                    id="accountNewPassword"
                    name="new_password"
                    type="password"
                    autocomplete="new-password"
                    minlength="8"
                    placeholder="Minimum 8 znak√≥w"
                    required
                  />
                </label>
                <label for="accountConfirmPassword">
                  Powt√≥rz nowe has≈Ço
                  <input
                    id="accountConfirmPassword"
                    name="confirm_password"
                    type="password"
                    autocomplete="new-password"
                    minlength="8"
                    placeholder="Potwierd≈∫ has≈Ço"
                    required
                  />
                </label>
                <p class="account-form__hint">
                  Has≈Ço powinno mieƒá co najmniej 8 znak√≥w i zawieraƒá mieszankƒô liter oraz cyfr.
                </p>
                <button type="submit">Zmie≈Ñ has≈Ço</button>
              </form>
            </section>

            <p
              class="account-guest-note"
              id="accountGuestPasswordNote"
              data-account-guest-note
              data-ce-account-enhanced="true"
              hidden
            >
              Go≈õcie nie posiadajƒÖ hase≈Ç ‚Äì zaloguj siƒô, aby zmieniƒá dane konta.
            </p>
          </section>
        </div>
      </div>
    </div>
  </div>
  <script type="module" src="assets/js/account-modal.js?v=2"></script>
  <script type="module" src="assets/js/auth-ui.js?v=2"></script>

  <!-- Fullscreen Lightbox for hotel gallery -->
  <div class="lightbox" id="imgLightbox" hidden>
    <div class="lightbox-content" id="lightboxContent">
      <img id="lbImg" class="lightbox-img" alt="Preview" data-i18n-attrs="alt:lightbox.alt" />
      <button id="lbClose" class="lightbox-close" type="button" aria-label="Close" data-i18n-attrs="aria-label:lightbox.close">‚úï</button>
      <button id="lbPrev" class="lightbox-arrow lightbox-prev" type="button" aria-label="Previous" data-i18n-attrs="aria-label:lightbox.prev">‚Äπ</button>
      <button id="lbNext" class="lightbox-arrow lightbox-next" type="button" aria-label="Next" data-i18n-attrs="aria-label:lightbox.next">‚Ä∫</button>
    </div>
  </div>
  <!-- Hotel Details Modal (same structure as /hotels) -->
  <div class="trip-modal" id="hotelModal" hidden>
    <div class="trip-modal-content">
      <button class="trip-modal-nav prev" type="button" aria-label="Poprzednia" id="hotelModalPrev">‚Äπ</button>
      <button class="trip-modal-nav next" type="button" aria-label="Nastƒôpna" id="hotelModalNext">‚Ä∫</button>
      <button class="trip-modal-close" onclick="closeHotelModal()">‚úï</button>
      <img class="trip-modal-image" id="modalHotelImage" src="" alt="Hotel" />
      <div id="modalHotelThumbs" class="gallery-thumbs"></div>
      <div class="trip-modal-header" style="text-align:center">
        <div class="ce-modal-title-row">
          <h2 class="trip-modal-title" id="modalHotelTitle">Hotel</h2>
          <button
            type="button"
            id="modalHotelSaveBtn"
            class="ce-save-star"
            data-ce-save="1"
            data-item-type="hotel"
            data-ref-id=""
            aria-label="Zapisz"
            title="Zapisz"
            onclick="event.preventDefault(); event.stopPropagation();"
          >‚òÜ</button>
        </div>
        <p class="trip-modal-subtitle" id="modalHotelSubtitle">Miasto</p>
      </div>
      <div class="trip-modal-body">
        <div class="trip-section">
          <h3 class="trip-section-title" data-i18n="modal.description">Opis</h3>
          <div class="trip-description" id="modalHotelDescription"></div>
          <div class="hotel-amenities-chips" id="hotelAmenitiesChips" style="display:none;"></div>
        </div>

        <div class="trip-section">
          <h3 class="trip-section-title" data-i18n="modal.booking">Rezerwacja</h3>
          <form class="booking-form" id="hotelBookingForm">
            <div class="form-row">
              <div class="form-field">
                <label data-i18n="modal.form.name">Imiƒô i nazwisko *</label>
                <input name="name" required />
              </div>
              <div class="form-field">
                <label data-i18n="modal.form.email">Email *</label>
                <input type="email" name="email" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label data-i18n="modal.form.phone">Telefon</label>
                <input name="phone" />
              </div>
              <div class="form-field">
                <label data-i18n="modal.form.arrival">Data przyjazdu *</label>
                <input type="date" name="arrival_date" id="hotelArrivalDate" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label data-i18n="modal.form.departure">Data wyjazdu *</label>
                <input type="date" name="departure_date" id="hotelDepartureDate" required />
              </div>
              <div class="form-field">
                <label data-i18n="modal.form.adults">Doro≈õli</label>
                <input type="number" name="adults" id="hotelBookingAdults" min="1" value="2" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label data-i18n="modal.form.children">Dzieci</label>
                <input type="number" name="children" id="hotelBookingChildren" min="0" value="0" />
              </div>
            </div>
            <div class="form-field">
              <label data-i18n="modal.form.notes">Uwagi (opcjonalnie)</label>
              <textarea name="notes"></textarea>
            </div>

            <div class="trip-price-box">
              <p class="trip-price-label" data-i18n="modal.form.price">Cena</p>
              <p class="trip-price-value" id="modalHotelPrice">‚Äî</p>
            </div>
            <div id="hotelPriceNote" class="booking-message" style="display:none"></div>

            <button type="submit" class="booking-submit" data-i18n="modal.form.submit">Zarezerwuj</button>
            <div id="hotelBookingMessage" class="booking-message" style="display:none;"></div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <!-- Trip Details Modal (same as /trips) -->
  <div class="trip-modal" id="tripModal" hidden>
    <div class="trip-modal-content">
      <button class="trip-modal-nav prev" type="button" aria-label="Poprzednia" id="tripModalPrev">‚Äπ</button>
      <button class="trip-modal-nav next" type="button" aria-label="Nastƒôpna" id="tripModalNext">‚Ä∫</button>
      <button class="trip-modal-close" onclick="closeTripModal()">‚úï</button>
      <img class="trip-modal-image" id="modalTripImage" src="" alt="Trip" />
      <div class="trip-modal-header">
        <div class="ce-modal-title-row">
          <h2 class="trip-modal-title" id="modalTripTitle">Trip Title</h2>
          <button
            type="button"
            id="modalTripSaveBtn"
            class="ce-save-star"
            data-ce-save="1"
            data-item-type="trip"
            data-ref-id=""
            aria-label="Zapisz"
            title="Zapisz"
            onclick="event.preventDefault(); event.stopPropagation();"
          >‚òÜ</button>
        </div>
        <p class="trip-modal-subtitle" id="modalTripSubtitle">Subtitle</p>
      </div>
      <div class="trip-modal-body">
        <div class="trip-section">
          <h3 class="trip-section-title" data-i18n="modal.description">Opis</h3>
          <div class="trip-description" id="modalTripDescription"></div>
        </div>
        <div class="trip-section">
          <h3 class="trip-section-title" data-i18n="modal.booking">Rezerwacja</h3>
          <form class="booking-form" id="bookingForm">
            <div class="form-row">
              <div class="form-field">
                <label for="bookingName" data-i18n="modal.form.name">Imiƒô i nazwisko *</label>
                <input type="text" id="bookingName" name="name" required />
              </div>
              <div class="form-field">
                <label for="bookingEmail" data-i18n="modal.form.email">Email *</label>
                <input type="email" id="bookingEmail" name="email" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label for="bookingPhone" data-i18n="modal.form.phone">Telefon</label>
                <input type="tel" id="bookingPhone" name="phone" />
              </div>
              <div class="form-field">
                <label for="bookingDate" data-i18n="modal.form.tripDate">Preferowana data wycieczki</label>
                <input type="date" id="bookingDate" name="trip_date" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-field">
                <label for="arrivalDate" data-i18n="modal.form.arrivalCyprus">Data przylotu na Cypr *</label>
                <input type="date" id="arrivalDate" name="arrival_date" required />
              </div>
              <div class="form-field">
                <label for="departureDate" data-i18n="modal.form.departureCyprus">Data wylotu z Cypru *</label>
                <input type="date" id="departureDate" name="departure_date" required />
              </div>
            </div>
            <div class="form-row" id="peopleFields">
              <div class="form-field">
                <label for="bookingAdults" data-i18n="modal.form.adults">Liczba doros≈Çych</label>
                <input type="number" id="bookingAdults" name="adults" min="1" value="1" />
              </div>
              <div class="form-field">
                <label for="bookingChildren" data-i18n="modal.form.children">Dzieci</label>
                <input type="number" id="bookingChildren" name="children" min="0" value="0" />
              </div>
            </div>
            <div class="form-row" id="timeFields" style="display:none;">
              <div class="form-field">
                <label for="bookingHours" data-i18n="modal.form.hours">Liczba godzin</label>
                <input type="number" id="bookingHours" name="hours" min="1" value="1" />
              </div>
              <div class="form-field">
                <label for="bookingDays" data-i18n="modal.form.days">Liczba dni</label>
                <input type="number" id="bookingDays" name="days" min="1" value="1" />
              </div>
            </div>
            <div class="form-field">
              <label for="bookingNotes" data-i18n="modal.form.notes">Uwagi (opcjonalnie)</label>
              <textarea id="bookingNotes" name="notes"></textarea>
            </div>
            <div class="trip-price-box">
              <p class="trip-price-label" data-i18n="modal.form.price">Cena</p>
              <p class="trip-price-value" id="modalTripPrice">0.00 ‚Ç¨</p>
            </div>
            <button type="submit" class="booking-submit" data-i18n="modal.form.submit">Zarezerwuj</button>
            <div id="bookingMessage" class="booking-message" style="display:none;"></div>
          </form>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
