<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prosty Test - Bez CSP</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
        h1 { color: #2563eb; }
        #map { width: 100%; height: 500px; border: 2px solid #333; margin: 20px 0; }
        .status { padding: 15px; margin: 10px 0; border-radius: 8px; font-weight: bold; }
        .success { background: #d1fae5; color: #065f46; }
        .error { background: #fee2e2; color: #991b1b; }
        .info { background: #dbeafe; color: #1e40af; }
        pre { background: #f3f4f6; padding: 15px; border-radius: 6px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üî¨ Prosty Test Mapy - BEZ CSP</h1>
    <p><strong>Ten plik NIE ma Content Security Policy - testujemy czy problem jest w CSP czy gdzie indziej</strong></p>
    
    <div id="status" class="status info">≈Åadowanie...</div>
    
    <div id="map"></div>
    
    <h2>Console Output:</h2>
    <pre id="console"></pre>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const statusEl = document.getElementById('status');
        const consoleEl = document.getElementById('console');
        
        function log(message, type = 'info') {
            const time = new Date().toLocaleTimeString();
            consoleEl.textContent += `[${time}] ${message}\n`;
            console.log(message);
        }
        
        log('üöÄ Start testu mapy');
        
        try {
            // Sprawd≈∫ czy Leaflet zosta≈Ç za≈Çadowany
            if (typeof L === 'undefined') {
                throw new Error('‚ùå Leaflet nie zosta≈Ç za≈Çadowany!');
            }
            log('‚úÖ Leaflet za≈Çadowany');
            log(`   Wersja: ${L.version}`);
            
            // Inicjalizacja mapy
            log('üó∫Ô∏è Tworzenie mapy...');
            const map = L.map('map').setView([35.095, 33.203], 9);
            log('‚úÖ Mapa utworzona');
            
            // Dodanie kafelk√≥w
            log('üì¶ Dodawanie kafelk√≥w OpenStreetMap...');
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);
            log('‚úÖ Kafelki dodane');
            
            // Dodanie marker√≥w testowych
            log('üìç Dodawanie marker√≥w...');
            const testMarkers = [
                { name: 'Paphos', coords: [34.75567, 32.40417] },
                { name: 'Limassol', coords: [34.67658, 33.04979] },
                { name: 'Larnaca', coords: [34.9125, 33.6333] },
                { name: 'Nicosia', coords: [35.185566, 33.382276] },
                { name: 'Ayia Napa', coords: [34.99, 33.97] }
            ];
            
            testMarkers.forEach(marker => {
                L.marker(marker.coords)
                    .addTo(map)
                    .bindPopup(`<strong>${marker.name}</strong>`);
                log(`   ‚úÖ Marker: ${marker.name}`);
            });
            
            statusEl.className = 'status success';
            statusEl.textContent = `‚úÖ Mapa dzia≈Ça poprawnie! Za≈Çadowano ${testMarkers.length} marker√≥w.`;
            log(`\nüéâ TEST ZAKO≈ÉCZONY SUKCESEM!`);
            log(`\nJe≈õli ten test dzia≈Ça, problem jest w CSP lub app.js, NIE w Leaflet!`);
            
        } catch (error) {
            statusEl.className = 'status error';
            statusEl.textContent = `‚ùå B≈ÇƒÖd: ${error.message}`;
            log(`\n‚ùå B≈ÅƒÑD: ${error.message}`);
            log(`Stack: ${error.stack}`);
            console.error('B≈ÇƒÖd testu:', error);
        }
        
        // Sprawd≈∫ czy kafelki siƒô ≈ÇadujƒÖ
        setTimeout(() => {
            log('\nüîç Sprawdzam ≈Çadowanie kafelk√≥w...');
            const tiles = document.querySelectorAll('.leaflet-tile');
            if (tiles.length > 0) {
                log(`‚úÖ Znaleziono ${tiles.length} kafelk√≥w na mapie`);
            } else {
                log('‚ö†Ô∏è UWAGA: Nie znaleziono kafelk√≥w - mo≈ºe byƒá problem z sieciƒÖ lub CSP');
            }
        }, 3000);
    </script>
</body>
</html>
