<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Console</title>
    <style>
        body { margin: 0; padding: 20px; font-family: monospace; background: #1a1a1a; color: #f0f0f0; }
        h1 { color: #60a5fa; }
        .error { color: #f87171; background: #7f1d1d; padding: 10px; margin: 5px 0; border-radius: 4px; }
        .warning { color: #fbbf24; background: #78350f; padding: 10px; margin: 5px 0; border-radius: 4px; }
        .info { color: #93c5fd; background: #1e3a8a; padding: 10px; margin: 5px 0; border-radius: 4px; }
        .success { color: #86efac; background: #14532d; padding: 10px; margin: 5px 0; border-radius: 4px; }
        pre { background: #262626; padding: 15px; border-radius: 6px; overflow-x: auto; }
        button { background: #2563eb; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px; margin: 5px; }
        button:hover { background: #1d4ed8; }
        .test-section { margin: 20px 0; padding: 20px; background: #262626; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>üîç Debug Console - CyprusEye</h1>
    
    <div class="test-section">
        <h2>Szybkie Testy</h2>
        <button onclick="testLeaflet()">Test Leaflet</button>
        <button onclick="testAppJs()">Test app.js</button>
        <button onclick="testModules()">Test Modu≈Ç√≥w ES6</button>
        <button onclick="testMap()">Test Mapa DOM</button>
        <button onclick="openIndex()">Otw√≥rz Index.html</button>
    </div>
    
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            output.appendChild(div);
            console.log(message);
        }
        
        function testLeaflet() {
            output.innerHTML = '';
            log('üß™ Test Leaflet...', 'info');
            
            if (typeof L !== 'undefined') {
                log(`‚úÖ Leaflet za≈Çadowany! Wersja: ${L.version}`, 'success');
            } else {
                log('‚ùå Leaflet NIE JEST za≈Çadowany!', 'error');
                log('To znaczy ≈ºe problem jest z ≈Çadowaniem Leaflet w index.html', 'warning');
            }
        }
        
        function testAppJs() {
            output.innerHTML = '';
            log('üß™ Test app.js...', 'info');
            
            // Sprawd≈∫ czy app.js siƒô za≈Çadowa≈Ç
            fetch('/app.js')
                .then(response => {
                    if (response.ok) {
                        log(`‚úÖ app.js odpowiada (status: ${response.status})`, 'success');
                        return response.text();
                    } else {
                        throw new Error(`Status: ${response.status}`);
                    }
                })
                .then(content => {
                    log(`‚úÖ app.js ma ${content.length} znak√≥w`, 'success');
                    
                    // Sprawd≈∫ czy ma importy
                    if (content.includes('import')) {
                        log('‚úÖ app.js u≈ºywa ES6 imports', 'success');
                        log('‚ö†Ô∏è MUSI byƒá ≈Çadowany jako type="module"', 'warning');
                    }
                    
                    // Sprawd≈∫ kluczowe funkcje
                    const functions = ['initMap', 'bootstrap', 'loadLeafletResources', 'setupMapLazyLoading'];
                    functions.forEach(fn => {
                        if (content.includes(`function ${fn}`)) {
                            log(`‚úÖ Znaleziono funkcjƒô: ${fn}`, 'success');
                        } else {
                            log(`‚ö†Ô∏è Nie znaleziono funkcji: ${fn}`, 'warning');
                        }
                    });
                })
                .catch(error => {
                    log(`‚ùå B≈ÇƒÖd ≈Çadowania app.js: ${error.message}`, 'error');
                });
        }
        
        function testModules() {
            output.innerHTML = '';
            log('üß™ Test Modu≈Ç√≥w ES6...', 'info');
            
            const modules = [
                '/src/utils/dates.js',
                '/src/utils/translations.js',
                '/src/state/store.js',
                '/src/state/accounts.js'
            ];
            
            modules.forEach(module => {
                fetch(module)
                    .then(response => {
                        if (response.ok) {
                            log(`‚úÖ ${module} - OK`, 'success');
                        } else {
                            log(`‚ùå ${module} - B≈ÇƒÖd ${response.status}`, 'error');
                        }
                    })
                    .catch(error => {
                        log(`‚ùå ${module} - ${error.message}`, 'error');
                    });
            });
        }
        
        function testMap() {
            output.innerHTML = '';
            log('üß™ Test Element Mapy...', 'info');
            
            // Sprawd≈∫ w nowym oknie
            const win = window.open('/index.html', '_blank');
            
            setTimeout(() => {
                try {
                    const mapElement = win.document.getElementById('map');
                    if (mapElement) {
                        log('‚úÖ Element #map istnieje', 'success');
                        log(`üìê Wymiary: ${mapElement.offsetWidth}x${mapElement.offsetHeight}px`, 'info');
                        
                        if (mapElement.offsetHeight === 0) {
                            log('‚ùå PROBLEM: Mapa ma wysoko≈õƒá 0px!', 'error');
                        }
                        
                        // Sprawd≈∫ czy Leaflet zosta≈Ç zainicjalizowany
                        const hasLeaflet = mapElement.querySelector('.leaflet-container');
                        if (hasLeaflet) {
                            log('‚úÖ Leaflet zainicjalizowany na mapie', 'success');
                        } else {
                            log('‚ùå PROBLEM: Leaflet NIE zosta≈Ç zainicjalizowany!', 'error');
                            log('To znaczy ≈ºe initMap() nie zosta≈Ç wywo≈Çany', 'warning');
                        }
                    } else {
                        log('‚ùå Element #map NIE ISTNIEJE!', 'error');
                    }
                } catch (error) {
                    log(`‚ùå B≈ÇƒÖd: ${error.message}`, 'error');
                }
            }, 2000);
        }
        
        function openIndex() {
            window.open('/index.html', '_blank');
            log('üìÇ Otwarto index.html w nowej karcie', 'info');
            log('‚ö†Ô∏è Otw√≥rz DevTools (F12) w nowej karcie i sprawd≈∫ Console!', 'warning');
        }
        
        // Auto-test po za≈Çadowaniu
        window.addEventListener('load', () => {
            log('üöÄ Debug Console Za≈Çadowany', 'success');
            log('Kliknij przycisk aby uruchomiƒá test', 'info');
        });
    </script>
</body>
</html>
