<!doctype html><meta charset="utf-8"><meta name="supabase-url" content="https://daoohnbnnowmmcizgvrq.supabase.co"><meta name="supabase-anon" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRhb29obmJubm93bWNpemd2cnEiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTc2MDc2OTA0OSwiZXhwIjoyMDc2MzQ1MDQ5fQ.AJrmxrk18yWxL1_Ejk_SZ1-X04YxN4C8LXCn9c3yFSM"><title>My account</title>
<div id="me">Loadingâ€¦</div>
<button id="logout">Sign out</button>
<script type="module">
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
const u = 'https://daoohnbnnowmmcizgvrq.supabase.co';
const k = document.querySelector('meta[name="supabase-anon"]')?.content || 'REPLACED_BY_HEAD';
const s = createClient(u, k);

// redirect if not logged
const { data: { session } } = await s.auth.getSession();
if (!session) window.location.href = '/auth';

// fetch profile if table exists, else fallback to email
let name = session.user.email;
try {
  const { data } = await s.from('profiles').select('display_name').eq('id', session.user.id).single();
  if (data?.display_name) name = data.display_name;
} catch (_) {}
document.getElementById('me').textContent = `Hello, ${name}`;

document.getElementById('logout').onclick = async ()=>{
  await s.auth.signOut();
  window.location.href = '/';
};
</script>
