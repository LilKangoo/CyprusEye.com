<!DOCTYPE html>
<html lang="pl" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://esm.sh https://unpkg.com https://static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https: blob:; connect-src 'self' https://daoohnbnnowmmcizgvrq.supabase.co https://*.supabase.co wss://daoohnbnnowmmcizgvrq.supabase.co wss://*.supabase.co https://esm.sh https://unpkg.com; frame-src 'self' https://docs.google.com; object-src 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests;" />
  <meta name="theme-color" content="#2563eb" />
  <meta name="robots" content="index,follow" />
  <title data-i18n="seo.trips.title">Wycieczki â€“ CyprusEye</title>
  <meta name="description" content="PrzeglÄ…daj wycieczki i rezerwuj online.">
  <meta property="og:title" content="Wycieczki â€“ CyprusEye" />
  <meta property="og:description" content="PrzeglÄ…daj wycieczki i rezerwuj online." />
  <meta property="og:url" content="https://www.cypruseye.com/trips.html" />
  <meta property="og:image" content="https://www.cypruseye.com/assets/cyprus_logo-1000x1054.png" />
  <link rel="icon" href="/assets/cyprus_logo-1000x1054.png" type="image/png" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/assets/css/tokens.css" />
  <link rel="stylesheet" href="/assets/css/base.css" />
  <link rel="stylesheet" href="/assets/css/components.css" />
  <link rel="stylesheet" href="/assets/css/mobile.css" />
  <link rel="stylesheet" href="/assets/css/mobile-nav.css" />
  <link rel="stylesheet" href="/css/toast.css" />

  <meta name="ce-auth" content="on" />
  <script type="module" src="/js/supabaseClient.js"></script>
  <script type="module" src="/js/toast.js"></script>
  <script type="module" src="/js/auth.js"></script>
  <script type="module" src="/js/authUi.js"></script>
</head>
<body data-navigation="multi-page" data-initial-view="tripsView" data-seo-page="trips">
  <header class="app-header">
    <div class="header-top">
      <div class="brand">
        <img src="/assets/cyprus_logo-1000x1054.png" alt="WakacjeCypr.com â€“ logo" width="64" height="64" />
        <div class="brand-title">
          <p class="brand-name">WakacjeCypr <span>Quest</span></p>
          <p class="tagline">Zwiedzaj Cypr w interaktywny sposÃ³b â€“ zarezerwuj wycieczkÄ™!</p>
        </div>
      </div>
      <div class="header-top-actions">
        <div class="header-auth-controls">
          <div id="auth-actions" class="auth-actions-inline" aria-live="polite">
            <button class="btn btn-sm" data-auth="login">Zaloguj</button>
            <button class="btn btn-sm" data-auth="guest">GoÅ›Ä‡</button>
            <button class="btn btn-sm" data-auth="logout">Wyloguj</button>
            <button id="sosToggle" class="btn btn-sm btn-danger" type="button">ğŸš¨ SOS</button>
          </div>
        </div>
        <div class="header-actions" aria-label="Szybkie dziaÅ‚ania">
          <div class="header-actions-primary">
            <a class="ghost header-link" href="/community.html">ğŸ’¬ SpoÅ‚ecznoÅ›Ä‡</a>
            <a class="ghost header-link" href="/kupon.html">ğŸŸï¸ Kupon</a>
            <a class="ghost header-link" href="/car-rental-landing.html">ğŸš— Wynajem auta</a>
            <a class="ghost header-link" href="/trips.html" aria-label="Wycieczki">ğŸ§­ Wycieczki</a>
            <a class="ghost header-link" href="/vip.html">âœ¨ VIP wyjazdy</a>
          </div>
        </div>
      </div>
    </div>

    <nav class="header-tabs" role="tablist" aria-label="Nawigacja gÅ‚Ã³wna">
      <a href="/index.html" class="header-tab" id="headerAdventureTab">ğŸ¯ Twoja przygoda</a>
      <a href="/packing.html" class="header-tab" id="headerPackingTab">ğŸ’ Planer pakowania</a>
      <a href="/tasks.html" class="header-tab" id="headerTasksTab">âœ… Zadania</a>
      <a href="/trips.html" class="header-tab is-active" id="headerTripsTab">ğŸ§­ Wycieczki</a>
    </nav>
  </header>

  <main id="main-content">
    <h1 class="sr-only">Wycieczki</h1>
    <section id="tripsView" class="utility-view app-view" role="tabpanel" aria-labelledby="headerTripsTab">
      <header class="utility-view-header">
        <div>
          <h2>Wycieczki</h2>
          <p>PrzeglÄ…daj dostÄ™pne wycieczki i zÅ‚Ã³Å¼ rezerwacjÄ™ online.</p>
        </div>
      </header>

      <div style="margin-bottom:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
        <input id="q" placeholder="Szukaj po mieÅ›cie lub tytule" style="flex:1;min-width:240px;" />
        <select id="cityFilter" style="min-width:200px;display:none;"></select>
        <button id="btnSzukaj" class="btn-secondary">Szukaj</button>
      </div>
      <div id="lista" class="card-grid"></div>
    </section>
  </main>

  <footer class="app-footer">
    <p>Â© <span data-current-year></span> WakacjeCypr.com</p>
  </footer>

  <script type="module">
    const $ = (s,r=document)=>r.querySelector(s);
    const lista = $('#lista');
    const citySel = $('#cityFilter');
    let allTrips = [];
    let citiesReady = false;

    function renderList(){
      const q = ($('#q').value||'').toLowerCase();
      const selCity = (citySel.value||'').toLowerCase();
      const items = (allTrips||[]).filter(t=>{
        const title = (t.title?.pl || t.title?.en || '').toLowerCase();
        const city = (t.start_city||'').toLowerCase();
        const okQ = !q || title.includes(q) || city.includes(q);
        const okCity = !selCity || selCity==='__all__' || city===selCity;
        return okQ && okCity;
      });
      if(!items.length){
        lista.innerHTML = '<p>Brak wycieczek.</p>';
        return;
      }
      lista.innerHTML = items.map(t=>{
        const title = t.title?.pl || t.title?.en || t.slug;
        const badge = t.display_mode==='per_hour'?'za godzinÄ™': t.display_mode==='per_person'?'za osobÄ™': t.display_mode==='from_price'?'od ceny': (t.display_mode==='custom_label'? (t.display_label||''): '');
        const price = t.pricing_model==='per_person' && t.price_per_person ? `${Number(t.price_per_person).toFixed(2)} â‚¬` : (t.price_base? `${Number(t.price_base).toFixed(2)} â‚¬` : '');
        const sub = [t.start_city, badge].filter(Boolean).join(' â€¢ ');
        return `
          <a class="card" href="/trip.html?slug=${encodeURIComponent(t.slug)}">
            ${t.cover_image_url?`<img src="${t.cover_image_url}" alt="${title}" style="width:100%;height:180px;object-fit:cover;border-radius:8px;">`:''}
            <div class="card-body">
              <h3>${title}</h3>
              <p>${sub}</p>
              ${price?`<div class=\"price\">${price}</div>`:''}
            </div>
          </a>
        `;
      }).join('');
    }

    function initCities(){
      const cities = Array.from(new Set((allTrips||[]).map(t=>t.start_city).filter(Boolean)));
      if (cities.length <= 1){
        citySel.style.display = 'none';
        citiesReady = true;
        return;
      }
      const opts = ['<option value="__all__">Wszystkie miasta</option>']
        .concat(cities.map(c => `<option value="${c}">${c}</option>`));
      citySel.innerHTML = opts.join('');
      citySel.style.display = '';
      citiesReady = true;
    }

    async function loadTrips(){
      const res = await fetch('/trips');
      allTrips = await res.json();
      if (!citiesReady) initCities();
      renderList();
    }

    $('#btnSzukaj').addEventListener('click', renderList);
    citySel.addEventListener('change', renderList);
    loadTrips();
  </script>
  <script src="/js/seo.js" defer></script>
  <script src="/js/mobile-nav.js" defer></script>
</body>
</html>
