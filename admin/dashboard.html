<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Security: Content Security Policy - Admin Panel -->
  <!-- Note: Relaxed CSP for admin panel - protected by authentication -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://esm.sh https://*.esm.sh; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https: blob:; connect-src 'self' https://daoohnbnnowmmcizgvrq.supabase.co https://*.supabase.co https://esm.sh; object-src 'none'; base-uri 'self'; form-action 'self';">
  <!-- Admin panel is already protected by multi-layer authentication -->
  
  <meta name="theme-color" content="#dc2626" />
  <meta name="robots" content="noindex,nofollow" />
  <title>CyprusEye Admin Panel</title>
  <meta name="description" content="Admin panel for CyprusEye Quest management" />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <!-- Favicon -->
  <link rel="icon" href="/assets/cyprus_logo-1000x1054.png" type="image/png" />
  
  <!-- Styles -->
  <link rel="stylesheet" href="/assets/css/tokens.css?v=20251107" />
  <link rel="stylesheet" href="/assets/css/base.css?v=20251107" />
  <link rel="stylesheet" href="/admin/admin.css?v=20251107" />
  
  <!-- Auth meta -->
  <meta name="ce-auth" content="required" />
  <meta name="ce-admin" content="required" />
  
  <!-- Scripts -->
  <script type="module" src="/js/supabaseClient.js?v=20251107"></script>
  <script type="module" src="/js/toast.js?v=20251107"></script>
  <script src="/admin/universal-i18n-component.js?v=20250111"></script>
  <script src="/admin/poi-i18n-form.js?v=20250111"></script>
  <script src="/admin/recommendation-i18n-form.js?v=20251118"></script>
  <script type="module" src="/admin/admin.js?v=20251110"></script>
</head>
<body data-admin-panel="true">
  
  <!-- Admin Header -->
  <header class="admin-header">
    <div class="admin-header-content">
      <div class="admin-header-left">
        <button
          type="button"
          class="admin-menu-toggle"
          id="adminMenuToggle"
          aria-label="Toggle navigation menu"
          aria-controls="adminSidebar"
          aria-expanded="false"
        >
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6" />
            <line x1="3" y1="12" x2="21" y2="12" />
            <line x1="3" y1="18" x2="21" y2="18" />
          </svg>
        </button>
        
        <h1 class="admin-title">
          <svg class="admin-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
          CyprusEye Admin
        </h1>
        <div class="admin-breadcrumb" id="breadcrumb">
          <span>Dashboard</span>
        </div>
      </div>
      <div class="admin-header-right">
        <div class="admin-user-info" id="adminUserInfo">
          <span class="admin-user-name" id="adminUserName">Loading...</span>
          <span class="admin-user-role">Super Admin</span>
        </div>
        <button class="btn-admin-logout" id="btnAdminLogout" title="Logout">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <div class="admin-sidebar-overlay" id="adminSidebarOverlay" hidden></div>

  <!-- Access Denied Screen -->
  <div class="admin-access-denied" id="adminAccessDenied" hidden>
    <div class="access-denied-content">
      <svg class="access-denied-icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="15" y1="9" x2="9" y2="15"/>
        <line x1="9" y1="9" x2="15" y2="15"/>
      </svg>
      <h2>Access Denied</h2>
      <p>You don't have permission to access this panel.</p>
      <p style="margin-top: 16px; color: var(--admin-text-muted); font-size: 14px;">
        Only <strong>lilkangoomedia@gmail.com</strong> has admin access.
      </p>
      <div style="display: flex; gap: 12px; margin-top: 24px; justify-content: center;">
        <button class="btn-secondary" onclick="window.location.reload()">Try Again</button>
        <a href="/" class="btn-primary">Go to Home</a>
      </div>
    </div>
  </div>

  <!-- Main Admin Panel -->
  <div class="admin-container" id="adminContainer">
    
    <!-- Sidebar Navigation -->
    <aside class="admin-sidebar" id="adminSidebar">
      <nav class="admin-nav">
        <button class="admin-nav-item active" data-view="dashboard">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
          </svg>
          <span>Dashboard</span>
        </button>
        
        <button class="admin-nav-item" data-view="users">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="9" cy="7" r="4"/>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
          <span>Users</span>
        </button>
        
        <button class="admin-nav-item" data-view="referrals">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
          </svg>
          <span>Referrals</span>
        </button>
        
        <button class="admin-nav-item" data-view="pois">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
          <span>POIs</span>
        </button>
        
        <button class="admin-nav-item" data-view="quests">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 19l-3.5 2 1-4-3-3 4-.5L12 9l1.5 4.5 4 .5-3 3 1 4z"/>
          </svg>
          <span>Quests</span>
        </button>
        
        <button class="admin-nav-item" data-view="cars">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 17h14v2H5v-2zM3 11l2.5-5h13L21 11M3 11v6h18v-6M3 11h18"/>
            <circle cx="7.5" cy="15.5" r="1.5"/>
            <circle cx="16.5" cy="15.5" r="1.5"/>
          </svg>
          <span>Cars</span>
        </button>
        
        <button class="admin-nav-item" data-view="trips">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 11l9-9 9 9v9a2 2 0 0 1-2 2h-5v-7H10v7H5a2 2 0 0 1-2-2v-9z"/>
          </svg>
          <span>Trips</span>
        </button>
        
        <button class="admin-nav-item" data-view="hotels">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 21V8a2 2 0 0 1 2-2h3V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2h3a2 2 0 0 1 2 2v13"/>
            <path d="M6 21v-6a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v6"/>
          </svg>
          <span>Hotels</span>
        </button>
        
        <button class="admin-nav-item" data-view="recommendations">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          </svg>
          <span>Recommendations</span>
        </button>
        
        <button class="admin-nav-item" data-view="content">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <polyline points="10 9 9 9 8 9"/>
          </svg>
          <span>Content</span>
        </button>

        <button class="admin-nav-item" data-view="moderation">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 8v4l3 3"/>
          </svg>
          <span>Moderation</span>
        </button>
        
        <button class="admin-nav-item" data-view="analytics">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 3v18h18"/>
            <rect x="7" y="12" width="3" height="6"/>
            <rect x="12" y="9" width="3" height="9"/>
            <rect x="17" y="6" width="3" height="12"/>
          </svg>
          <span>Analytics</span>
        </button>
        
        <button class="admin-nav-item" data-view="diagnostics">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
          </svg>
          <span>Diagnostics</span>
        </button>
        
        <button class="admin-nav-item" data-view="xp-control">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
          </svg>
          <span>XP Control</span>
        </button>
        
        <button class="admin-nav-item" data-view="shop">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"/>
            <circle cx="20" cy="21" r="1"/>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
          </svg>
          <span>Shop</span>
        </button>
        
        <button class="admin-nav-item" data-view="settings">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 1v6m0 6v6m0-18a11 11 0 0 1 0 22 11 11 0 0 1 0-22z"/>
            <path d="M19.07 4.93l-4.24 4.24m0 5.66l4.24 4.24M4.93 4.93l4.24 4.24m5.66 0l4.24-4.24"/>
          </svg>
          <span>Settings</span>
        </button>
      </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="admin-main">
      
      <!-- Dashboard View -->
      <section class="admin-view active" id="viewDashboard">
        <header class="admin-view-header">
          <h2>Dashboard</h2>
          <p class="admin-view-subtitle">System overview and statistics</p>
        </header>

        <!-- Stats Cards -->
        <div class="admin-stats-grid">
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-blue">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Users</p>
              <p class="stat-card-value" id="statTotalUsers">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-green">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                <circle cx="12" cy="10" r="3"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total POIs</p>
              <p class="stat-card-value" id="statTotalPois">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-purple">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Comments</p>
              <p class="stat-card-value" id="statTotalComments">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-orange">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Active Users (7d)</p>
              <p class="stat-card-value" id="statActiveUsers7d">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="admin-section">
          <h3>Recent Activity</h3>
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Type</th>
                  <th>User</th>
                  <th>Details</th>
                  <th>Time</th>
                </tr>
              </thead>
              <tbody id="recentActivityTable">
                <tr>
                  <td colspan="4" class="table-loading">Loading...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="admin-section" style="margin-top: 32px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <div>
              <h3>Force Refresh</h3>
              <p class="admin-view-subtitle" style="margin: 6px 0 0;">Trigger a silent reload for users (on next check)</p>
            </div>
            <button class="btn-secondary" id="btnForceRefreshSite" type="button">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
                <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
              </svg>
              Force Refresh Now
            </button>
          </div>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 16px;">
            <div style="background: var(--admin-card-bg); border: 1px solid var(--admin-border); border-radius: 12px; padding: 16px;">
              <div style="font-size: 13px; color: var(--admin-text-muted); margin-bottom: 8px;">Current version</div>
              <div style="font-size: 22px; font-weight: 700;" id="forceRefreshVersion">-</div>
            </div>
            <div style="background: var(--admin-card-bg); border: 1px solid var(--admin-border); border-radius: 12px; padding: 16px;">
              <div style="font-size: 13px; color: var(--admin-text-muted); margin-bottom: 8px;">Last updated</div>
              <div style="font-size: 14px; font-weight: 600;" id="forceRefreshUpdatedAt">-</div>
            </div>
          </div>
        </div>

        <!-- All Orders Management Panel -->
        <div class="admin-section" style="margin-top: 32px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h3>All Orders</h3>
            <div style="display: flex; gap: 8px;">
              <button class="btn-secondary" id="btnRefreshAllOrders" type="button">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
                  <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"/>
                </svg>
                Refresh
              </button>
              <select id="orderCategoryFilter" style="padding: 8px 12px; border-radius: 8px; border: 1px solid var(--admin-border); background: var(--admin-card-bg); color: var(--admin-text); font-size: 14px;">
                <option value="all">All Categories</option>
                <option value="cars">Cars Only</option>
                <option value="trips">Trips Only</option>
                <option value="hotels">Hotels Only</option>
              </select>
              <select id="orderStatusFilter" style="padding: 8px 12px; border-radius: 8px; border: 1px solid var(--admin-border); background: var(--admin-card-bg); color: var(--admin-text); font-size: 14px;">
                <option value="all">All Statuses</option>
                <option value="pending">Pending</option>
                <option value="confirmed">Confirmed</option>
                <option value="completed">Completed</option>
                <option value="cancelled">Cancelled</option>
              </select>
            </div>
          </div>

          <!-- Orders Stats Mini Cards -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 24px;">
            <div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); padding: 20px; border-radius: 12px; color: white;">
              <div style="font-size: 13px; opacity: 0.9; margin-bottom: 8px;">Cars Pending</div>
              <div style="font-size: 28px; font-weight: 700;" id="statCarsPending">-</div>
            </div>
            <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 20px; border-radius: 12px; color: white;">
              <div style="font-size: 13px; opacity: 0.9; margin-bottom: 8px;">Trips Pending</div>
              <div style="font-size: 28px; font-weight: 700;" id="statTripsPending">-</div>
            </div>
            <div style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); padding: 20px; border-radius: 12px; color: white;">
              <div style="font-size: 13px; opacity: 0.9; margin-bottom: 8px;">Hotels Pending</div>
              <div style="font-size: 28px; font-weight: 700;" id="statHotelsPending">-</div>
            </div>
            <div style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 20px; border-radius: 12px; color: white;">
              <div style="font-size: 13px; opacity: 0.9; margin-bottom: 8px;">Total Orders</div>
              <div style="font-size: 28px; font-weight: 700;" id="statTotalOrders">-</div>
            </div>
          </div>

          <!-- Orders Table -->
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th style="width: 100px;">Category</th>
                  <th style="width: 140px;">Order ID</th>
                  <th>Customer</th>
                  <th>Details</th>
                  <th style="width: 110px;">Status</th>
                  <th style="width: 100px;">Amount</th>
                  <th style="width: 120px;">Created</th>
                  <th style="width: 100px;">Actions</th>
                </tr>
              </thead>
              <tbody id="allOrdersTableBody">
                <tr>
                  <td colspan="8" class="table-loading">Loading all orders...</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="allOrdersFooter" style="margin-top: 16px; text-align: center; color: var(--admin-text-muted); font-size: 13px;">
            <!-- Pagination or info will be displayed here -->
          </div>
        </div>
      </section>

      <!-- Hotels View -->
      <section class="admin-view" id="viewHotels" hidden>
        <header class="admin-view-header">
          <div>
            <h2>Hotels</h2>
            <p class="admin-view-subtitle">Manage hotels and accommodation bookings</p>
          </div>
          <div class="admin-view-actions">
            <button class="btn-secondary" type="button" id="btnRefreshHotels">Refresh</button>
            <button class="btn-primary" type="button" id="btnAddHotel" onclick="openNewHotelModal()">New Hotel</button>
          </div>
        </header>

        <!-- Sub-navigation for Hotels -->
        <div style="margin-bottom: 24px; border-bottom: 2px solid var(--admin-border); display: flex; gap: 8px;">
          <button class="hotels-tab-button active" data-tab="hotels" style="padding: 12px 24px; background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; font-weight: 500; color: var(--admin-text-muted); transition: all 0.2s;">
            Hotels
          </button>
          <button class="hotels-tab-button" data-tab="bookings" style="padding: 12px 24px; background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; font-weight: 500; color: var(--admin-text-muted); transition: all 0.2s;">
            Bookings
          </button>
        </div>

        <!-- Hotels Tab Content -->
        <div id="hotelsTabHotels" class="hotels-tab-content">
          <div class="admin-stats-grid">
            <div class="admin-stat-card">
              <div class="stat-card-content">
                <p class="stat-card-label">Total Hotels</p>
                <p class="stat-card-value" id="hotelsStatTotal">0</p>
                <p class="stat-card-change" id="hotelsStatSubtitle">Loading...</p>
              </div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-card-content">
                <p class="stat-card-label">Published</p>
                <p class="stat-card-value" id="hotelsStatPublished">0</p>
                <p class="stat-card-change">Visible to customers</p>
              </div>
            </div>
          </div>

          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Hotel</th>
                  <th>Order</th>
                  <th>Slug</th>
                  <th>City</th>
                  <th>Price</th>
                  <th>Published</th>
                  <th>Updated</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="hotelsTableBody">
                <tr>
                  <td colspan="8" class="table-loading">Loading hotels...</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="hotelsTableFooter" class="poi-table-footer"></div>
        </div>

        <!-- Bookings Tab Content -->
        <div id="hotelsTabBookings" class="hotels-tab-content" hidden>
          <!-- Hotel Bookings Stats -->
          <div class="admin-stats-grid">
            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-blue">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                  <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Total Bookings</p>
                <p class="stat-card-value" id="statHotelBookingsTotal">-</p>
                <p class="stat-card-change">Loading...</p>
              </div>
            </div>

            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-orange">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Pending</p>
                <p class="stat-card-value" id="statHotelBookingsPending">-</p>
                <p class="stat-card-change">Awaiting confirmation</p>
              </div>
            </div>

            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-green">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Confirmed</p>
                <p class="stat-card-value" id="statHotelBookingsConfirmed">-</p>
                <p class="stat-card-change">Active bookings</p>
              </div>
            </div>

            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-purple">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="1" x2="12" y2="23"/>
                  <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Revenue (Total)</p>
                <p class="stat-card-value" id="statHotelBookingsRevenue">-</p>
                <p class="stat-card-change">Paid bookings</p>
              </div>
            </div>
          </div>

          <!-- Hotel Bookings Table -->
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Booking ID</th>
                  <th>Customer</th>
                  <th>Dates & Details</th>
                  <th>Status</th>
                  <th>Amount</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="hotelBookingsTableBody">
                <tr>
                  <td colspan="6" class="table-loading">Loading hotel bookings...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Hotel Booking Details Modal -->
      <div class="admin-modal" id="hotelBookingDetailsModal" hidden>
        <div class="admin-modal-dialog" style="max-width: 700px;">
          <header class="admin-modal-header">
            <h3>Hotel Booking Details</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('hotelBookingDetailsModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content" id="hotelBookingDetailsContent">
            <div class="table-loading">Loading...</div>
          </div>
        </div>
      </div>

      <!-- Edit Hotel Modal -->
      <div class="admin-modal" id="editHotelModal" hidden>
        <div class="admin-modal-dialog" style="max-width: 800px;">
          <header class="admin-modal-header">
            <h3>Edit Hotel</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('editHotelModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content">
            <form id="editHotelForm" novalidate>
              <input type="hidden" id="editHotelId" />
              <div class="admin-form-grid">
                <label class="admin-form-field">
                  <span>Slug (read-only)</span>
                  <input type="text" id="editHotelSlug" readonly style="background:#2a2f3a;cursor:not-allowed;" />
                </label>
                <div class="admin-form-field">
                  <span>City</span>
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <select name="city" id="editHotelCity" required style="flex: 1;"></select>
                    <button type="button" class="btn-add-city" onclick="openAddCityModal()" title="Add new city">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <!-- Hotel Title (i18n) -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <label>Title (Multilingual)</label>
                  <div id="editHotelTitleI18n"></div>
                </div>
                <!-- Cover Image Manager -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <span style="font-weight:600;margin-bottom:8px;display:block;">üñºÔ∏è Cover Image (Zdjƒôcie g≈Ç√≥wne)</span>
                  <div class="cover-image-manager">
                    <div class="cover-preview-wrap">
                      <img id="editHotelCoverPreviewImg" src="" alt="Cover preview">
                      <div class="cover-actions">
                        <label class="btn-secondary btn-sm" style="cursor:pointer;">
                          üì§ Upload
                          <input type="file" id="editHotelCoverFile" accept="image/*" hidden>
                        </label>
                        <button type="button" class="btn-secondary btn-sm btn-danger" onclick="removeCoverImage('edit')">üóëÔ∏è Remove</button>
                      </div>
                    </div>
                    <div class="cover-url-fallback">
                      <label>Or paste URL:</label>
                      <input type="text" id="editHotelCoverUrl" name="cover_image_url" placeholder="https://...">
                    </div>
                  </div>
                </div>
                <!-- Gallery Photos Manager -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <div class="photos-header">
                    <span>üì∑ Gallery Photos (<span id="editHotelPhotosCount">0</span>/10)</span>
                    <label class="btn-secondary btn-sm" style="cursor:pointer;">
                      ‚ûï Add Photos
                      <input type="file" id="editHotelPhotosAdd" accept="image/*" multiple hidden>
                    </label>
                  </div>
                  <div class="photos-manager-grid" id="editHotelPhotosManager"></div>
                </div>
                <!-- Hotel Description (i18n) -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <label>Description (Multilingual)</label>
                  <div id="editHotelDescriptionI18n"></div>
                </div>
                <label class="admin-form-field">
                  <span>Pricing Model</span>
                  <select name="pricing_model" id="editHotelPricing">
                    <option value="per_person_per_night">Per person per night (standard)</option>
                    <option value="tiered_by_nights">Tiered by nights (rabaty za d≈Çu≈ºszy pobyt)</option>
                    <option value="flat_per_night">Flat per night (apartament/willa)</option>
                  </select>
                </label>
                <label class="admin-form-field">
                  <span>Max persons (limit)</span>
                  <input type="number" min="1" id="editHotelMaxPersons" placeholder="np. 6" />
                </label>
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <span>Pricing Tiers (per night)</span>
                  <div>
                    <table class="admin-table">
                      <thead>
                        <tr>
                          <th>Persons</th>
                          <th>Price / night (‚Ç¨)</th>
                          <th>Min nights (optional)</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody id="editHotelPricingTiersBody">
                        <tr><td colspan="4" class="table-loading">No tiers yet</td></tr>
                      </tbody>
                    </table>
                    <button type="button" class="btn-secondary" id="btnAddEditHotelTier" style="margin-top:8px;">Add tier</button>
                  </div>
                </div>
                <!-- Amenities Section -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <span style="font-weight: 600;">Amenities / Udogodnienia</span>
                    <button type="button" class="btn-secondary" onclick="openAddAmenityModal()" style="padding: 4px 12px; font-size: 12px;">+ Add New</button>
                  </div>
                  <div class="amenities-grid" id="editHotelAmenities">
                    <div class="table-loading">Loading amenities...</div>
                  </div>
                </div>
                <label class="admin-form-field" style="grid-column:1/-1;">
                  <span style="display:flex;align-items:center;gap:8px;">
                    <input type="checkbox" name="is_published" id="editHotelPublished" style="width:auto;" />
                    Published (visible to customers)
                  </span>
                </label>
              </div>
              <div class="admin-modal-actions">
                <button type="button" class="btn-secondary" onclick="document.getElementById('editHotelModal').hidden=true">Cancel</button>
                <button type="submit" class="btn-primary">Save Changes</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- New Hotel Modal -->
      <div class="admin-modal" id="newHotelModal" hidden>
        <div class="admin-modal-dialog">
          <header class="admin-modal-header">
            <h3>Create New Hotel</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('newHotelModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content">
            <form id="newHotelForm" novalidate>
              <div class="admin-form-grid">
                <div class="admin-form-field">
                  <span>City</span>
                  <div style="display: flex; gap: 8px; align-items: center;">
                    <select name="city" id="newHotelCity" required style="flex: 1;"></select>
                    <button type="button" class="btn-add-city" onclick="openAddCityModal()" title="Add new city">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                      </svg>
                    </button>
                  </div>
                </div>
                <!-- Hotel Title (i18n) -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <label>Title (Multilingual)</label>
                  <div id="newHotelTitleI18n"></div>
                </div>
                <!-- Cover Image Manager -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <span style="font-weight:600;margin-bottom:8px;display:block;">üñºÔ∏è Cover Image (Zdjƒôcie g≈Ç√≥wne)</span>
                  <div class="cover-image-manager">
                    <div class="cover-preview-wrap">
                      <img id="newHotelCoverPreviewImg" src="" alt="Cover preview">
                      <div class="cover-actions">
                        <label class="btn-secondary btn-sm" style="cursor:pointer;">
                          üì§ Upload
                          <input type="file" id="newHotelCoverFile" accept="image/*" hidden>
                        </label>
                        <button type="button" class="btn-secondary btn-sm btn-danger" onclick="removeCoverImage('new')">üóëÔ∏è Remove</button>
                      </div>
                    </div>
                    <div class="cover-url-fallback">
                      <label>Or paste URL:</label>
                      <input type="text" id="newHotelCoverUrl" name="cover_image_url" placeholder="https://...">
                    </div>
                  </div>
                </div>
                <!-- Gallery Photos Manager -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <div class="photos-header">
                    <span>üì∑ Gallery Photos (<span id="newHotelPhotosCount">0</span>/10)</span>
                    <label class="btn-secondary btn-sm" style="cursor:pointer;">
                      ‚ûï Add Photos
                      <input type="file" id="newHotelPhotosAdd" accept="image/*" multiple hidden>
                    </label>
                  </div>
                  <div class="photos-manager-grid" id="newHotelPhotosManager"></div>
                </div>
                <!-- Hotel Description (i18n) -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <label>Description (Multilingual)</label>
                  <div id="newHotelDescriptionI18n"></div>
                </div>
                <label class="admin-form-field">
                  <span>Pricing Model</span>
                  <select name="pricing_model" id="newHotelPricing">
                    <option value="per_person_per_night">Per person per night (standard)</option>
                    <option value="tiered_by_nights">Tiered by nights (rabaty za d≈Çu≈ºszy pobyt)</option>
                    <option value="flat_per_night">Flat per night (apartament/willa)</option>
                  </select>
                </label>
                <label class="admin-form-field">
                  <span>Max persons (limit)</span>
                  <input type="number" min="1" id="newHotelMaxPersons" placeholder="np. 6" />
                </label>
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <span>Pricing Tiers (per night)</span>
                  <div>
                    <table class="admin-table">
                      <thead>
                        <tr>
                          <th>Persons</th>
                          <th>Price / night (‚Ç¨)</th>
                          <th>Min nights (optional)</th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody id="newHotelPricingTiersBody">
                        <tr><td colspan="4" class="table-loading">No tiers yet</td></tr>
                      </tbody>
                    </table>
                    <button type="button" class="btn-secondary" id="btnAddNewHotelTier" style="margin-top:8px;">Add tier</button>
                  </div>
                </div>
                <!-- Amenities Section -->
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <span style="font-weight: 600;">Amenities / Udogodnienia</span>
                    <button type="button" class="btn-secondary" onclick="openAddAmenityModal()" style="padding: 4px 12px; font-size: 12px;">+ Add New</button>
                  </div>
                  <div class="amenities-grid" id="newHotelAmenities">
                    <div class="table-loading">Loading amenities...</div>
                  </div>
                </div>
              </div>
              <div class="admin-modal-actions">
                <button type="submit" class="btn-primary">Create</button>
                <button type="button" class="btn-secondary" onclick="document.getElementById('newHotelModal').hidden=true">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Add Amenity Modal -->
      <div class="admin-modal" id="addAmenityModal" hidden>
        <div class="admin-modal-dialog" style="max-width: 450px;">
          <header class="admin-modal-header">
            <h3>Add New Amenity</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('addAmenityModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content">
            <form id="addAmenityForm" novalidate>
              <div class="admin-form-grid" style="gap: 16px;">
                <label class="admin-form-field">
                  <span>Code (unique) *</span>
                  <input type="text" id="newAmenityCode" required placeholder="e.g. heated_pool" pattern="[a-z_]+" title="Only lowercase letters and underscores">
                </label>
                <label class="admin-form-field">
                  <span>Category *</span>
                  <select id="newAmenityCategory" required>
                    <option value="general">General</option>
                    <option value="wellness">Wellness & Spa</option>
                    <option value="food">Food & Drink</option>
                    <option value="room">Room Features</option>
                    <option value="outdoor">Outdoor</option>
                    <option value="services">Services</option>
                  </select>
                </label>
                <label class="admin-form-field">
                  <span>Icon (emoji) *</span>
                  <input type="text" id="newAmenityIcon" required placeholder="e.g. üèä" maxlength="4">
                </label>
                <label class="admin-form-field">
                  <span>Name (English) *</span>
                  <input type="text" id="newAmenityNameEn" required placeholder="e.g. Heated pool">
                </label>
                <label class="admin-form-field">
                  <span>Name (Polish) *</span>
                  <input type="text" id="newAmenityNamePl" required placeholder="e.g. Podgrzewany basen">
                </label>
                <label class="admin-form-field" style="grid-column: 1/-1;">
                  <span style="display:flex;align-items:center;gap:8px;">
                    <input type="checkbox" id="newAmenityPopular" style="width:auto;">
                    Mark as popular (shown first)
                  </span>
                </label>
              </div>
              <div class="admin-modal-actions" style="margin-top: 20px;">
                <button type="submit" class="btn-primary">Add Amenity</button>
                <button type="button" class="btn-secondary" onclick="document.getElementById('addAmenityModal').hidden=true">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Add City Modal -->
      <div class="admin-modal" id="addCityModal" hidden>
        <div class="admin-modal-dialog" style="max-width: 400px;">
          <header class="admin-modal-header">
            <h3>Add New City</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('addCityModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content">
            <form id="addCityForm" novalidate>
              <div class="admin-form-grid" style="gap: 16px;">
                <label class="admin-form-field">
                  <span>City Name (English) *</span>
                  <input type="text" id="newCityName" required placeholder="e.g. Kyrenia">
                </label>
                <label class="admin-form-field">
                  <span>City Name (Polish)</span>
                  <input type="text" id="newCityNamePl" placeholder="e.g. Kyrenia">
                </label>
              </div>
              <div class="admin-modal-actions" style="margin-top: 20px;">
                <button type="submit" class="btn-primary">Add City</button>
                <button type="button" class="btn-secondary" onclick="document.getElementById('addCityModal').hidden=true">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Trips View -->
      <section class="admin-view" id="viewTrips" hidden>
        <header class="admin-view-header">
          <div>
            <h2>Trips</h2>
            <p class="admin-view-subtitle">Manage trips and customer bookings</p>
          </div>
          <div class="admin-view-actions">
            <button class="btn-secondary" type="button" id="btnRefreshTrips">Refresh</button>
            <button class="btn-primary" type="button" id="btnAddTrip" onclick="openNewTripModal()">New Trip</button>
          </div>
        </header>

        <!-- Sub-navigation for Trips -->
        <div style="margin-bottom: 24px; border-bottom: 2px solid var(--admin-border); display: flex; gap: 8px;">
          <button class="trips-tab-button active" data-tab="trips" style="padding: 12px 24px; background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; font-weight: 500; color: var(--admin-text-muted); transition: all 0.2s;">
            Trips
          </button>
          <button class="trips-tab-button" data-tab="bookings" style="padding: 12px 24px; background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; font-weight: 500; color: var(--admin-text-muted); transition: all 0.2s;">
            Bookings
          </button>
        </div>

        <!-- Trips Tab Content -->
        <div id="tripsTabTrips" class="trips-tab-content">
        <div class="admin-stats-grid">
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Total Trips</p>
              <p class="stat-card-value" id="tripsStatTotal">0</p>
              <p class="stat-card-change" id="tripsStatSubtitle">Loading...</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Published</p>
              <p class="stat-card-value" id="tripsStatPublished">0</p>
              <p class="stat-card-change">Visible to customers</p>
            </div>
          </div>
        </div>

        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Trip</th>
                <th>Order</th>
                <th>Slug</th>
                <th>City</th>
                <th>Published</th>
                <th>Updated</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="tripsTableBody">
              <tr>
                <td colspan="7" class="table-loading">Loading trips...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div id="tripsTableFooter" class="poi-table-footer"></div>
        </div>

        <!-- Bookings Tab Content -->
        <div id="tripsTabBookings" class="trips-tab-content" hidden>
          <!-- Trip Bookings Stats -->
          <div class="admin-stats-grid">
            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-blue">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                  <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Total Bookings</p>
                <p class="stat-card-value" id="statTripBookingsTotal">-</p>
                <p class="stat-card-change">Loading...</p>
              </div>
            </div>

            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-orange">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Pending</p>
                <p class="stat-card-value" id="statTripBookingsPending">-</p>
                <p class="stat-card-change">Awaiting confirmation</p>
              </div>
            </div>

            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-green">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Confirmed</p>
                <p class="stat-card-value" id="statTripBookingsConfirmed">-</p>
                <p class="stat-card-change">Active bookings</p>
              </div>
            </div>

            <div class="admin-stat-card">
              <div class="stat-card-icon stat-card-icon-purple">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="1" x2="12" y2="23"/>
                  <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                </svg>
              </div>
              <div class="stat-card-content">
                <p class="stat-card-label">Revenue (Total)</p>
                <p class="stat-card-value" id="statTripBookingsRevenue">-</p>
                <p class="stat-card-change">Paid bookings</p>
              </div>
            </div>
          </div>

          <!-- Trip Bookings Table -->
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Booking ID</th>
                  <th>Customer</th>
                  <th>Dates & Details</th>
                  <th>Status</th>
                  <th>Amount</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="tripBookingsTableBody">
                <tr>
                  <td colspan="6" class="table-loading">Loading trip bookings...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Trip Booking Details Modal -->
      <div class="admin-modal" id="tripBookingDetailsModal" hidden>
        <div class="admin-modal-dialog" style="max-width: 700px;">
          <header class="admin-modal-header">
            <h3>Trip Booking Details</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('tripBookingDetailsModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content" id="tripBookingDetailsContent">
            <div class="table-loading">Loading...</div>
          </div>
        </div>
      </div>

      <!-- Edit Trip Modal -->
      <div class="admin-modal" id="editTripModal" hidden>
        <div class="admin-modal-dialog" style="max-width: 800px;">
          <header class="admin-modal-header">
            <h3>Edit Trip</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('editTripModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content">
            <form id="editTripForm" novalidate>
              <input type="hidden" id="editTripId" />
              <div class="admin-form-grid">
                <label class="admin-form-field">
                  <span>Slug (read-only)</span>
                  <input type="text" id="editTripSlug" readonly style="background:#2a2f3a;cursor:not-allowed;" />
                </label>
                <label class="admin-form-field">
                  <span>City</span>
                  <select name="start_city" id="editTripCity" required>
                    <option value="Larnaca">Larnaca</option>
                    <option value="Paphos">Paphos</option>
                    <option value="Limassol">Limassol</option>
                    <option value="Ayia Napa">Ayia Napa</option>
                    <option value="Nicosia">Nicosia</option>
                    <option value="All Cities">All Cities</option>
                  </select>
                </label>
                <!-- I18N Fields (hidden by default) -->
                <div id="tripI18nFields" style="display: none; grid-column:1/-1;">
                  <div id="tripTitleI18n"></div>
                  <div id="tripDescriptionI18n"></div>
                </div>

                <!-- Legacy Fields (visible by default) -->
                <div id="tripLegacyFields" style="display: contents;">
                  <label class="admin-form-field" style="grid-column:1/-1;">
                    <span>Title (PL)</span>
                    <input type="text" name="title_pl" id="editTripTitlePl" required />
                  </label>
                  <label class="admin-form-field" style="grid-column:1/-1;">
                    <span>Description (PL)</span>
                    <textarea name="description_pl" id="editTripDescPl" rows="4"></textarea>
                  </label>
                </div>

                <div class="admin-form-field" style="grid-column:1/-1;">
                  <span>Cover Image</span>
                  <div class="image-upload-section">
                    <div class="image-upload-row">
                      <input type="url" name="cover_image_url" id="editTripCoverUrl" placeholder="https://... or upload an image" />
                      <input type="file" id="editTripCoverFile" accept="image/*" style="display:none;" onchange="handleTripCoverUpload(this)" />
                      <button type="button" class="btn-upload-image" onclick="document.getElementById('editTripCoverFile').click()">
                        üì§ Upload
                      </button>
                    </div>
                    <div id="editTripCoverPreview" class="image-preview-container" style="display:none;">
                      <img alt="Cover preview" />
                      <button type="button" class="btn-remove-image" onclick="removeTripCoverImage()">‚úï Remove</button>
                    </div>
                    <small style="color: var(--admin-text-muted);">Upload an image or paste a URL. Recommended size: 1200x600px</small>
                  </div>
                </div>
                <label class="admin-form-field">
                  <span>Pricing Model</span>
                  <select name="pricing_model" id="editTripPricing">
                    <option value="per_person">per_person</option>
                    <option value="base_plus_extra">base_plus_extra</option>
                    <option value="per_hour">per_hour</option>
                    <option value="per_day">per_day</option>
                  </select>
                </label>
                <div id="editTripPriceFields" class="admin-form-inline"></div>
                <label class="admin-form-field" style="grid-column:1/-1;">
                  <span style="display:flex;align-items:center;gap:8px;">
                    <input type="checkbox" name="is_published" id="editTripPublished" style="width:auto;" />
                    Published (visible to customers)
                  </span>
                </label>
              </div>
              <div class="admin-modal-actions">
                <button type="button" class="btn-secondary" onclick="document.getElementById('editTripModal').hidden=true">Cancel</button>
                <button type="submit" class="btn-primary">Save Changes</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- New Trip Modal -->
      <div class="admin-modal" id="newTripModal" hidden>
        <div class="admin-modal-dialog">
          <header class="admin-modal-header">
            <h3>Create New Trip</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('newTripModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content">
            <form id="newTripForm" novalidate>
              <div class="admin-form-grid">
                <label class="admin-form-field">
                  <span>City</span>
                  <select name="start_city" id="newTripCity" required>
                    <option value="Larnaca">Larnaca</option>
                    <option value="Paphos">Paphos</option>
                    <option value="Limassol">Limassol</option>
                    <option value="Ayia Napa">Ayia Napa</option>
                    <option value="Nicosia">Nicosia</option>
                    <option value="All Cities">All Cities</option>
                  </select>
                </label>
                <!-- I18N Fields -->
                <div id="newTripI18nFields" style="grid-column:1/-1;">
                  <div id="newTripTitleI18n"></div>
                  <div id="newTripDescriptionI18n"></div>
                </div>
                
                <div class="admin-form-field" style="grid-column:1/-1;">
                  <span>Cover Image (upload) lub URL (opcjonalnie)</span>
                  <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
                    <input type="file" id="newTripCoverFile" accept="image/*" />
                    <input type="url" name="cover_image_url" id="newTripCoverUrl" placeholder="https://..." style="flex:1;min-width:240px;" />
                  </div>
                  <div id="newTripCoverPreview" style="margin-top:8px;display:none;">
                    <img alt="PodglƒÖd ok≈Çadki" style="width:100%;max-height:160px;object-fit:cover;border-radius:8px;" />
                  </div>
                </div>
                <label class="admin-form-field">
                  <span>Pricing Model</span>
                  <select name="pricing_model" id="newTripPricing">
                    <option value="per_person">per_person</option>
                    <option value="base_plus_extra">base_plus_extra</option>
                    <option value="per_hour">per_hour</option>
                    <option value="per_day">per_day</option>
                  </select>
                </label>
                <div id="newTripPriceFields" class="admin-form-inline"></div>
              </div>
              <div class="admin-modal-actions">
                <button type="submit" class="btn-primary">Create</button>
                <button type="button" class="btn-secondary" onclick="document.getElementById('newTripModal').hidden=true">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Trip Details Modal -->
      <div class="admin-modal" id="tripDetailsModal" hidden>
        <div class="admin-modal-dialog">
          <header class="admin-modal-header">
            <h3>Trip details</h3>
            <button type="button" class="admin-modal-close" onclick="document.getElementById('tripDetailsModal').hidden=true">‚úï</button>
          </header>
          <div class="admin-modal-content" id="tripDetailsContent">
            <p class="table-loading">Loading...</p>
          </div>
        </div>
      </div>

      <!-- Moderation View -->
      <section class="admin-view" id="viewModeration" hidden>
        <header class="admin-view-header">
          <h2>Moderation</h2>
          <p class="admin-view-subtitle">Review and resolve reported content</p>
        </header>

        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Type</th>
                <th>User</th>
                <th>POI</th>
                <th>Excerpt</th>
                <th>Reason</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="moderationTable">
              <tr>
                <td colspan="7" class="table-loading">Loading reports...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="admin-pagination" id="moderationPagination">
          <button class="btn-pagination" disabled>Previous</button>
          <span class="pagination-info">Page 1</span>
          <button class="btn-pagination" disabled>Next</button>
        </div>
      </section>

      <!-- Analytics View -->
      <section class="admin-view" id="viewAnalytics" hidden>
        <header class="admin-view-header">
          <h2>Analytics</h2>
          <p class="admin-view-subtitle">Engagement and contributors overview</p>
        </header>
        <div id="analyticsContent">
          <div class="admin-stats-grid">
            <div class="admin-stat-card"><h4>Comments Today</h4><p style="font-size: 28px; font-weight: 700;">-</p></div>
            <div class="admin-stat-card"><h4>Comments This Week</h4><p style="font-size: 28px; font-weight: 700;">-</p></div>
            <div class="admin-stat-card"><h4>Active Users Today</h4><p style="font-size: 28px; font-weight: 700;">-</p></div>
            <div class="admin-stat-card"><h4>Average Rating</h4><p style="font-size: 28px; font-weight: 700;">-</p></div>
          </div>
        </div>
      </section>

      <!-- Quests View -->
      <section class="admin-view" id="viewQuests" hidden>
        <header class="admin-view-header">
          <div>
            <h2>Quests</h2>
            <p class="admin-view-subtitle">Manage quest tasks (category: "quest")</p>
          </div>
          <div class="admin-view-actions">
            <button class="btn-secondary" type="button" id="btnRefreshQuests">Refresh</button>
            <button class="btn-primary" type="button" id="btnAddQuest">New Quest</button>
          </div>
        </header>

        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>XP</th>
                <th>Active</th>
                <th>Sort</th>
                <th>Code</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="questsTableBody">
              <tr>
                <td colspan="6" class="table-loading">Loading quests...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Users View -->
      <section class="admin-view" id="viewUsers" hidden>
        <header class="admin-view-header">
          <h2>User Management</h2>
          <p class="admin-view-subtitle">Manage user accounts and profiles</p>
        </header>

        <!-- User Search -->
        <div class="admin-search-bar">
          <input 
            type="text" 
            id="userSearch" 
            placeholder="Search users by name, email, or username..."
            class="admin-search-input"
          />
          <button class="btn-admin-search" id="btnUserSearch">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            Search
          </button>
        </div>

        <!-- Users Table -->
        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Level</th>
                <th>XP</th>
                <th>Joined</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="usersTable">
              <tr>
                <td colspan="7" class="table-loading">Loading users...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="admin-pagination" id="usersPagination">
          <button class="btn-pagination" id="btnUsersPrev">Previous</button>
          <span class="pagination-info" id="usersPaginationInfo">Page 1</span>
          <button class="btn-pagination" id="btnUsersNext">Next</button>
        </div>
      </section>

      <!-- Referrals View -->
      <section class="admin-view" id="viewReferrals" hidden>
        <header class="admin-view-header">
          <div>
            <h2>üîó Referral System</h2>
            <p class="admin-view-subtitle">Manage referrals, XP rewards, and view referral tree</p>
          </div>
        </header>

        <!-- Referral Tabs -->
        <div class="admin-tabs" id="referralTabs">
          <button class="admin-tab active" data-tab="referralSettings">‚öôÔ∏è Settings</button>
          <button class="admin-tab" data-tab="referralList">üìã All Referrals</button>
          <button class="admin-tab" data-tab="referralTree">üå≥ Tree View</button>
          <button class="admin-tab" data-tab="referralStats">üìä Statistics</button>
        </div>

        <!-- Tab: Settings -->
        <div class="admin-tab-content active" id="tabReferralSettings">
          <div class="admin-card" style="max-width: 500px;">
            <h3>XP Reward Settings</h3>
            <div class="form-group" style="margin-top: 16px;">
              <label for="referralXpAmount">XP za polecenie u≈ºytkownika:</label>
              <div style="display: flex; gap: 12px; align-items: center; margin-top: 8px;">
                <input type="number" id="referralXpAmount" class="form-control" min="0" max="10000" value="100" style="width: 120px;">
                <span>XP</span>
                <button class="btn-primary" id="btnSaveReferralXp">üíæ Save</button>
              </div>
            </div>
            <p class="text-muted" style="margin-top: 12px; font-size: 13px;">
              This amount will be awarded to the referrer when someone registers using their referral link.
            </p>
          </div>
        </div>

        <!-- Tab: All Referrals List -->
        <div class="admin-tab-content" id="tabReferralList" hidden>
          <div class="admin-search-bar">
            <input type="text" id="referralSearch" placeholder="Search by username or email..." class="admin-search-input" />
            <select id="referralStatusFilter" class="form-control" style="width: 150px;">
              <option value="">All statuses</option>
              <option value="pending">Pending</option>
              <option value="confirmed">Confirmed</option>
              <option value="rejected">Rejected</option>
            </select>
            <button class="btn-admin-search" id="btnRefreshReferrals">üîÑ Refresh</button>
          </div>

          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Referrer</th>
                  <th>Referred User</th>
                  <th>Date</th>
                  <th>Status</th>
                  <th>XP Awarded</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="referralsTable">
                <tr>
                  <td colspan="6" class="table-loading">Loading referrals...</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="admin-pagination" id="referralsPagination">
            <button class="btn-pagination" id="btnReferralsPrev">Previous</button>
            <span class="pagination-info" id="referralsPaginationInfo">Page 1</span>
            <button class="btn-pagination" id="btnReferralsNext">Next</button>
          </div>
        </div>

        <!-- Tab: Tree View -->
        <div class="admin-tab-content" id="tabReferralTree" hidden>
          <div class="admin-search-bar">
            <input type="text" id="treeSearch" placeholder="Find user in tree..." class="admin-search-input" />
            <button class="btn-secondary" id="btnExpandAll">Expand All</button>
            <button class="btn-secondary" id="btnCollapseAll">Collapse All</button>
          </div>
          <div id="referralTreeContainer" class="referral-tree-container">
            <p class="text-muted">Loading referral tree...</p>
          </div>
        </div>

        <!-- Tab: Statistics -->
        <div class="admin-tab-content" id="tabReferralStats" hidden>
          <div class="admin-stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
            <div class="admin-stat-card">
              <div class="stat-value" id="statTotalReferrals">0</div>
              <div class="stat-label">Total Referrals</div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-value" id="statConfirmedReferrals">0</div>
              <div class="stat-label">Confirmed</div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-value" id="statPendingReferrals">0</div>
              <div class="stat-label">Pending</div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-value" id="statTotalXpAwarded">0</div>
              <div class="stat-label">XP Awarded</div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-value" id="statUniqueReferrers">0</div>
              <div class="stat-label">Active Referrers</div>
            </div>
          </div>

          <h3>üèÜ Top Referrers</h3>
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>#</th>
                  <th>User</th>
                  <th>Referrals</th>
                  <th>XP Earned</th>
                </tr>
              </thead>
              <tbody id="topReferrersTable">
                <tr>
                  <td colspan="4" class="table-loading">Loading...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- POIs View -->
      <section class="admin-view" id="viewPois" hidden>
        <header class="admin-view-header">
          <div>
            <h2>Points of Interest</h2>
            <p class="admin-view-subtitle">Manage POIs and locations</p>
          </div>
          <div class="admin-view-actions">
            <span class="poi-data-source" id="poiDataSourceBadge" hidden></span>
            <button class="btn-secondary" type="button" id="btnRefreshPois" title="Reload POIs">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="23 4 23 10 17 10"/>
                <polyline points="1 20 1 14 7 14"/>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10"/>
                <path d="M20.49 15a9 9 0 0 1-14.85 3.36L1 14"/>
              </svg>
              Refresh
            </button>
            <button class="btn-primary" type="button" id="btnAddPoi">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              New POI
            </button>
          </div>
        </header>

        <!-- POI Stats -->
        <div class="admin-stats-grid poi-stats">
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Total POIs</p>
              <p class="stat-card-value" id="poiStatTotal">0</p>
              <p class="stat-card-change" id="poiStatLiveStatus">Awaiting data...</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Published</p>
              <p class="stat-card-value" id="poiStatPublished">0</p>
              <p class="stat-card-change">Live on map</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Draft / Hidden</p>
              <p class="stat-card-value" id="poiStatDrafts">0</p>
              <p class="stat-card-change">Needs review</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Missing Location</p>
              <p class="stat-card-value" id="poiStatMissingLocation">0</p>
              <p class="stat-card-change">Require GPS coordinates</p>
            </div>
          </div>
        </div>

        <!-- POI i18n Form Container -->
        <div id="poiFormContainer" style="display: none; margin: 24px 0;"></div>

        <!-- Filters -->
        <div class="admin-card">
          <div class="admin-card-body">
            <div class="poi-filters">
              <label class="poi-filter">
                <span>Search</span>
                <input type="search" id="poiSearchInput" placeholder="Search POIs by name, slug or description..." />
              </label>
              <label class="poi-filter">
                <span>Category</span>
                <select id="poiCategoryFilter">
                  <option value="all">All categories</option>
                </select>
              </label>
              <label class="poi-filter">
                <span>Status</span>
                <select id="poiStatusFilter">
                  <option value="all">All statuses</option>
                  <option value="published">Published</option>
                  <option value="draft">Draft</option>
                  <option value="hidden">Hidden</option>
                </select>
              </label>
            </div>
            <p class="poi-filter-helper" id="poiFilterHelper">Use filters to quickly find and audit POIs.</p>
          </div>
        </div>

        <!-- POI Table -->
        <div class="admin-table-container">
          <table class="admin-table admin-poi-table">
            <thead>
              <tr>
                <th>POI</th>
                <th>Category</th>
                <th>Coordinates</th>
                <th>Radius</th>
                <th>Updated</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="poisTableBody">
              <tr>
                <td colspan="6" class="table-loading">Loading POIs...</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="poi-table-footer" id="poiTableFooter"></div>
      </section>

      <!-- Content View -->
      <section class="admin-view" id="viewContent" hidden>
        <header class="admin-view-header">
          <h2>Content Management</h2>
          <p class="admin-view-subtitle">Manage all comments, photos and user-generated content</p>
        </header>

        <!-- Content Stats -->
        <div class="admin-stats-grid" id="contentStats">
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Total Comments</p>
              <p class="stat-card-value">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Total Photos</p>
              <p class="stat-card-value">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Total Likes</p>
              <p class="stat-card-value">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-content">
              <p class="stat-card-label">Active Users</p>
              <p class="stat-card-value">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>
        </div>

        <!-- Search Bar -->
        <div class="admin-search-bar">
          <input 
            type="search" 
            id="contentSearchInput" 
            placeholder="Search comments by user, POI, or content..."
            class="admin-search-input"
            onkeypress="if(event.key === 'Enter') searchComments();"
          />
          <button class="btn-admin-search" onclick="searchComments()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="m21 21-4.35-4.35"/>
            </svg>
            Search
          </button>
          <button class="btn-secondary" onclick="clearContentSearch()">
            Clear
          </button>
        </div>

        <!-- Content Table -->
        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th>User</th>
                <th>POI & Comment</th>
                <th>Info</th>
                <th>Likes</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="contentTable">
              <tr>
                <td colspan="6" class="table-loading">Loading content...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="admin-pagination" id="contentPagination">
          <button class="btn-pagination" disabled>Previous</button>
          <span class="pagination-info">Page 1</span>
          <button class="btn-pagination" disabled>Next</button>
        </div>
      </section>

      <!-- Diagnostics View -->
      <section class="admin-view" id="viewDiagnostics" hidden>
        <header class="admin-view-header">
          <h2>System Diagnostics</h2>
          <p class="admin-view-subtitle">Monitor system health and performance</p>
        </header>

        <div class="admin-diagnostics-grid">
          <div class="diagnostic-card">
            <h4>Database Status</h4>
            <div class="diagnostic-status" id="dbStatus">
              <span class="status-indicator status-checking"></span>
              <span>Checking...</span>
            </div>
          </div>

          <div class="diagnostic-card">
            <h4>API Status</h4>
            <div class="diagnostic-status" id="apiStatus">
              <span class="status-indicator status-checking"></span>
              <span>Checking...</span>
            </div>
          </div>

          <div class="diagnostic-card">
            <h4>Storage Status</h4>
            <div class="diagnostic-status" id="storageStatus">
              <span class="status-indicator status-checking"></span>
              <span>Checking...</span>
            </div>
          </div>
        </div>

        <div class="admin-section">
          <div class="admin-view-header" style="margin-bottom: 16px; display: flex; align-items: center; justify-content: space-between; gap: 12px;">
            <div>
              <h3>Health Checks</h3>
              <p class="admin-view-subtitle">Wykrywanie problem√≥w z konfiguracjƒÖ i danymi. Mo≈ºesz uruchomiƒá pojedyncze testy lub wszystko naraz.</p>
            </div>
            <div class="admin-view-actions">
              <button class="btn-secondary" id="btnRunAllChecks">Run all</button>
            </div>
          </div>

          <!-- Diagnostics summary stats -->
          <div class="admin-stats-grid" style="margin-bottom: 16px;">
            <div class="admin-stat-card">
              <div class="stat-card-content">
                <p class="stat-card-label">Total checks</p>
                <p class="stat-card-value" id="diagStatTotal">0</p>
                <p class="stat-card-change">All defined diagnostics</p>
              </div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-card-content">
                <p class="stat-card-label">Warnings</p>
                <p class="stat-card-value" id="diagStatWarnings">0</p>
                <p class="stat-card-change">Items to improve</p>
              </div>
            </div>
            <div class="admin-stat-card">
              <div class="stat-card-content">
                <p class="stat-card-label">Errors</p>
                <p class="stat-card-value" id="diagStatErrors">0</p>
                <p class="stat-card-change">Critical issues</p>
              </div>
            </div>
          </div>

          <!-- Diagnostics mini chart -->
          <div style="margin-bottom: 24px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:12px;color:var(--admin-text-muted);">
              <span>Checks status distribution</span>
            </div>
            <div style="height:10px;border-radius:999px;overflow:hidden;background:rgba(148,163,184,0.3);display:flex;">
              <div id="diagBarOk" style="height:100%;background:#16a34a;width:0;"></div>
              <div id="diagBarWarn" style="height:100%;background:#f59e0b;width:0;"></div>
              <div id="diagBarError" style="height:100%;background:#ef4444;width:0;"></div>
            </div>
          </div>

          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Check</th>
                  <th>Status</th>
                  <th>Details</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="diagnosticChecksTable">
                <tr>
                  <td colspan="4" class="table-loading">Loading checks...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- System Metrics -->
        <div class="admin-section">
          <h3>System Metrics</h3>
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Metric</th>
                  <th>Value</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody id="systemMetricsTable">
                <tr>
                  <td colspan="3" class="table-loading">Loading metrics...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Cars View -->
      <section class="admin-view" id="viewCars" hidden>
        <header class="admin-view-header">
          <div>
            <h2>Car Rentals</h2>
            <p class="admin-view-subtitle">Manage car rental bookings and vehicles</p>
          </div>
          <div class="admin-view-actions">
            <button class="btn-secondary" type="button" id="btnRefreshCars">Refresh</button>
            <button class="btn-primary" type="button" id="btnAddCar">New Booking</button>
          </div>
        </header>

        <!-- Sub-navigation for Cars -->
        <div style="margin-bottom: 24px; border-bottom: 2px solid var(--admin-border); display: flex; gap: 8px;">
          <button class="cars-tab-button active" data-tab="bookings" style="padding: 12px 24px; background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; font-weight: 500; color: var(--admin-text-muted); transition: all 0.2s;">
            Bookings
          </button>
          <button class="cars-tab-button" data-tab="fleet" style="padding: 12px 24px; background: none; border: none; border-bottom: 2px solid transparent; cursor: pointer; font-weight: 500; color: var(--admin-text-muted); transition: all 0.2s;">
            Fleet Management
          </button>
        </div>

        <!-- Car Stats -->
        <div class="admin-stats-grid">
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-blue">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 17h14v2H5v-2zM3 11l2.5-5h13L21 11M3 11v6h18v-6M3 11h18"/>
                <circle cx="7.5" cy="15.5" r="1.5"/>
                <circle cx="16.5" cy="15.5" r="1.5"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Bookings</p>
              <p class="stat-card-value" id="statTotalBookings">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-green">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Active Rentals</p>
              <p class="stat-card-value" id="statActiveRentals">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-orange">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Pending</p>
              <p class="stat-card-value" id="statPendingBookings">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-purple">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Revenue (Total)</p>
              <p class="stat-card-value" id="statTotalRevenue">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>
        </div>

        <!-- Bookings Tab Content -->
        <div id="carsTabBookings" class="cars-tab-content">
          <!-- Cars Table (Bookings) -->
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Booking ID</th>
                  <th>Customer</th>
                  <th>Car Type</th>
                  <th>Dates</th>
                  <th>Status</th>
                  <th>Amount</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="carsTableBody">
                <tr>
                  <td colspan="7" class="table-loading">Loading car bookings...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Fleet Tab Content -->
        <div id="carsTabFleet" class="cars-tab-content" hidden>
          <div style="margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; gap: 12px;">
              <select id="fleetLocationFilter" class="admin-form-field" style="padding: 8px 12px;">
                <option value="">All Locations</option>
                <option value="larnaca">Larnaca</option>
                <option value="paphos">Paphos</option>
              </select>
              <select id="fleetTypeFilter" class="admin-form-field" style="padding: 8px 12px;">
                <option value="">All Types</option>
                <option value="Economy">Economy</option>
                <option value="Compact">Compact</option>
                <option value="SUV">SUV</option>
                <option value="MPV">MPV</option>
                <option value="Luxury">Luxury</option>
              </select>
            </div>
            <button class="btn-primary" type="button" id="btnAddFleetCar">Add New Car</button>
          </div>

          <!-- Fleet Table -->
          <div class="admin-table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th style="width: 80px;">Image</th>
                  <th>Location</th>
                  <th>Order</th>
                  <th>Car Model</th>
                  <th>Type</th>
                  <th>Price</th>
                  <th>Transmission</th>
                  <th>Fuel</th>
                  <th>Seats</th>
                  <th>Available</th>
                  <th style="width: 120px;">Actions</th>
                </tr>
              </thead>
              <tbody id="fleetTableBody">
                <tr>
                  <td colspan="11" class="table-loading">Loading fleet...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Recommendations View -->
      <section class="admin-view" id="viewRecommendations" hidden>
        <header class="admin-view-header">
          <div>
            <h2>Recommendations</h2>
            <p class="admin-view-subtitle">Manage recommended places on Cyprus</p>
          </div>
          <div class="admin-view-actions">
            <button class="btn-secondary" type="button" id="btnRefreshRecommendations">Refresh</button>
            <button class="btn-primary" type="button" id="btnAddRecommendation">New Recommendation</button>
          </div>
        </header>

        <!-- Stats Cards -->
        <div class="admin-stats-grid">
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-purple">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Recommendations</p>
              <p class="stat-card-value" id="statTotalRecommendations">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-green">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Active</p>
              <p class="stat-card-value" id="statActiveRecommendations">-</p>
              <p class="stat-card-change">Loading...</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-blue">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Views</p>
              <p class="stat-card-value" id="statTotalViews">-</p>
              <p class="stat-card-change">All time</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-orange">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Clicks</p>
              <p class="stat-card-value" id="statTotalClicks">-</p>
              <p class="stat-card-change">All time</p>
            </div>
          </div>
        </div>

        <!-- Filters -->
        <div style="margin: 24px 0; display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
          <input 
            type="text" 
            id="recommendationSearchInput" 
            class="admin-form-field" 
            placeholder="Search recommendations..." 
            style="flex: 1; min-width: 250px;"
          />
          <select id="recommendationCategoryFilter" class="admin-form-field" style="min-width: 180px;">
            <option value="">All Categories</option>
          </select>
          <select id="recommendationStatusFilter" class="admin-form-field" style="min-width: 150px;">
            <option value="">All Status</option>
            <option value="active">Active</option>
            <option value="inactive">Inactive</option>
            <option value="featured">Featured</option>
          </select>
        </div>

        <!-- Recommendations Table -->
        <div class="admin-table-container">
          <table class="admin-table">
            <thead>
              <tr>
                <th style="width: 80px;">Image</th>
                <th style="width: 50px;">Order</th>
                <th>Title</th>
                <th>Category</th>
                <th>Location</th>
                <th>Views</th>
                <th>Clicks</th>
                <th>Promo Code</th>
                <th>Status</th>
                <th style="width: 150px;">Actions</th>
              </tr>
            </thead>
            <tbody id="recommendationsTableBody">
              <tr>
                <td colspan="10" class="table-loading">Loading recommendations...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- XP Control View -->
      <section class="admin-view" id="viewXp-control" hidden>
        <header class="admin-view-header">
          <h2>XP Control</h2>
          <p class="admin-view-subtitle">Manage experience points system, level progression, and rewards</p>
        </header>

        <!-- XP Statistics Cards -->
        <div class="admin-stats-grid" id="xpStatsGrid">
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-purple">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total XP Awarded</p>
              <p class="stat-card-value" id="statTotalXp">-</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-blue">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Users with XP</p>
              <p class="stat-card-value" id="statUsersWithXp">-</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-green">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 20V10"/>
                <path d="M18 20V4"/>
                <path d="M6 20v-4"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Average XP</p>
              <p class="stat-card-value" id="statAvgXp">-</p>
            </div>
          </div>

          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-orange">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M8.21 13.89 7 23l5-3 5 3-1.21-9.12"/>
                <circle cx="12" cy="8" r="7"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Highest Level</p>
              <p class="stat-card-value" id="statMaxLevel">-</p>
            </div>
          </div>
        </div>

        <!-- XP Control Tabs -->
        <div class="admin-tabs" style="margin-top: 24px;">
          <button class="admin-tab active" data-xp-tab="rewards">‚≠ê XP Rewards</button>
          <button class="admin-tab" data-xp-tab="config">‚öôÔ∏è Configuration</button>
          <button class="admin-tab" data-xp-tab="users">üë• User XP</button>
          <button class="admin-tab" data-xp-tab="history">üìú History</button>
        </div>

        <!-- Tab: XP Rewards (xp_rules) -->
        <div class="admin-tab-content active" id="xpTabRewards">
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>XP Reward Rules</h3>
              <button class="btn-primary" id="btnAddXpRule">+ Add Rule</button>
            </div>
            <div class="admin-card-body">
              <p style="color: var(--admin-text-muted); margin-bottom: 16px;">
                Define how much XP users earn for different actions.
              </p>
              <table class="admin-table" id="xpRulesTable">
                <thead>
                  <tr>
                    <th>Event Key</th>
                    <th>XP Amount</th>
                    <th>Category</th>
                    <th>Description</th>
                    <th>Active</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="xpRulesTableBody">
                  <tr>
                    <td colspan="6" style="text-align: center; padding: 24px;">Loading...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Tab: Configuration -->
        <div class="admin-tab-content" id="xpTabConfig" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header">
              <h3>Level Progression Settings</h3>
            </div>
            <div class="admin-card-body">
              <p style="color: var(--admin-text-muted); margin-bottom: 16px;">
                Configure how levels are calculated from XP. Current formula: <strong>Level = XP √∑ 1000</strong>
              </p>
              
              <div class="admin-form-grid" style="max-width: 600px;">
                <label class="admin-form-field">
                  <span>Level Formula Type</span>
                  <select id="xpFormulaType" class="form-control">
                    <option value="simple" selected>Simple (XP √∑ divisor)</option>
                    <option value="linear">Linear (base + level √ó increment)</option>
                    <option value="exponential">Exponential (base √ó multiplier^level)</option>
                  </select>
                </label>
                
                <label class="admin-form-field">
                  <span>Divisor (for Simple formula)</span>
                  <input type="number" id="xpDivisor" class="form-control" value="1000" min="100" step="100">
                </label>
                
                <label class="admin-form-field">
                  <span>Maximum Level</span>
                  <input type="number" id="xpMaxLevel" class="form-control" value="100" min="1" max="1000">
                </label>
                
                <label class="admin-form-field">
                  <span>Global XP Multiplier</span>
                  <input type="number" id="xpMultiplier" class="form-control" value="1.0" min="0.1" max="10" step="0.1">
                  <small style="color: var(--admin-text-muted);">Use for double XP events (2.0 = 2x XP)</small>
                </label>
              </div>
              
              <div style="margin-top: 24px;">
                <button class="btn-primary" id="btnSaveXpConfig">üíæ Save Configuration</button>
              </div>
              
              <!-- Level Preview Table -->
              <div style="margin-top: 32px;">
                <h4 style="margin-bottom: 12px;">Level Preview (first 20 levels)</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 8px;" id="levelPreviewGrid">
                  <!-- Generated dynamically -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: User XP -->
        <div class="admin-tab-content" id="xpTabUsers" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header">
              <h3>User XP Management</h3>
            </div>
            <div class="admin-card-body">
              <p style="color: var(--admin-text-muted); margin-bottom: 16px;">
                Search and modify user XP directly.
              </p>
              
              <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <input type="text" id="xpUserSearch" class="form-control" placeholder="Search by email or name..." style="flex: 1; max-width: 400px;">
                <button class="btn-secondary" id="btnSearchXpUser">üîç Search</button>
              </div>
              
              <table class="admin-table" id="xpUsersTable">
                <thead>
                  <tr>
                    <th>User</th>
                    <th>Email</th>
                    <th>XP</th>
                    <th>Level</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="xpUsersTableBody">
                  <tr>
                    <td colspan="5" style="text-align: center; padding: 24px; color: var(--admin-text-muted);">
                      Enter a search term to find users
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Tab: History -->
        <div class="admin-tab-content" id="xpTabHistory" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header">
              <h3>XP Transaction History</h3>
            </div>
            <div class="admin-card-body">
              <p style="color: var(--admin-text-muted); margin-bottom: 16px;">
                Recent XP awards and adjustments from <strong>user_xp_events</strong> table.
              </p>
              
              <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <select id="xpHistoryFilter" class="form-control" style="width: 200px;">
                  <option value="all">All Events</option>
                  <option value="poi">POI Visits</option>
                  <option value="task">Tasks</option>
                  <option value="admin">Admin Adjustments</option>
                </select>
                <button class="btn-secondary" id="btnRefreshXpHistory">üîÑ Refresh</button>
              </div>
              
              <table class="admin-table" id="xpHistoryTable">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>User</th>
                    <th>XP</th>
                    <th>Reason</th>
                  </tr>
                </thead>
                <tbody id="xpHistoryTableBody">
                  <tr>
                    <td colspan="4" style="text-align: center; padding: 24px;">Loading...</td>
                  </tr>
                </tbody>
              </table>
              
              <div style="margin-top: 16px; text-align: center;">
                <button class="btn-secondary" id="btnLoadMoreXpHistory">Load More</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Shop View -->
      <section class="admin-view" id="viewShop" hidden>
        <header class="admin-view-header">
          <h2>Shop Management</h2>
          <p class="admin-view-subtitle">Manage products, orders, vendors, and shop settings</p>
        </header>

        <!-- Shop Stats Cards -->
        <div class="admin-stats-grid" id="shopStatsGrid">
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-green">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Revenue</p>
              <p class="stat-card-value" id="shopStatRevenue">‚Ç¨0</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-blue">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Total Orders</p>
              <p class="stat-card-value" id="shopStatOrders">0</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-purple">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Active Products</p>
              <p class="stat-card-value" id="shopStatProducts">0</p>
            </div>
          </div>
          <div class="admin-stat-card">
            <div class="stat-card-icon stat-card-icon-orange">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
              </svg>
            </div>
            <div class="stat-card-content">
              <p class="stat-card-label">Pending Orders</p>
              <p class="stat-card-value" id="shopStatPending">0</p>
            </div>
          </div>
        </div>

        <!-- Shop Tabs -->
        <div class="admin-tabs" style="margin-top: 24px;">
          <button class="admin-tab active" data-shop-tab="orders">üì¶ Orders</button>
          <button class="admin-tab" data-shop-tab="products">üè∑Ô∏è Products</button>
          <button class="admin-tab" data-shop-tab="categories">üìÅ Categories</button>
          <button class="admin-tab" data-shop-tab="vendors">üè™ Vendors</button>
          <button class="admin-tab" data-shop-tab="discounts">üéüÔ∏è Discounts</button>
          <button class="admin-tab" data-shop-tab="shipping">üöö Shipping</button>
          <button class="admin-tab" data-shop-tab="settings">‚öôÔ∏è Settings</button>
        </div>

        <!-- Tab: Orders -->
        <div class="admin-tab-content active" id="shopTabOrders">
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>Orders</h3>
              <div style="display: flex; gap: 8px;">
                <select id="shopOrderStatusFilter" class="form-control" style="width: 150px;">
                  <option value="">All Statuses</option>
                  <option value="pending">Pending</option>
                  <option value="confirmed">Confirmed</option>
                  <option value="processing">Processing</option>
                  <option value="shipped">Shipped</option>
                  <option value="delivered">Delivered</option>
                  <option value="completed">Completed</option>
                  <option value="cancelled">Cancelled</option>
                  <option value="refunded">Refunded</option>
                </select>
                <button class="btn-secondary" id="btnRefreshShopOrders">üîÑ Refresh</button>
              </div>
            </div>
            <div class="admin-card-body">
              <div class="admin-table-container">
                <table class="admin-table" id="shopOrdersTable">
                  <thead>
                    <tr>
                      <th>Order #</th>
                      <th>Customer</th>
                      <th>Items</th>
                      <th>Total</th>
                      <th>Status</th>
                      <th>Payment</th>
                      <th>Date</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="shopOrdersTableBody">
                    <tr><td colspan="8" style="text-align: center; padding: 24px;">Loading orders...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: Products -->
        <div class="admin-tab-content" id="shopTabProducts" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>Products</h3>
              <button class="btn-primary" id="btnAddShopProduct">+ Add Product</button>
            </div>
            <div class="admin-card-body">
              <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <input type="text" id="shopProductSearch" placeholder="Search products..." class="form-control" style="flex: 1;">
                <select id="shopProductStatusFilter" class="form-control" style="width: 150px;">
                  <option value="">All Status</option>
                  <option value="active">Active</option>
                  <option value="draft">Draft</option>
                  <option value="archived">Archived</option>
                </select>
                <select id="shopProductCategoryFilter" class="form-control" style="width: 150px;">
                  <option value="">All Categories</option>
                </select>
              </div>
              <div class="admin-table-container">
                <table class="admin-table" id="shopProductsTable">
                  <thead>
                    <tr>
                      <th style="width: 60px;">Image</th>
                      <th>Name</th>
                      <th>SKU</th>
                      <th>Price</th>
                      <th>Stock</th>
                      <th>Category</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="shopProductsTableBody">
                    <tr><td colspan="8" style="text-align: center; padding: 24px;">Loading products...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: Categories -->
        <div class="admin-tab-content" id="shopTabCategories" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>Categories</h3>
              <button class="btn-primary" id="btnAddShopCategory">+ Add Category</button>
            </div>
            <div class="admin-card-body">
              <div class="admin-table-container">
                <table class="admin-table" id="shopCategoriesTable">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Slug</th>
                      <th>Parent</th>
                      <th>Products</th>
                      <th>Active</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="shopCategoriesTableBody">
                    <tr><td colspan="6" style="text-align: center; padding: 24px;">Loading categories...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: Vendors -->
        <div class="admin-tab-content" id="shopTabVendors" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>Vendors / Brands</h3>
              <button class="btn-primary" id="btnAddShopVendor">+ Add Vendor</button>
            </div>
            <div class="admin-card-body">
              <p style="color: var(--admin-text-muted); margin-bottom: 16px;">
                Manage vendors whose products you sell. You handle all payouts manually.
              </p>
              <div class="admin-table-container">
                <table class="admin-table" id="shopVendorsTable">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Products</th>
                      <th>Total Sales</th>
                      <th>Revenue</th>
                      <th>Commission</th>
                      <th>Active</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="shopVendorsTableBody">
                    <tr><td colspan="7" style="text-align: center; padding: 24px;">Loading vendors...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: Discounts -->
        <div class="admin-tab-content" id="shopTabDiscounts" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3>Discount Codes</h3>
              <button class="btn-primary" id="btnAddShopDiscount">+ Add Discount</button>
            </div>
            <div class="admin-card-body">
              <div class="admin-table-container">
                <table class="admin-table" id="shopDiscountsTable">
                  <thead>
                    <tr>
                      <th>Code</th>
                      <th>Type</th>
                      <th>Value</th>
                      <th>Usage</th>
                      <th>Expires</th>
                      <th>Active</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="shopDiscountsTableBody">
                    <tr><td colspan="7" style="text-align: center; padding: 24px;">Loading discounts...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: Shipping -->
        <div class="admin-tab-content" id="shopTabShipping" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header">
              <h3>Shipping Zones & Methods</h3>
            </div>
            <div class="admin-card-body">
              <div id="shopShippingZonesContainer">
                <p style="text-align: center; padding: 24px;">Loading shipping zones...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Tab: Settings -->
        <div class="admin-tab-content" id="shopTabSettings" hidden>
          <div class="admin-card" style="margin-top: 16px;">
            <div class="admin-card-header">
              <h3>Shop Settings</h3>
            </div>
            <div class="admin-card-body">
              <form id="shopSettingsForm">
                <div class="admin-form-grid">
                  <label class="admin-form-field">
                    <span>Shop Name</span>
                    <input type="text" id="shopSettingName" placeholder="WakacjeCypr Shop">
                  </label>
                  <label class="admin-form-field">
                    <span>Admin Email</span>
                    <input type="email" id="shopSettingEmail" placeholder="shop@wakacjecypr.com">
                  </label>
                  <label class="admin-form-field">
                    <span>Order Number Prefix</span>
                    <input type="text" id="shopSettingOrderPrefix" placeholder="WC">
                  </label>
                  <label class="admin-form-field">
                    <span>XP per Euro</span>
                    <input type="number" id="shopSettingXpPerEuro" min="0" value="1">
                  </label>
                </div>
                <div style="margin-top: 16px;">
                  <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="shopSettingXpEnabled" checked>
                    <span>Award XP for purchases</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                    <input type="checkbox" id="shopSettingReviewsEnabled" checked>
                    <span>Enable product reviews</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                    <input type="checkbox" id="shopSettingAbandonedCart" checked>
                    <span>Enable abandoned cart reminders</span>
                  </label>
                </div>
                <div style="margin-top: 24px;">
                  <button type="submit" class="btn-primary">Save Settings</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </section>

      <!-- Settings View -->
      <section class="admin-view" id="viewSettings" hidden>
        <header class="admin-view-header">
          <h2>Settings</h2>
          <p class="admin-view-subtitle">Configure admin panel settings</p>
        </header>
        <div class="admin-placeholder">
          <p>Settings coming soon...</p>
        </div>
      </section>

    </main>
  </div>

  <!-- POI Detail Modal -->
  <div class="admin-modal" id="poiDetailModal" hidden>
    <div class="admin-modal-overlay" id="poiDetailModalOverlay"></div>
    <div class="admin-modal-content">
      <header class="admin-modal-header">
        <h3 id="poiDetailTitle">POI Details</h3>
        <button class="btn-modal-close" id="btnClosePoiDetail">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body" id="poiDetailContent">
        <p>Loading POI details...</p>
      </div>
    </div>
  </div>

  <!-- POI Form Modal -->
  <div class="admin-modal" id="poiFormModal" hidden>
    <div class="admin-modal-overlay" id="poiFormModalOverlay"></div>
    <div class="admin-modal-content">
      <header class="admin-modal-header">
        <h3 id="poiFormTitle">New POI</h3>
        <button class="btn-modal-close" id="btnClosePoiForm">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="poiForm" class="poi-form" novalidate>
          <div class="poi-form-warning" id="poiFormWarning" hidden>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
              <line x1="12" y1="9" x2="12" y2="13"/>
              <line x1="12" y1="17" x2="12" y2="17"/>
            </svg>
            <span id="poiFormWarningText"></span>
          </div>
          <!-- I18N Fields Container (rendered dynamically for Name/Description/Badge) -->
          <div id="poiI18nFieldsContainer" style="display: none; margin-bottom: 24px;">
            <div id="poiNameI18n"></div>
            <div id="poiDescriptionI18n"></div>
            <div id="poiBadgeI18n"></div>
          </div>

          <!-- Legacy Name/Description (fallback when not using i18n) -->
          <div id="poiLegacyNameDesc">
            <div class="admin-form-grid">
              <label class="admin-form-field">
                <span>Name *</span>
                <input type="text" id="poiName" name="name" placeholder="e.g. Kato Paphos Archaeological Park" />
              </label>
            </div>
            <label class="admin-form-field">
              <span>Description</span>
              <textarea id="poiDescription" name="description" rows="4" placeholder="Detailed description shown to players"></textarea>
            </label>
          </div>

          <!-- Technical Fields (ALWAYS VISIBLE) -->
          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Slug</span>
              <input type="text" id="poiSlug" name="slug" placeholder="auto-generated if empty" />
            </label>
            <label class="admin-form-field">
              <span>Category</span>
              <input type="text" id="poiCategory" name="category" placeholder="e.g. heritage" />
            </label>
            <label class="admin-form-field">
              <span>Status</span>
              <select id="poiStatus" name="status">
                <option value="published">Published</option>
                <option value="draft">Draft</option>
                <option value="hidden">Hidden</option>
              </select>
            </label>
            <label class="admin-form-field">
              <span>Latitude *</span>
              <input type="number" step="0.000001" id="poiLatitude" name="latitude" placeholder="34.755670" required />
            </label>
            <label class="admin-form-field">
              <span>Longitude *</span>
              <input type="number" step="0.000001" id="poiLongitude" name="longitude" placeholder="32.404170" required />
            </label>
            <label class="admin-form-field">
              <span>Radius (m)</span>
              <input type="number" min="50" max="500" step="10" id="poiRadius" name="radius" placeholder="150" />
            </label>
            <label class="admin-form-field">
              <span>XP Reward</span>
              <input type="number" min="0" max="1000" step="5" id="poiXP" name="xp" placeholder="100" />
            </label>
            <label class="admin-form-field">
              <span>Google Link</span>
              <input type="url" id="poiGoogleUrl" name="google_url" placeholder="https://maps.app.goo.gl/..." />
            </label>
            <label class="admin-form-field">
              <span>Tags</span>
              <input type="text" id="poiTags" name="tags" placeholder="Comma separated" />
            </label>
          </div>
          
          <div class="poi-form-error" id="poiFormError" hidden></div>
          <div class="poi-form-actions">
            <button type="button" class="btn-secondary" id="poiFormCancel">Cancel</button>
            <button type="submit" class="btn-primary" id="poiFormSubmit">Save POI</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- User Detail Modal -->
  <div class="admin-modal" id="userDetailModal" hidden>
    <div class="admin-modal-overlay" id="userDetailModalOverlay"></div>
    <div class="admin-modal-content">
      <header class="admin-modal-header">
        <h3>User Details</h3>
        <button class="btn-modal-close" id="btnCloseUserModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body" id="userDetailContent">
        <p>Loading user details...</p>
      </div>
    </div>
  </div>

  <!-- Comment Detail Modal -->
  <div class="admin-modal" id="commentDetailModal" hidden>
    <div class="admin-modal-overlay" id="commentDetailModalOverlay"></div>
    <div class="admin-modal-content admin-modal-content-large">
      <header class="admin-modal-header">
        <h3 id="commentDetailTitle">Comment Details</h3>
        <button class="btn-modal-close" id="btnCloseCommentDetail">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body" id="commentDetailContent">
        <p>Loading comment details...</p>
      </div>
    </div>
  </div>

  <!-- Comment Edit Modal -->
  <div class="admin-modal" id="commentEditModal" hidden>
    <div class="admin-modal-overlay" id="commentEditModalOverlay"></div>
    <div class="admin-modal-content">
      <header class="admin-modal-header">
        <h3 id="commentEditTitle">Edit Comment</h3>
        <button class="btn-modal-close" id="btnCloseCommentEdit">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="commentEditForm" onsubmit="handleCommentEditSubmit(event); return false;">
          <div class="admin-form-field">
            <span>Comment Content *</span>
            <textarea 
              id="commentEditContent" 
              name="content" 
              rows="8" 
              required 
              placeholder="Enter comment content..."
              style="min-height: 150px;"
            ></textarea>
          </div>
          <div class="comment-edit-error" id="commentEditError" hidden></div>
          <div class="poi-form-actions">
            <button type="button" class="btn-secondary" id="commentEditCancel">Cancel</button>
            <button type="submit" class="btn-primary" id="commentEditSubmit">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Diagnostics Auto-Fix Modal -->
  <div class="admin-modal" id="diagnosticFixModal" hidden>
    <div class="admin-modal-overlay" id="diagnosticFixModalOverlay"></div>
    <div class="admin-modal-content">
      <header class="admin-modal-header">
        <h3 id="diagnosticFixTitle">Auto-Fix</h3>
        <button class="btn-modal-close" id="btnCloseDiagnosticFix">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <div style="display: grid; gap: 12px;">
          <p id="diagnosticFixDescription" style="color: var(--admin-text-muted);"></p>
          <label class="admin-form-field">
            <span>SQL to run in Supabase</span>
            <textarea id="diagnosticFixSql" rows="12" readonly style="font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;"></textarea>
          </label>
          <div class="poi-form-actions">
            <button type="button" class="btn-secondary" id="btnCopyDiagnosticSql">Copy SQL</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Fleet Car Add/Edit Modal -->
  <div class="admin-modal" id="fleetCarModal" hidden>
    <div class="admin-modal-overlay" id="fleetCarModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 900px;">
      <header class="admin-modal-header">
        <h3 id="fleetCarModalTitle">Add New Car</h3>
        <button class="btn-modal-close" id="btnCloseFleetCarModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="fleetCarForm" novalidate onsubmit="handleFleetCarSubmit(event); return false;">
          <input type="hidden" id="fleetCarId" name="id">
          
          <!-- Basic Info -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
            <label class="admin-form-field">
              <span>Location *</span>
              <select id="fleetCarLocation" name="location" required onchange="handleLocationChange(this.value)">
                <option value="">Select location</option>
                <option value="larnaca">Larnaca</option>
                <option value="paphos">Paphos</option>
              </select>
            </label>

            <label class="admin-form-field">
              <span>Car Type *</span>
              <select id="fleetCarType" name="car_type" required>
                <option value="">Select type</option>
                <option value="Economy">Economy</option>
                <option value="Compact">Compact</option>
                <option value="Hybrid Economy">Hybrid Economy</option>
                <option value="Standard Sedan">Standard Sedan</option>
                <option value="SUV">SUV</option>
                <option value="MPV">MPV / Minivan</option>
                <option value="Luxury">Luxury</option>
                <option value="Premium">Premium</option>
              </select>
            </label>
          </div>

          <!-- I18N Fields Container (hidden by default) -->
          <div id="carI18nFields" style="display: none; margin-bottom: 16px;">
            <!-- Car Model - will be rendered dynamically -->
            <div id="carModelI18n"></div>
            
            <!-- Description - will be rendered dynamically -->
            <div id="carDescriptionI18n"></div>
          </div>

          <!-- Legacy Fields (visible by default) -->
          <div id="carLegacyFields" style="margin-bottom: 16px;">
            <label class="admin-form-field">
              <span>Car Model *</span>
              <input type="text" id="fleetCarModel" name="car_model" required placeholder="e.g., Toyota Yaris (2023)">
            </label>
            
            <label class="admin-form-field">
              <span>Description</span>
              <textarea id="fleetCarDescription" name="description" rows="3" placeholder="Short description of the car"></textarea>
            </label>
          </div>

          <!-- Pricing Section -->
          <div style="background: var(--admin-card-bg); border: 1px solid var(--admin-border); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
            <h4 style="margin: 0 0 12px; font-size: 14px; font-weight: 600;">Pricing</h4>
            
            <!-- Larnaca Pricing (Single rate) -->
            <div id="larnacaPricing" hidden>
              <label class="admin-form-field">
                <span>Price per day (‚Ç¨) *</span>
                <input type="number" id="fleetCarPricePerDay" name="price_per_day" step="0.01" min="0" placeholder="e.g. 35.00">
              </label>
            </div>

            <!-- Paphos Pricing (Tiered) -->
            <div id="paphosPricing" hidden>
              <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                <label class="admin-form-field">
                  <span>3 days (‚Ç¨) *</span>
                  <input type="number" id="fleetCarPrice3Days" name="price_3days" step="0.01" min="0" placeholder="130.00">
                </label>
                <label class="admin-form-field">
                  <span>4-6 days/day (‚Ç¨)</span>
                  <input type="number" id="fleetCarPrice4_6Days" name="price_4_6days" step="0.01" min="0" placeholder="34.00">
                </label>
                <label class="admin-form-field">
                  <span>7-10 days/day (‚Ç¨)</span>
                  <input type="number" id="fleetCarPrice7_10Days" name="price_7_10days" step="0.01" min="0" placeholder="32.00">
                </label>
                <label class="admin-form-field">
                  <span>10+ days/day (‚Ç¨)</span>
                  <input type="number" id="fleetCarPrice10PlusDays" name="price_10plus_days" step="0.01" min="0" placeholder="30.00">
                </label>
              </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px;">
              <label class="admin-form-field">
                <span>Deposit Amount (‚Ç¨)</span>
                <input type="number" id="fleetCarDeposit" name="deposit_amount" step="0.01" min="0" value="200" placeholder="200.00">
              </label>
              <label class="admin-form-field">
                <span>Insurance per day (‚Ç¨)</span>
                <input type="number" id="fleetCarInsurance" name="insurance_per_day" step="0.01" min="0" value="17" placeholder="17.00">
              </label>
            </div>
          </div>

          <!-- Specifications -->
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 16px;">
            <label class="admin-form-field">
              <span>Transmission *</span>
              <select id="fleetCarTransmission" name="transmission" required>
                <option value="manual">Manual</option>
                <option value="automatic">Automatic</option>
              </select>
            </label>

            <label class="admin-form-field">
              <span>Fuel Type *</span>
              <select id="fleetCarFuelType" name="fuel_type" required>
                <option value="petrol">Petrol</option>
                <option value="diesel">Diesel</option>
                <option value="hybrid">Hybrid</option>
                <option value="electric">Electric</option>
              </select>
            </label>

            <label class="admin-form-field">
              <span>Currency</span>
              <select id="fleetCarCurrency" name="currency">
                <option value="EUR">EUR (‚Ç¨)</option>
                <option value="USD">USD ($)</option>
                <option value="GBP">GBP (¬£)</option>
              </select>
            </label>
          </div>

          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 16px;">
            <label class="admin-form-field">
              <span>Max Passengers *</span>
              <input type="number" id="fleetCarMaxPassengers" name="max_passengers" min="1" max="12" value="5" required>
            </label>

            <label class="admin-form-field">
              <span>Max Luggage</span>
              <input type="number" id="fleetCarMaxLuggage" name="max_luggage" min="0" max="10" value="2">
            </label>

            <label class="admin-form-field">
              <span>Stock Count</span>
              <input type="number" id="fleetCarStockCount" name="stock_count" min="0" max="50" value="1">
            </label>

            <label class="admin-form-field">
              <span>Sort Order</span>
              <input type="number" id="fleetCarSortOrder" name="sort_order" min="1" value="1000">
            </label>
          </div>

          <!-- Image Upload and Preview -->
          <div style="background: var(--admin-card-bg); border: 1px solid var(--admin-border); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
            <h4 style="margin: 0 0 12px; font-size: 14px; font-weight: 600;">Car Image</h4>
            
            <!-- Hidden field for image URL -->
            <input type="hidden" id="fleetCarImageUrl" name="image_url">
            
            <!-- Current image preview -->
            <div id="fleetCarImagePreview" style="margin-bottom: 12px;" hidden>
              <div style="position: relative; display: inline-block;">
                <img id="fleetCarImagePreviewImg" src="" alt="Car preview" style="max-width: 300px; max-height: 200px; border-radius: 8px; border: 2px solid var(--admin-border);">
                <button type="button" id="btnRemoveCarImage" class="btn-secondary" style="position: absolute; top: 8px; right: 8px; padding: 4px 8px; font-size: 12px; background: rgba(239, 68, 68, 0.9); color: white; border: none;">
                  Remove
                </button>
              </div>
            </div>
            
            <!-- Upload new image -->
            <div id="fleetCarImageUploadArea">
              <label class="admin-form-field" style="cursor: pointer;">
                <span>Upload Car Image</span>
                <input type="file" id="fleetCarImageFile" name="image_file" accept="image/jpeg,image/jpg,image/png,image/webp" style="display: block; padding: 8px; cursor: pointer;">
                <small style="color: var(--admin-text-muted); font-size: 11px; margin-top: 4px;">
                  Upload from your device (JPG, PNG, WebP - max 5MB)
                </small>
              </label>
              
              <!-- Upload progress -->
              <div id="fleetCarImageUploadProgress" hidden style="margin-top: 8px;">
                <div style="background: var(--admin-border); height: 4px; border-radius: 2px; overflow: hidden;">
                  <div id="fleetCarImageUploadProgressBar" style="background: var(--admin-primary); height: 100%; width: 0%; transition: width 0.3s;"></div>
                </div>
                <small id="fleetCarImageUploadStatus" style="color: var(--admin-text-muted); font-size: 11px; margin-top: 4px; display: block;"></small>
              </div>
            </div>

            <!-- Alternative: URL input (optional) -->
            <details style="margin-top: 12px;">
              <summary style="cursor: pointer; color: var(--admin-text-muted); font-size: 12px;">Or paste image URL</summary>
              <div style="margin-top: 8px;">
                <input type="url" id="fleetCarImageUrlInput" placeholder="https://example.com/car-image.jpg" style="width: 100%; padding: 8px; border: 1px solid var(--admin-border); border-radius: 4px;">
                <button type="button" id="btnUseImageUrl" class="btn-secondary" style="margin-top: 4px; padding: 4px 12px; font-size: 12px;">Use this URL</button>
              </div>
            </details>
          </div>

          <!-- Availability -->
          <div style="margin-bottom: 16px;">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" id="fleetCarIsAvailable" name="is_available" checked style="width: 18px; height: 18px;">
              <span style="font-weight: 500;">Car is available for rent</span>
            </label>
          </div>

          <!-- Features (i18n JSONB array) -->
          <div style="margin-bottom: 16px;">
            <label class="admin-form-field">
              <span>Features</span>
              <div id="featuresI18n" style="margin-top: 8px;">
                <!-- i18n tabs will be rendered here by JS -->
              </div>
              <small style="color: var(--admin-text-muted); font-size: 11px; margin-top: 4px;">Enter each feature on a new line</small>
            </label>
          </div>

          <!-- Error Display -->
          <div id="fleetCarFormError" class="admin-error-message" hidden style="margin-bottom: 16px;"></div>

          <!-- Actions -->
          <div class="poi-form-actions">
            <button type="button" class="btn-secondary" id="fleetCarFormCancel">Cancel</button>
            <button type="submit" class="btn-primary" id="fleetCarFormSubmit">Save Car</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Car Booking Details Modal -->
  <div class="admin-modal" id="bookingDetailsModal" hidden>
    <div class="admin-modal-overlay" id="bookingDetailsModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 800px;">
      <header class="admin-modal-header">
        <h3>Booking Details</h3>
        <button class="btn-modal-close" id="btnCloseBookingDetails">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body" id="bookingDetailsContent">
        <!-- Content will be dynamically filled -->
        <div style="text-align: center; padding: 40px; color: var(--admin-text-muted);">
          Loading booking details...
        </div>
      </div>
      <footer class="admin-modal-footer" style="display: flex; gap: 12px; justify-content: flex-end;">
        <button type="button" class="btn-secondary" id="btnEditBooking">Edit Booking</button>
        <button type="button" class="btn-primary" id="btnConfirmBooking">Confirm Booking</button>
        <button type="button" class="btn-secondary user-detail-danger" id="btnCancelBooking">Cancel Booking</button>
      </footer>
    </div>
  </div>

  <!-- Edit Booking Modal -->
  <div class="admin-modal" id="editBookingModal" hidden>
    <div class="admin-modal-overlay" id="editBookingModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 900px;">
      <header class="admin-modal-header">
        <h3>Edit Booking</h3>
        <button class="btn-modal-close" id="btnCloseEditBooking">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="editBookingForm">
          <input type="hidden" id="editBookingId">
          
          <div style="display: grid; gap: 24px;">
            <!-- Customer Info -->
            <div>
              <h4 style="margin: 0 0 12px; font-size: 14px; font-weight: 600; color: var(--admin-text-muted);">Customer Information</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <label class="admin-form-field">
                  <span>Full Name *</span>
                  <input type="text" id="editFullName" required>
                </label>
                <label class="admin-form-field">
                  <span>Email *</span>
                  <input type="email" id="editEmail" required>
                </label>
                <label class="admin-form-field">
                  <span>Phone *</span>
                  <input type="tel" id="editPhone" required>
                </label>
                <label class="admin-form-field">
                  <span>Country</span>
                  <input type="text" id="editCountry">
                </label>
              </div>
            </div>

            <!-- Rental Details -->
            <div>
              <h4 style="margin: 0 0 12px; font-size: 14px; font-weight: 600; color: var(--admin-text-muted);">Rental Details</h4>
              <div style="display: grid; gap: 12px;">
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 12px;">
                  <label class="admin-form-field">
                    <span>Car Model *</span>
                    <input type="text" id="editCarModel" required>
                  </label>
                  <label class="admin-form-field">
                    <span>Location *</span>
                    <select id="editLocation" required>
                      <option value="paphos">Paphos</option>
                      <option value="larnaca">Larnaca</option>
                    </select>
                  </label>
                </div>

                <div style="display: grid; grid-template-columns: 2fr 1fr 2fr; gap: 12px;">
                  <label class="admin-form-field">
                    <span>Pickup Date *</span>
                    <input type="date" id="editPickupDate" required>
                  </label>
                  <label class="admin-form-field">
                    <span>Time</span>
                    <input type="time" id="editPickupTime" value="10:00">
                  </label>
                  <label class="admin-form-field">
                    <span>Pickup Location *</span>
                    <select id="editPickupLocation" required>
                      <option value="airport_pfo">Airport PFO</option>
                      <option value="airport_lca">Airport LCA</option>
                      <option value="hotel">Hotel</option>
                      <option value="city_center">City Center</option>
                      <option value="other">Other</option>
                    </select>
                  </label>
                </div>

                <label class="admin-form-field">
                  <span>Pickup Address (if Hotel/Other)</span>
                  <input type="text" id="editPickupAddress" placeholder="Hotel name or address">
                </label>

                <div style="display: grid; grid-template-columns: 2fr 1fr 2fr; gap: 12px;">
                  <label class="admin-form-field">
                    <span>Return Date *</span>
                    <input type="date" id="editReturnDate" required>
                  </label>
                  <label class="admin-form-field">
                    <span>Time</span>
                    <input type="time" id="editReturnTime" value="10:00">
                  </label>
                  <label class="admin-form-field">
                    <span>Return Location *</span>
                    <select id="editReturnLocation" required>
                      <option value="airport_pfo">Airport PFO</option>
                      <option value="airport_lca">Airport LCA</option>
                      <option value="hotel">Hotel</option>
                      <option value="city_center">City Center</option>
                      <option value="other">Other</option>
                    </select>
                  </label>
                </div>

                <label class="admin-form-field">
                  <span>Return Address (if Hotel/Other)</span>
                  <input type="text" id="editReturnAddress" placeholder="Hotel name or address">
                </label>
              </div>
            </div>

            <!-- Additional Options -->
            <div>
              <h4 style="margin: 0 0 12px; font-size: 14px; font-weight: 600; color: var(--admin-text-muted);">Additional Options</h4>
              <div style="display: grid; grid-template-columns: 1fr 1fr 2fr; gap: 12px;">
                <label class="admin-form-field">
                  <span>Passengers</span>
                  <input type="number" id="editNumPassengers" min="1" max="8" value="2">
                </label>
                <label class="admin-form-field">
                  <span>Child Seats</span>
                  <input type="number" id="editChildSeats" min="0" max="3" value="0">
                </label>
                <label class="admin-form-field">
                  <span>Flight Number</span>
                  <input type="text" id="editFlightNumber" placeholder="W1234">
                </label>
              </div>
              <label class="admin-form-field" style="margin-top: 12px;">
                <input type="checkbox" id="editFullInsurance" style="width: auto; margin-right: 8px;">
                <span>Full Insurance (+17‚Ç¨/day)</span>
              </label>
              <label class="admin-form-field" style="margin-top: 12px;">
                <span>Special Requests</span>
                <textarea id="editSpecialRequests" rows="3"></textarea>
              </label>
            </div>

            <!-- Status -->
            <div>
              <h4 style="margin: 0 0 12px; font-size: 14px; font-weight: 600; color: var(--admin-text-muted);">Booking Status</h4>
              <label class="admin-form-field">
                <span>Status</span>
                <select id="editStatus">
                  <option value="pending">Pending</option>
                  <option value="confirmed">Confirmed</option>
                  <option value="completed">Completed</option>
                  <option value="cancelled">Cancelled</option>
                </select>
              </label>
            </div>
          </div>

          <div id="editBookingError" class="admin-error-message" hidden style="margin-top: 16px;"></div>

          <div class="poi-form-actions" style="margin-top: 24px;">
            <button type="button" class="btn-secondary" id="editBookingCancel">Cancel</button>
            <button type="submit" class="btn-primary" id="editBookingSubmit">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Quest Form Modal -->
  <div class="admin-modal" id="questFormModal" hidden>
    <div class="admin-modal-overlay" id="questFormModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 800px;">
      <header class="admin-modal-header">
        <h3 id="questFormTitle">New Quest</h3>
        <button class="btn-modal-close" id="btnCloseQuestForm">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="questForm">
          <!-- Basic Info -->
          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>ID *</span>
              <input type="text" id="questId" name="id" required placeholder="sunrise-challenge" />
            </label>
            <label class="admin-form-field">
              <span>XP</span>
              <input type="number" id="questXp" name="xp" min="0" step="1" value="0" />
            </label>
            <label class="admin-form-field">
              <span>Sort</span>
              <input type="number" id="questSort" name="sort_order" min="0" step="1" value="1000" />
            </label>
            <label class="admin-form-field">
              <span>Active</span>
              <select id="questActive" name="is_active">
                <option value="true" selected>Yes</option>
                <option value="false">No</option>
              </select>
            </label>
          </div>

          <!-- Title & Description i18n -->
          <div id="questTitleI18nContainer" style="margin-bottom: 16px;"></div>
          <div id="questDescriptionI18nContainer" style="margin-bottom: 16px;"></div>

          <!-- Verification Section -->
          <div style="border-top: 1px solid var(--admin-border); padding-top: 16px; margin-top: 16px;">
            <h4 style="margin: 0 0 12px 0; color: var(--admin-text);">üîê Verification Settings</h4>
            
            <div class="admin-form-grid">
              <label class="admin-form-field">
                <span>Verification Type</span>
                <select id="questVerificationType" name="verification_type">
                  <option value="none">None (manual completion)</option>
                  <option value="code">Code only</option>
                  <option value="location">Location only (GPS)</option>
                  <option value="both">Code + Location</option>
                </select>
              </label>
              <label class="admin-form-field">
                <span>Link to Recommendation</span>
                <select id="questRecommendationId" name="recommendation_id">
                  <option value="">-- None --</option>
                  <!-- Options will be loaded dynamically -->
                </select>
              </label>
            </div>

            <!-- Code verification fields -->
            <div id="questCodeFields" style="display: none; margin-top: 12px;">
              <label class="admin-form-field">
                <span>üîë Unlock Code (given to partners/vendors)</span>
                <input type="text" id="questUnlockCode" name="unlock_code" placeholder="e.g. CYPRUS2024" style="font-family: monospace; text-transform: uppercase;" />
                <small style="color: var(--admin-text-muted);">Users will enter this code to complete the quest</small>
              </label>
            </div>

            <!-- Location verification fields -->
            <div id="questLocationFields" style="display: none; margin-top: 12px;">
              <div class="admin-form-grid">
                <label class="admin-form-field">
                  <span>üìç Latitude</span>
                  <input type="number" id="questLatitude" name="latitude" step="0.000001" placeholder="34.755670" />
                </label>
                <label class="admin-form-field">
                  <span>üìç Longitude</span>
                  <input type="number" id="questLongitude" name="longitude" step="0.000001" placeholder="32.404170" />
                </label>
                <label class="admin-form-field">
                  <span>üìè Radius (meters)</span>
                  <input type="number" id="questLocationRadius" name="location_radius" min="50" max="1000" step="10" value="100" />
                </label>
              </div>
              <div id="questLocationNameI18nContainer" style="margin-top: 12px;"></div>
            </div>
          </div>

          <div class="poi-form-actions" style="margin-top: 20px;">
            <button type="button" class="btn-secondary" id="questFormCancel">Cancel</button>
            <button type="submit" class="btn-primary" id="questFormSubmit">Save Quest</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Recommendation Form Modal -->
  <div class="admin-modal" id="recommendationFormModal" hidden>
    <div class="admin-modal-overlay" id="recommendationFormModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
      <header class="admin-modal-header">
        <h3 id="recommendationFormTitle">New Recommendation</h3>
        <button class="btn-modal-close" id="btnCloseRecommendationForm">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body" id="recommendationFormContent">
        <!-- Form will be dynamically rendered here by recommendation-i18n-form.js -->
      </div>
    </div>
  </div>

  <!-- Shop Product Form Modal -->
  <div class="admin-modal" id="shopProductModal" hidden>
    <div class="admin-modal-overlay" id="shopProductModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
      <header class="admin-modal-header">
        <h3 id="shopProductModalTitle">New Product</h3>
        <button class="btn-modal-close" id="btnCloseShopProductModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="shopProductForm" novalidate>
          <input type="hidden" id="shopProductId">
          
          <!-- Language Tabs -->
          <div class="lang-tabs" style="display: flex; gap: 8px; margin-bottom: 16px; border-bottom: 1px solid var(--admin-border);">
            <button type="button" class="lang-tab active" data-lang="pl" onclick="switchProductLang('pl')">üáµüá± Polski</button>
            <button type="button" class="lang-tab" data-lang="en" onclick="switchProductLang('en')">üá¨üáß English</button>
          </div>

          <!-- Polish Content -->
          <div id="productLangPL" class="lang-content active">
            <label class="admin-form-field">
              <span>Nazwa produktu (PL) *</span>
              <input type="text" id="shopProductName" required placeholder="np. Oliwa z oliwek cypryjska">
            </label>
            <label class="admin-form-field">
              <span>Opis (PL)</span>
              <textarea id="shopProductDescription" rows="3" placeholder="Opis produktu po polsku..."></textarea>
            </label>
            <label class="admin-form-field">
              <span>Kr√≥tki opis (PL)</span>
              <input type="text" id="shopProductShortDesc" placeholder="Kr√≥tki opis dla listy produkt√≥w">
            </label>
          </div>

          <!-- English Content -->
          <div id="productLangEN" class="lang-content">
            <label class="admin-form-field">
              <span>Product Name (EN) *</span>
              <input type="text" id="shopProductNameEn" placeholder="e.g. Cyprus Olive Oil">
            </label>
            <label class="admin-form-field">
              <span>Description (EN)</span>
              <textarea id="shopProductDescriptionEn" rows="3" placeholder="Product description in English..."></textarea>
            </label>
            <label class="admin-form-field">
              <span>Short Description (EN)</span>
              <input type="text" id="shopProductShortDescEn" placeholder="Short description for product list">
            </label>
          </div>

          <hr style="margin: 16px 0; border: none; border-top: 1px solid var(--admin-border);">

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>SKU</span>
              <input type="text" id="shopProductSku" placeholder="OLIVE-001">
            </label>
            <label class="admin-form-field">
              <span>Slug (URL)</span>
              <input type="text" id="shopProductSlug" placeholder="cyprus-olive-oil">
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Price (‚Ç¨) *</span>
              <input type="number" id="shopProductPrice" step="0.01" min="0" required placeholder="29.99">
            </label>
            <label class="admin-form-field">
              <span>Compare At Price (‚Ç¨)</span>
              <input type="number" id="shopProductComparePrice" step="0.01" min="0" placeholder="39.99">
            </label>
            <label class="admin-form-field">
              <span>Cost (‚Ç¨)</span>
              <input type="number" id="shopProductCost" step="0.01" min="0" placeholder="15.00">
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Category</span>
              <select id="shopProductCategory">
                <option value="">No Category</option>
              </select>
            </label>
            <label class="admin-form-field">
              <span>Vendor</span>
              <select id="shopProductVendor">
                <option value="">No Vendor</option>
              </select>
            </label>
            <label class="admin-form-field">
              <span>Status</span>
              <select id="shopProductStatus">
                <option value="draft">Draft</option>
                <option value="active">Active</option>
                <option value="archived">Archived</option>
              </select>
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Product Type</span>
              <select id="shopProductType">
                <option value="simple">Simple (Physical)</option>
                <option value="variable">Variable</option>
                <option value="grouped">Grouped</option>
                <option value="bundle">Bundle</option>
                <option value="digital">Digital</option>
                <option value="subscription">Subscription</option>
              </select>
            </label>
            <label class="admin-form-field">
              <span>Weight (kg)</span>
              <input type="number" id="shopProductWeight" step="0.01" min="0" placeholder="0.5">
            </label>
            <label class="admin-form-field">
              <span>Tax Class</span>
              <select id="shopProductTaxClass">
                <option value="">Default</option>
              </select>
            </label>
          </div>

          <div style="margin: 16px 0; padding: 16px; background: var(--admin-bg); border-radius: 8px;">
            <h4 style="margin: 0 0 12px; font-size: 14px;">Inventory</h4>
            <div style="display: flex; gap: 16px; flex-wrap: wrap;">
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" id="shopProductTrackInventory">
                <span>Track inventory</span>
              </label>
              <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" id="shopProductAllowBackorder">
                <span>Allow backorders</span>
              </label>
            </div>
            <div class="admin-form-grid" style="margin-top: 12px;">
              <label class="admin-form-field">
                <span>Stock Quantity</span>
                <input type="number" id="shopProductStock" min="0" value="0">
              </label>
              <label class="admin-form-field">
                <span>Low Stock Threshold</span>
                <input type="number" id="shopProductLowStock" min="0" value="5">
              </label>
            </div>
          </div>

          <div style="margin: 16px 0; display: flex; gap: 16px; flex-wrap: wrap;">
            <label style="display: flex; align-items: center; gap: 8px;">
              <input type="checkbox" id="shopProductFeatured">
              <span>Featured product</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px;">
              <input type="checkbox" id="shopProductRequiresShipping" checked>
              <span>Requires shipping</span>
            </label>
          </div>

          <!-- Product Images Section -->
          <div style="margin: 16px 0; padding: 16px; background: var(--admin-bg); border-radius: 8px;">
            <h4 style="margin: 0 0 12px; font-size: 14px;">Zdjƒôcia produktu</h4>
            
            <!-- Thumbnail -->
            <div class="admin-form-field">
              <span>G≈Ç√≥wne zdjƒôcie (thumbnail)</span>
              <div style="display: flex; gap: 8px; align-items: center; margin-top: 4px;">
                <input type="file" id="shopProductThumbnailFile" accept="image/*" style="display: none;">
                <button type="button" class="btn-secondary" onclick="document.getElementById('shopProductThumbnailFile').click()" style="white-space: nowrap;">
                  üì§ Upload
                </button>
                <input type="url" id="shopProductThumbnail" placeholder="lub wklej URL..." style="flex: 1;">
              </div>
              <div id="shopProductThumbnailPreview" style="margin-top: 8px;"></div>
            </div>
            
            <!-- Gallery Images -->
            <div class="admin-form-field" style="margin-top: 16px;">
              <span>Galeria zdjƒôƒá</span>
              <div style="display: flex; gap: 8px; align-items: center; margin-top: 4px;">
                <input type="file" id="shopProductGalleryFiles" accept="image/*" multiple style="display: none;">
                <button type="button" class="btn-secondary" onclick="document.getElementById('shopProductGalleryFiles').click()" style="white-space: nowrap;">
                  üì§ Upload wielu
                </button>
                <span style="color: var(--admin-text-muted); font-size: 12px;">lub dodaj URLe poni≈ºej</span>
              </div>
              <div id="shopProductGalleryPreview" style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;"></div>
              <textarea id="shopProductImages" rows="2" placeholder="Dodatkowe URLe (jeden na liniƒô)" style="margin-top: 8px;"></textarea>
            </div>
            
            <!-- Video URL -->
            <label class="admin-form-field" style="margin-top: 12px;">
              <span>Video URL (opcjonalnie)</span>
              <input type="url" id="shopProductVideo" placeholder="https://youtube.com/...">
            </label>
          </div>
          
          <!-- Digital Product Section (hidden by default) -->
          <div id="shopProductDigitalSection" style="margin: 16px 0; padding: 16px; background: var(--admin-bg); border-radius: 8px; display: none;">
            <h4 style="margin: 0 0 12px; font-size: 14px;">üìÅ Produkt cyfrowy</h4>
            <label class="admin-form-field">
              <span>URL pliku do pobrania</span>
              <input type="url" id="shopProductDigitalUrl" placeholder="https://...">
            </label>
            <label class="admin-form-field" style="margin-top: 8px;">
              <span>Nazwa pliku</span>
              <input type="text" id="shopProductDigitalFileName" placeholder="ebook.pdf">
            </label>
            <div class="admin-form-grid" style="margin-top: 8px;">
              <label class="admin-form-field">
                <span>Limit pobra≈Ñ</span>
                <input type="number" id="shopProductDownloadLimit" min="0" placeholder="bez limitu">
              </label>
              <label class="admin-form-field">
                <span>Wa≈ºno≈õƒá (dni)</span>
                <input type="number" id="shopProductDownloadExpiry" min="0" placeholder="bez limitu">
              </label>
            </div>
          </div>
          
          <!-- Subscription Section (hidden by default) -->
          <div id="shopProductSubscriptionSection" style="margin: 16px 0; padding: 16px; background: var(--admin-bg); border-radius: 8px; display: none;">
            <h4 style="margin: 0 0 12px; font-size: 14px;">üîÑ Subskrypcja</h4>
            <div class="admin-form-grid">
              <label class="admin-form-field">
                <span>Okres rozliczeniowy</span>
                <select id="shopProductSubInterval">
                  <option value="day">Dziennie</option>
                  <option value="week">Tygodniowo</option>
                  <option value="month" selected>Miesiƒôcznie</option>
                  <option value="year">Rocznie</option>
                </select>
              </label>
              <label class="admin-form-field">
                <span>Co ile okres√≥w</span>
                <input type="number" id="shopProductSubIntervalCount" min="1" value="1">
              </label>
            </div>
            <div class="admin-form-grid" style="margin-top: 8px;">
              <label class="admin-form-field">
                <span>Dni pr√≥bne</span>
                <input type="number" id="shopProductSubTrialDays" min="0" value="0">
              </label>
              <label class="admin-form-field">
                <span>Op≈Çata poczƒÖtkowa (‚Ç¨)</span>
                <input type="number" id="shopProductSubSignupFee" step="0.01" min="0" value="0">
              </label>
            </div>
          </div>

          <label class="admin-form-field">
            <span>Tags (comma separated)</span>
            <input type="text" id="shopProductTags" placeholder="olive, food, local">
          </label>

          <div id="shopProductFormError" class="admin-error-message" hidden></div>

          <div class="poi-form-actions" style="margin-top: 20px;">
            <button type="button" class="btn-secondary" id="shopProductFormCancel">Cancel</button>
            <button type="submit" class="btn-primary">Save Product</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Shop Category Form Modal -->
  <div class="admin-modal" id="shopCategoryModal" hidden>
    <div class="admin-modal-overlay" id="shopCategoryModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 500px;">
      <header class="admin-modal-header">
        <h3 id="shopCategoryModalTitle">New Category</h3>
        <button class="btn-modal-close" id="btnCloseShopCategoryModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="shopCategoryForm" novalidate>
          <input type="hidden" id="shopCategoryId">
          
          <!-- Language Tabs -->
          <div class="lang-tabs" style="display: flex; gap: 8px; margin-bottom: 16px; border-bottom: 1px solid var(--admin-border);">
            <button type="button" class="lang-tab active" data-lang="pl" onclick="switchCategoryLang('pl')">üáµüá± Polski</button>
            <button type="button" class="lang-tab" data-lang="en" onclick="switchCategoryLang('en')">üá¨üáß English</button>
          </div>

          <!-- Polish Content -->
          <div id="categoryLangPL" class="lang-content active">
            <label class="admin-form-field">
              <span>Nazwa kategorii (PL) *</span>
              <input type="text" id="shopCategoryName" required placeholder="np. Lokalne produkty">
            </label>
            <label class="admin-form-field">
              <span>Opis (PL)</span>
              <textarea id="shopCategoryDescription" rows="2" placeholder="Opis kategorii po polsku"></textarea>
            </label>
          </div>

          <!-- English Content -->
          <div id="categoryLangEN" class="lang-content">
            <label class="admin-form-field">
              <span>Category Name (EN)</span>
              <input type="text" id="shopCategoryNameEn" placeholder="e.g. Local Products">
            </label>
            <label class="admin-form-field">
              <span>Description (EN)</span>
              <textarea id="shopCategoryDescriptionEn" rows="2" placeholder="Category description in English"></textarea>
            </label>
          </div>

          <hr style="margin: 16px 0; border: none; border-top: 1px solid var(--admin-border);">

          <label class="admin-form-field">
            <span>Slug (URL)</span>
            <input type="text" id="shopCategorySlug" placeholder="local-products">
            <small style="color: var(--admin-text-muted);">Zostaw puste, aby wygenerowaƒá automatycznie</small>
          </label>

          <label class="admin-form-field">
            <span>Kategoria nadrzƒôdna</span>
            <select id="shopCategoryParent">
              <option value="">Brak (g≈Ç√≥wna)</option>
            </select>
          </label>

          <label class="admin-form-field">
            <span>Kolejno≈õƒá sortowania</span>
            <input type="number" id="shopCategorySortOrder" min="0" value="0">
          </label>

          <label style="display: flex; align-items: center; gap: 8px; margin-top: 12px;">
            <input type="checkbox" id="shopCategoryActive" checked>
            <span>Aktywna</span>
          </label>

          <div id="shopCategoryFormError" class="admin-error-message" hidden></div>

          <div class="poi-form-actions" style="margin-top: 20px;">
            <button type="button" class="btn-secondary" id="shopCategoryFormCancel">Anuluj</button>
            <button type="submit" class="btn-primary">Zapisz kategoriƒô</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Shop Vendor Form Modal -->
  <div class="admin-modal" id="shopVendorModal" hidden>
    <div class="admin-modal-overlay" id="shopVendorModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 600px;">
      <header class="admin-modal-header">
        <h3 id="shopVendorModalTitle">New Vendor</h3>
        <button class="btn-modal-close" id="btnCloseShopVendorModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="shopVendorForm" novalidate>
          <input type="hidden" id="shopVendorId">
          
          <!-- Language Tabs -->
          <div class="lang-tabs" style="display: flex; gap: 8px; margin-bottom: 16px; border-bottom: 1px solid var(--admin-border);">
            <button type="button" class="lang-tab active" data-lang="pl" onclick="switchVendorLang('pl')">üáµüá± Polski</button>
            <button type="button" class="lang-tab" data-lang="en" onclick="switchVendorLang('en')">üá¨üáß English</button>
          </div>

          <!-- Polish Content -->
          <div id="vendorLangPL" class="lang-content active">
            <label class="admin-form-field">
              <span>Nazwa vendora (PL) *</span>
              <input type="text" id="shopVendorName" required placeholder="np. Cypryjskie Smaki">
            </label>
            <label class="admin-form-field">
              <span>Opis (PL)</span>
              <textarea id="shopVendorDescription" rows="2" placeholder="Opis vendora po polsku"></textarea>
            </label>
          </div>

          <!-- English Content -->
          <div id="vendorLangEN" class="lang-content">
            <label class="admin-form-field">
              <span>Vendor Name (EN)</span>
              <input type="text" id="shopVendorNameEn" placeholder="e.g. Cyprus Delights">
            </label>
            <label class="admin-form-field">
              <span>Description (EN)</span>
              <textarea id="shopVendorDescriptionEn" rows="2" placeholder="Vendor description in English"></textarea>
            </label>
          </div>

          <hr style="margin: 16px 0; border: none; border-top: 1px solid var(--admin-border);">

          <label class="admin-form-field">
            <span>Slug (URL)</span>
            <input type="text" id="shopVendorSlug" placeholder="cyprus-delights">
          </label>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Contact Email</span>
              <input type="email" id="shopVendorEmail" placeholder="vendor@example.com">
            </label>
            <label class="admin-form-field">
              <span>Commission Rate (%)</span>
              <input type="number" id="shopVendorCommission" min="0" max="100" step="0.1" value="0">
            </label>
          </div>

          <label class="admin-form-field">
            <span>Logo URL</span>
            <input type="url" id="shopVendorLogo" placeholder="https://...">
          </label>

          <label style="display: flex; align-items: center; gap: 8px; margin-top: 12px;">
            <input type="checkbox" id="shopVendorActive" checked>
            <span>Active</span>
          </label>

          <div id="shopVendorFormError" class="admin-error-message" hidden></div>

          <div class="poi-form-actions" style="margin-top: 20px;">
            <button type="button" class="btn-secondary" id="shopVendorFormCancel">Cancel</button>
            <button type="submit" class="btn-primary">Save Vendor</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Shop Discount Form Modal -->
  <div class="admin-modal" id="shopDiscountModal" hidden>
    <div class="admin-modal-overlay" id="shopDiscountModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 600px;">
      <header class="admin-modal-header">
        <h3 id="shopDiscountModalTitle">New Discount</h3>
        <button class="btn-modal-close" id="btnCloseShopDiscountModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body">
        <form id="shopDiscountForm" novalidate>
          <input type="hidden" id="shopDiscountId">
          
          <label class="admin-form-field">
            <span>Kod rabatowy *</span>
            <input type="text" id="shopDiscountCode" required placeholder="SUMMER20" style="text-transform: uppercase;">
          </label>

          <!-- Language Tabs -->
          <div class="lang-tabs" style="display: flex; gap: 8px; margin: 16px 0 12px; border-bottom: 1px solid var(--admin-border);">
            <button type="button" class="lang-tab active" data-lang="pl" onclick="switchDiscountLang('pl')">üáµüá± Polski</button>
            <button type="button" class="lang-tab" data-lang="en" onclick="switchDiscountLang('en')">üá¨üáß English</button>
          </div>

          <!-- Polish Content -->
          <div id="discountLangPL" class="lang-content active">
            <label class="admin-form-field">
              <span>Opis (PL)</span>
              <input type="text" id="shopDiscountDescription" placeholder="Letnia wyprzeda≈º 20% taniej">
            </label>
          </div>

          <!-- English Content -->
          <div id="discountLangEN" class="lang-content">
            <label class="admin-form-field">
              <span>Description (EN)</span>
              <input type="text" id="shopDiscountDescriptionEn" placeholder="Summer sale 20% off">
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Discount Type</span>
              <select id="shopDiscountType">
                <option value="percentage">Percentage</option>
                <option value="fixed">Fixed Amount</option>
                <option value="free_shipping">Free Shipping</option>
              </select>
            </label>
            <label class="admin-form-field">
              <span>Value</span>
              <input type="number" id="shopDiscountValue" step="0.01" min="0" placeholder="20">
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Minimum Order (‚Ç¨)</span>
              <input type="number" id="shopDiscountMinOrder" step="0.01" min="0" placeholder="50">
            </label>
            <label class="admin-form-field">
              <span>Maximum Discount (‚Ç¨)</span>
              <input type="number" id="shopDiscountMaxDiscount" step="0.01" min="0" placeholder="100">
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Usage Limit</span>
              <input type="number" id="shopDiscountUsageLimit" min="0" placeholder="Unlimited">
            </label>
            <label class="admin-form-field">
              <span>Per User Limit</span>
              <input type="number" id="shopDiscountPerUserLimit" min="0" value="1">
            </label>
          </div>

          <div class="admin-form-grid">
            <label class="admin-form-field">
              <span>Start Date</span>
              <input type="datetime-local" id="shopDiscountStartDate">
            </label>
            <label class="admin-form-field">
              <span>Expiry Date</span>
              <input type="datetime-local" id="shopDiscountExpiryDate">
            </label>
          </div>

          <label style="display: flex; align-items: center; gap: 8px; margin-top: 12px;">
            <input type="checkbox" id="shopDiscountActive" checked>
            <span>Active</span>
          </label>

          <div id="shopDiscountFormError" class="admin-error-message" hidden></div>

          <div class="poi-form-actions" style="margin-top: 20px;">
            <button type="button" class="btn-secondary" id="shopDiscountFormCancel">Cancel</button>
            <button type="submit" class="btn-primary">Save Discount</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Shop Order Detail Modal -->
  <div class="admin-modal" id="shopOrderModal" hidden>
    <div class="admin-modal-overlay" id="shopOrderModalOverlay"></div>
    <div class="admin-modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
      <header class="admin-modal-header">
        <h3 id="shopOrderModalTitle">Order Details</h3>
        <button class="btn-modal-close" id="btnCloseShopOrderModal">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="admin-modal-body" id="shopOrderModalContent">
        <p style="text-align: center; color: var(--admin-text-muted);">Loading order details...</p>
      </div>
    </div>
  </div>

  <!-- Toast Notifications -->
  <div id="toast-container" class="toast-container"></div>

</body>
</html>
