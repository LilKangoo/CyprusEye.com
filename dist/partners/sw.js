const CACHE_NAME="ce-partners-pwa-20260212_2",PRECACHE_URLS=["/partners/","/partners/index.html","/partners/pwa-icon-192.png","/partners/pwa-icon-512.png"];self.addEventListener("install",event=>{event.waitUntil((async()=>{try{const cache=await caches.open(CACHE_NAME);await cache.addAll(PRECACHE_URLS)}catch(e){}})())}),self.addEventListener("activate",event=>{event.waitUntil((async()=>{const keys=await caches.keys();await Promise.all(keys.map(key=>key!==CACHE_NAME&&key.startsWith("ce-partners-pwa-")?caches.delete(key):Promise.resolve(!1))),await self.clients.claim()})())}),self.addEventListener("message",event=>{const data=event.data||{};data&&"SKIP_WAITING"===data.type&&self.skipWaiting()}),self.addEventListener("fetch",event=>{const req=event.request;if(!req||"GET"!==req.method)return;if(!function(requestUrl){try{const url=new URL(requestUrl);return url.origin===self.location.origin&&(url.pathname.startsWith("/partners/")||url.pathname.startsWith("/assets/")||url.pathname.startsWith("/js/")||url.pathname.startsWith("/css/")||url.pathname.startsWith("/admin/"))}catch(_e){return!1}}(req.url))return;if("navigate"===(request=req).mode||"document"===request.destination&&"GET"===request.method)return void event.respondWith((async()=>{try{const resp=await fetch(req);return(await caches.open(CACHE_NAME)).put(req,resp.clone()),resp}catch(_e){return new Response("Offline",{status:503,headers:{"Content-Type":"text/plain"}})}})());var request;const dest=req.destination;"script"===dest||"style"===dest||"image"===dest||"font"===dest?event.respondWith((async()=>{const cached=await caches.match(req);if(cached)return cached;const resp=await fetch(req);return(await caches.open(CACHE_NAME)).put(req,resp.clone()),resp})()):event.respondWith(fetch(req))}),self.addEventListener("push",event=>{event.waitUntil((async()=>{let payload={};try{payload=event.data&&event.data.json?await event.data.json():{}}catch(_e){try{const text=event.data?await event.data.text():"";payload=text?JSON.parse(text):{}}catch(_e2){payload={}}}const title=String(payload.title||payload.notification?.title||"CyprusEye Partners").trim()||"CyprusEye Partners",body=String(payload.body||payload.notification?.body||"").trim(),url=String(payload.url||payload.notification?.url||"/partners/").trim()||"/partners/",options={body:body,icon:String(payload.icon||payload.notification?.icon||"/partners/pwa-icon-192.png").trim()||"/partners/pwa-icon-192.png",badge:"/partners/pwa-icon-192.png",data:{url:url}};await self.registration.showNotification(title,options)})())}),self.addEventListener("notificationclick",event=>{event.notification.close();const url=String(event.notification?.data?.url||"/partners/").trim()||"/partners/";event.waitUntil((async()=>{const origin=self.location.origin,targetUrl=new URL(url,origin).toString(),windowClients=await self.clients.matchAll({type:"window",includeUncontrolled:!0});for(const client of windowClients)try{const clientUrl=new URL(client.url);if(clientUrl.origin===origin&&clientUrl.pathname.startsWith("/partners/"))return await client.focus(),void("navigate"in client&&await client.navigate(targetUrl))}catch(_e){}await self.clients.openWindow(targetUrl)})())});