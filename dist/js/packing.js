!function(){const packingGuide=(()=>{try{if("undefined"!=typeof PACKING_GUIDE)return PACKING_GUIDE}catch(_){}try{if("undefined"!=typeof window&&window.PACKING_GUIDE)return window.PACKING_GUIDE}catch(_){}return{universal:[],seasons:[]}})();let selectedPackingSeasonId=null;function translate(key,fallback=""){try{const i18n="undefined"!=typeof window?window.appI18n:null;if(i18n&&i18n.translations){const lang=i18n.language||"pl",entry=i18n.translations[lang]&&i18n.translations[lang][key];if("string"==typeof entry)return entry;if(entry&&"object"==typeof entry){if("string"==typeof entry.text)return entry.text;if("string"==typeof entry.html)return entry.html}}}catch(_){}return fallback||""}function getPackingSeasonLabel(season){return season?translate(`packing.season.${season.id}.label`,season.label||""):""}function renderSeasonButtonLabel(button,season){if(!button||!season)return;const label=getPackingSeasonLabel(season);button.innerHTML=`<span class="packing-season-icon">${season.emoji||""}</span>${label}`,button.setAttribute("aria-label",`${label}`.trim())}function getPackingItemText(baseKey,item,field){if(!item)return"";const fallback=item[field]||"";return item.key?translate(`${baseKey}.${item.key}.${field}`,fallback):fallback}function handlePackingSeasonKeydown(event){const target=event.currentTarget;if(!(target instanceof HTMLButtonElement))return;if(!["ArrowRight","ArrowDown","ArrowLeft","ArrowUp","Home","End"].includes(event.key))return;const buttons=Array.from(document.querySelectorAll("#packingSeasonToggle button")),currentIndex=buttons.indexOf(target);if(-1===currentIndex)return;event.preventDefault();let nextIndex=currentIndex;"ArrowRight"===event.key||"ArrowDown"===event.key?nextIndex=(currentIndex+1)%buttons.length:"ArrowLeft"===event.key||"ArrowUp"===event.key?nextIndex=(currentIndex-1+buttons.length)%buttons.length:"Home"===event.key?nextIndex=0:"End"===event.key&&(nextIndex=buttons.length-1);const nextButton=buttons[nextIndex];if(nextButton instanceof HTMLButtonElement){nextButton.focus();const seasonId=nextButton.dataset.season;seasonId&&setPackingSeason(seasonId)}}function createPackingChecklist(items,idPrefix,baseKey){const list=document.createElement("ul");return list.className="packing-checklist",(items||[]).forEach((item,index)=>{const li=document.createElement("li"),input=document.createElement("input");input.type="checkbox";const inputId=`${idPrefix}-${index}`;input.id=inputId;const label=document.createElement("label");label.className="packing-check-label",label.setAttribute("for",inputId);const mainLine=document.createElement("div");mainLine.className="packing-check-main";const text=document.createElement("span"),labelText=baseKey?getPackingItemText(baseKey,item,"label"):item.label||"";if(text.textContent=labelText,mainLine.appendChild(text),item.optional){const optional=document.createElement("span");optional.className="packing-optional",optional.textContent=translate("packing.guide.optional","opcjonalnie"),mainLine.appendChild(optional)}if(label.appendChild(mainLine),item.hint){const hint=document.createElement("small"),hintText=baseKey?getPackingItemText(baseKey,item,"hint"):item.hint||"";hint.textContent=hintText,label.appendChild(hint)}li.appendChild(input),li.appendChild(label),list.appendChild(li)}),list}function renderPackingChecklist(){const panel=document.getElementById("packingChecklist"),toggle=document.getElementById("packingSeasonToggle");if(!panel||!toggle)return;const season=packingGuide.seasons.find(s=>s.id===selectedPackingSeasonId)||packingGuide.seasons[0];if(!season)return void(panel.innerHTML="");panel.innerHTML="";const header=document.createElement("div");header.className="packing-season-header";const heading=document.createElement("h3");heading.textContent=`${season.emoji||""} ${getPackingSeasonLabel(season)}`.trim();const summary=document.createElement("p");summary.textContent=function(season){return season?translate(`packing.season.${season.id}.summary`,season.summary||""):""}(season),header.append(heading,summary),panel.appendChild(header);const listsWrapper=document.createElement("div");listsWrapper.className="packing-lists";const universalSection=document.createElement("section");universalSection.className="packing-list-section";const universalTitle=document.createElement("h4");universalTitle.textContent=translate("packing.guide.universal.title","Uniwersalne niezbędniki"),universalSection.appendChild(universalTitle),universalSection.appendChild(createPackingChecklist(packingGuide.universal,`packing-universal-${season.id}`,"packing.guide.universal")),listsWrapper.appendChild(universalSection);const seasonalSection=document.createElement("section");seasonalSection.className="packing-list-section";const seasonalTitle=document.createElement("h4");seasonalTitle.textContent=translate("packing.guide.seasonal.title","Dodatki sezonowe"),seasonalSection.appendChild(seasonalTitle),seasonalSection.appendChild(createPackingChecklist(season.items||[],`packing-season-${season.id}`,`packing.guide.seasons.${season.id}`)),listsWrapper.appendChild(seasonalSection),panel.appendChild(listsWrapper),toggle.querySelectorAll("button").forEach(button=>{if(!(button instanceof HTMLButtonElement))return;const isActive=button.dataset.season===season.id;button.classList.toggle("is-active",isActive),button.setAttribute("aria-selected",isActive?"true":"false"),button.tabIndex=isActive?0:-1});const activeTab=document.getElementById(`packingSeasonTab-${season.id}`);activeTab&&panel.setAttribute("aria-labelledby",activeTab.id)}function setPackingSeason(seasonId){const season=packingGuide.seasons.find(s=>s.id===seasonId)||packingGuide.seasons[0];season&&(selectedPackingSeasonId=season.id,renderPackingChecklist())}function updatePackingPlannerLanguage(){const toggle=document.getElementById("packingSeasonToggle");toggle&&(toggle.setAttribute("aria-label",translate("packing.season.toggleLabel","Wybierz sezon podróży")),toggle.querySelectorAll("button[data-season]").forEach(button=>{if(!(button instanceof HTMLButtonElement))return;const seasonId=button.dataset.season,season=(packingGuide.seasons||[]).find(s=>s.id===seasonId);season&&renderSeasonButtonLabel(button,season)}),renderPackingChecklist())}function onReady(){(function(){const toggle=document.getElementById("packingSeasonToggle"),panel=document.getElementById("packingChecklist"),view=document.getElementById("packingView");view&&view.hasAttribute("hidden")&&view.removeAttribute("hidden"),toggle&&panel&&(toggle.innerHTML="",toggle.setAttribute("aria-label",translate("packing.season.toggleLabel","Wybierz sezon podróży")),(packingGuide.seasons||[]).forEach(season=>{const button=document.createElement("button");button.type="button",button.id=`packingSeasonTab-${season.id}`,button.dataset.season=season.id,button.setAttribute("role","tab"),button.setAttribute("aria-controls","packingChecklist"),button.tabIndex=-1,button.className="packing-season-button",renderSeasonButtonLabel(button,season),button.addEventListener("click",()=>setPackingSeason(season.id)),button.addEventListener("keydown",handlePackingSeasonKeydown),toggle.appendChild(button)}),setPackingSeason(function(){const currentMonth=(new Date).getMonth()+1,match=packingGuide.seasons.find(s=>Array.isArray(s.months)&&s.months.includes(currentMonth));return match?match.id:packingGuide.seasons[0]&&packingGuide.seasons[0].id}()))})(),window.addEventListener("i18n:updated",updatePackingPlannerLanguage)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",onReady,{once:!0}):onReady()}();